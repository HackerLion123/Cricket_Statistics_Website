!function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var i=n(15),o=r(i),a=n(16),s=r(a),u=n(6),l=r(u),c=n(4),f=r(c);window.TPWidget=window.TPWidget||{};var p=0;window.TPWidget.bootstrap=function(t){var e=void 0!==t?t.userLoginInfo:{};l.default.init({userLoginInfo:e});for(var n=void 0!==t?t.widgets:[],r=0;r<n.length;r++){f.default.setWidgetAvailFlag();var i=document.getElementById(n[r].ele);i&&l.default.nodes.indexOf(n[r].ele)<0&&(l.default.nodes.push(n[r].ele),"tpwidget-one"===n[r].widgetType?o.default.init({ele:i}):"tpwidget-two"===n[r].widgetType&&s.default.init({ele:i}))}},window.TPWidget.signinCallback=function(t){l.default.updateUserCredentials({userLoginInfo:t})},window.TPWidget.addPreLoginPoints=function(t){p+=500,setTimeout(function(){l.default.addPreLoginActivity(t)},p)},window.TPWidget.getPreLoginPoints=function(){if(window.__tpFetchComplete)return l.default.getPLPoints()},f.default.triggerEvent(document.body,"tpwidget-loaded"),window.__tpWidgetLoaded=!0},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={commonAPIEndPoint:"//api.timespoints.com/common",staticPath:"//image.timespoints.iimg.in/tpwidgets",apiEndPoint:"//tpapi.timespoints.com"};e.constants=n},function(t,e,n){!function(t,n){!function(t){function e(t,e,n){this.nodeName=t,this.attributes=e,this.children=n,this.key=e&&e.key}function n(t,n){var r,i,o,a,s;for(s=arguments.length;s-- >2;)q.push(arguments[s]);for(n&&n.children&&(q.length||q.push(n.children),delete n.children);q.length;)if((o=q.pop())instanceof Array)for(s=o.length;s--;)q.push(o[s]);else null!=o&&!0!==o&&!1!==o&&("number"==typeof o&&(o=String(o)),a="string"==typeof o,a&&i?r[r.length-1]+=o:((r||(r=[])).push(o),i=a));var u=new e(t,n||void 0,r||W);return R.vnode&&R.vnode(u),u}function r(t,e){if(e)for(var n in e)t[n]=e[n];return t}function i(t){return r({},t)}function o(t,e){for(var n=e.split("."),r=0;r<n.length&&t;r++)t=t[n[r]];return t}function a(t){return"function"==typeof t}function s(t){return"string"==typeof t}function u(t){var e="";for(var n in t)t[n]&&(e&&(e+=" "),e+=n);return e}function l(t,e){return n(t.nodeName,r(i(t.attributes),e),arguments.length>2?[].slice.call(arguments,2):t.children)}function c(t,e,n){var r=e.split(".");return function(e){for(var i=e&&e.target||this,a={},u=a,l=s(n)?o(e,n):i.nodeName?i.type.match(/^che|rad/)?i.checked:i.value:e,c=0;c<r.length-1;c++)u=u[r[c]]||(u[r[c]]=!c&&t.state[r[c]]||{});u[r[c]]=l,t.setState(a)}}function f(t){!t._dirty&&(t._dirty=!0)&&1==J.push(t)&&(R.debounceRendering||H)(p)}function p(){var t,e=J;for(J=[];t=e.pop();)t._dirty&&N(t)}function d(t){var e=t&&t.nodeName;return e&&a(e)&&!(e.prototype&&e.prototype.render)}function h(t,e){return t.nodeName(g(t),e||X)}function m(t,e){return s(e)?t instanceof Text:s(e.nodeName)?!t._componentConstructor&&v(t,e.nodeName):a(e.nodeName)?!t._componentConstructor||t._componentConstructor===e.nodeName||d(e):void 0}function v(t,e){return t.normalizedNodeName===e||V(t.nodeName)===V(e)}function g(t){var e=i(t.attributes);e.children=t.children;var n=t.nodeName.defaultProps;if(n)for(var r in n)void 0===e[r]&&(e[r]=n[r]);return e}function y(t){var e=t.parentNode;e&&e.removeChild(t)}function _(t,e,n,r,i){if("className"===e&&(e="class"),"class"===e&&r&&"object"==typeof r&&(r=u(r)),"key"===e);else if("class"!==e||i)if("style"===e){if((!r||s(r)||s(n))&&(t.style.cssText=r||""),r&&"object"==typeof r){if(!s(n))for(var o in n)o in r||(t.style[o]="");for(var o in r)t.style[o]="number"!=typeof r[o]||G[o]?r[o]:r[o]+"px"}}else if("dangerouslySetInnerHTML"===e)r&&(t.innerHTML=r.__html||"");else if("o"==e[0]&&"n"==e[1]){var l=t._listeners||(t._listeners={});e=V(e.substring(2)),r?l[e]||t.addEventListener(e,w,!!$[e]):l[e]&&t.removeEventListener(e,w,!!$[e]),l[e]=r}else if("list"!==e&&"type"!==e&&!i&&e in t)b(t,e,null==r?"":r),null!=r&&!1!==r||t.removeAttribute(e);else{var c=i&&e.match(/^xlink\:?(.+)/);null==r||!1===r?c?t.removeAttributeNS("http://www.w3.org/1999/xlink",V(c[1])):t.removeAttribute(e):"object"==typeof r||a(r)||(c?t.setAttributeNS("http://www.w3.org/1999/xlink",V(c[1]),r):t.setAttribute(e,r))}else t.className=r||""}function b(t,e,n){try{t[e]=n}catch(t){}}function w(t){return this._listeners[t.type](R.event&&R.event(t)||t)}function x(t){if(y(t),t instanceof Element){t._component=t._componentConstructor=null;var e=t.normalizedNodeName||V(t.nodeName);(Z[e]||(Z[e]=[])).push(t)}}function T(t,e){var n=V(t),r=Z[n]&&Z[n].pop()||(e?document.createElementNS("http://www.w3.org/2000/svg",t):document.createElement(t));return r.normalizedNodeName=n,r}function P(){for(var t;t=K.pop();)R.afterMount&&R.afterMount(t),t.componentDidMount&&t.componentDidMount()}function C(t,e,n,r,i,o){Y++||(Q=i&&void 0!==i.ownerSVGElement,tt=t&&!(z in t));var a=k(t,e,n,r);return i&&a.parentNode!==i&&i.appendChild(a),--Y||(tt=!1,o||P()),a}function k(t,e,n,r){for(var i=e&&e.attributes&&e.attributes.ref;d(e);)e=h(e,n);if(null==e&&(e=""),s(e))return t&&t instanceof Text&&t.parentNode?t.nodeValue!=e&&(t.nodeValue=e):(t&&A(t),t=document.createTextNode(e)),t;if(a(e.nodeName))return L(t,e,n,r);var o=t,u=String(e.nodeName),l=Q,c=e.children;if(Q="svg"===u||"foreignObject"!==u&&Q,t){if(!v(t,u)){for(o=T(u,Q);t.firstChild;)o.appendChild(t.firstChild);t.parentNode&&t.parentNode.replaceChild(o,t),A(t)}}else o=T(u,Q);var f=o.firstChild,p=o[z];if(!p){o[z]=p={};for(var m=o.attributes,g=m.length;g--;)p[m[g].name]=m[g].value}return!tt&&c&&1===c.length&&"string"==typeof c[0]&&f&&f instanceof Text&&!f.nextSibling?f.nodeValue!=c[0]&&(f.nodeValue=c[0]):(c&&c.length||f)&&E(o,c,n,r,!!p.dangerouslySetInnerHTML),O(o,e.attributes,p),i&&(p.ref=i)(o),Q=l,o}function E(t,e,n,r,i){var o,a,s,u,l=t.childNodes,c=[],f={},p=0,d=0,h=l.length,v=0,g=e&&e.length;if(h)for(var _=0;_<h;_++){var b=l[_],w=b[z],x=g?(a=b._component)?a.__key:w?w.key:null:null;null!=x?(p++,f[x]=b):(tt||i||w||b instanceof Text)&&(c[v++]=b)}if(g)for(var _=0;_<g;_++){s=e[_],u=null;var x=s.key;if(null!=x)p&&x in f&&(u=f[x],f[x]=void 0,p--);else if(!u&&d<v)for(o=d;o<v;o++)if((a=c[o])&&m(a,s)){u=a,c[o]=void 0,o===v-1&&v--,o===d&&d++;break}(u=k(u,s,n,r))&&u!==t&&(_>=h?t.appendChild(u):u!==l[_]&&(u===l[_+1]&&y(l[_]),t.insertBefore(u,l[_]||null)))}if(p)for(var _ in f)f[_]&&A(f[_]);for(;d<=v;)(u=c[v--])&&A(u)}function A(t,e){var n=t._component;if(n)I(n,!e);else{t[z]&&t[z].ref&&t[z].ref(null),e||x(t);for(var r;r=t.lastChild;)A(r,e)}}function O(t,e,n){var r;for(r in n)e&&r in e||null==n[r]||_(t,r,n[r],n[r]=void 0,Q);if(e)for(r in e)"children"===r||"innerHTML"===r||r in n&&e[r]===("value"===r||"checked"===r?t[r]:n[r])||_(t,r,n[r],n[r]=e[r],Q)}function S(t){var e=t.constructor.name,n=et[e];n?n.push(t):et[e]=[t]}function j(t,e,n){var r=new t(e,n),i=et[t.name];if(M.call(r,e,n),i)for(var o=i.length;o--;)if(i[o].constructor===t){r.nextBase=i[o].nextBase,i.splice(o,1);break}return r}function D(t,e,n,r,i){t._disable||(t._disable=!0,(t.__ref=e.ref)&&delete e.ref,(t.__key=e.key)&&delete e.key,!t.base||i?t.componentWillMount&&t.componentWillMount():t.componentWillReceiveProps&&t.componentWillReceiveProps(e,r),r&&r!==t.context&&(t.prevContext||(t.prevContext=t.context),t.context=r),t.prevProps||(t.prevProps=t.props),t.props=e,t._disable=!1,0!==n&&(1!==n&&!1===R.syncComponentUpdates&&t.base?f(t):N(t,1,i)),t.__ref&&t.__ref(t))}function N(t,e,n,o){if(!t._disable){var s,u,l,c,f=t.props,p=t.state,m=t.context,v=t.prevProps||f,y=t.prevState||p,_=t.prevContext||m,b=t.base,w=t.nextBase,x=b||w,T=t._component;if(b&&(t.props=v,t.state=y,t.context=_,2!==e&&t.shouldComponentUpdate&&!1===t.shouldComponentUpdate(f,p,m)?s=!0:t.componentWillUpdate&&t.componentWillUpdate(f,p,m),t.props=f,t.state=p,t.context=m),t.prevProps=t.prevState=t.prevContext=t.nextBase=null,t._dirty=!1,!s){for(t.render&&(u=t.render(f,p,m)),t.getChildContext&&(m=r(i(m),t.getChildContext()));d(u);)u=h(u,m);var k,E,O=u&&u.nodeName;if(a(O)){var S=g(u);l=T,l&&l.constructor===O&&S.key==l.__key?D(l,S,1,m):(k=l,l=j(O,S,m),l.nextBase=l.nextBase||w,l._parentComponent=t,t._component=l,D(l,S,0,m),N(l,1,n,!0)),E=l.base}else c=x,k=T,k&&(c=t._component=null),(x||1===e)&&(c&&(c._component=null),E=C(c,u,m,n||!b,x&&x.parentNode,!0));if(x&&E!==x&&l!==T){var L=x.parentNode;L&&E!==L&&(L.replaceChild(E,x),k||(x._component=null,A(x)))}if(k&&I(k,E!==x),t.base=E,E&&!o){for(var M=t,U=t;U=U._parentComponent;)(M=U).base=E;E._component=M,E._componentConstructor=M.constructor}}!b||n?K.unshift(t):s||(t.componentDidUpdate&&t.componentDidUpdate(v,y,_),R.afterUpdate&&R.afterUpdate(t));var q,W=t._renderCallbacks;if(W)for(;q=W.pop();)q.call(t);Y||o||P()}}function L(t,e,n,r){for(var i=t&&t._component,o=i,a=t,s=i&&t._componentConstructor===e.nodeName,u=s,l=g(e);i&&!u&&(i=i._parentComponent);)u=i.constructor===e.nodeName;return i&&u&&(!r||i._component)?(D(i,l,3,n,r),t=i.base):(o&&!s&&(I(o,!0),t=a=null),i=j(e.nodeName,l,n),t&&!i.nextBase&&(i.nextBase=t,a=null),D(i,l,1,n,r),t=i.base,a&&t!==a&&(a._component=null,A(a))),t}function I(t,e){R.beforeUnmount&&R.beforeUnmount(t);var n=t.base;t._disable=!0,t.componentWillUnmount&&t.componentWillUnmount(),t.base=null;var r=t._component;if(r)I(r,e);else if(n){n[z]&&n[z].ref&&n[z].ref(null),t.nextBase=n,e&&(y(n),S(t));for(var i;i=n.lastChild;)A(i,!e)}t.__ref&&t.__ref(null),t.componentDidUnmount&&t.componentDidUnmount()}function M(t,e){this._dirty=!0,this.context=e,this.props=t,this.state||(this.state={})}function U(t,e,n){return C(n,t,{},!1,e)}var R={},q=[],W=[],F={},V=function(t){return F[t]||(F[t]=t.toLowerCase())},B="undefined"!=typeof Promise&&Promise.resolve(),H=B?function(t){B.then(t)}:setTimeout,X={},z="undefined"!=typeof Symbol?Symbol.for("preactattr"):"__preactattr_",G={boxFlex:1,boxFlexGroup:1,columnCount:1,fillOpacity:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,fontWeight:1,lineClamp:1,lineHeight:1,opacity:1,order:1,orphans:1,strokeOpacity:1,widows:1,zIndex:1,zoom:1},$={blur:1,error:1,focus:1,load:1,resize:1,scroll:1},J=[],Z={},K=[],Y=0,Q=!1,tt=!1,et={};r(M.prototype,{linkState:function(t,e){var n=this._linkedStates||(this._linkedStates={});return n[t+e]||(n[t+e]=c(this,t,e))},setState:function(t,e){var n=this.state;this.prevState||(this.prevState=i(n)),r(n,a(t)?t(n,this.props):t),e&&(this._renderCallbacks=this._renderCallbacks||[]).push(e),f(this)},forceUpdate:function(){N(this,2)},render:function(){}}),t.h=n,t.cloneElement=l,t.Component=M,t.render=U,t.rerender=p,t.options=R}(e)}()},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(11),s=r(a),u=n(4),l=r(u),c=n(1);c=c.constants;var f,p=function(){function t(){i(this,t),this.domain=window.location.hostname,this.apiEndpoint=c.commonAPIEndPoint,this.configUrl="/config/",this.channelDetails=(0,s.default)().store("channelDetails"),this.channelActivityDetails=(0,s.default)().store("channelActivities"),this.ltp=(0,s.default)().store("ltp"),this.staticVersion=localStorage.getItem("tpvar"),this.pointsVer=localStorage.getItem("tpprv"),this.isWidgetShown=!1,this.srcWid="",this.retryCount=0,this.ptsMerged=!1}return o(t,[{key:"setUserChannelDetails",value:function(t){t?(this.userLoginDetails=t,l.default.triggerEvent(document.body,"user-info-update")):(this.userLoginDetails=!1,l.default.triggerEvent(document.body,"prelogin-activity"))}},{key:"getUserChannelDetails",value:function(){return this.userLoginDetails||!1}},{key:"setUserPointsnEngagement",value:function(t){return this.tpUserInfo=t,!0}},{key:"getUserPointsnEngagement",value:function(){return this.tpUserInfo}},{key:"getUserLivePoints",value:function(){return this.tpUserInfo&&this.tpUserInfo.points||!1}},{key:"getUserEngagementAPI",value:function(){return this.channelDetails().first().usernextEngagementAPI}},{key:"getPLEngagement",value:function(){var t=this.channelDetails().first();if(t){var e=t.plengagement;return e.desc=e.desc||"You're one step away from claiming ###",{index:e.desc.indexOf("###"),txtArr:e.desc.split("###"),btnText:e.aText,btnURL:e.url}}return!1}},{key:"getZeroPLEngagement",value:function(){var t=this.channelDetails().first();if(t){var e=t.plzeroengagement;return e||(e={}),e.desc=e.desc||"Login to earn",{txtArr:e.desc||"Login to earn",btnText:e.aText,btnURL:e.url}}return!1}}]),t}();void 0===f&&(f=new p),e.default=f},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(3),s=r(a),u=n(9),l=r(u),c=function(){function t(){i(this,t)}return o(t,[{key:"checkLogin",value:function(){var t=s.default.getUserChannelDetails();return void 0!==t&&t.URL&&t.host&&t.channel&&t.email&&t.userId?{user:t,status:!0}:{status:!1}}},{key:"setWidgetAvailFlag",value:function(){s.default.isWidgetShown=!0}},{key:"isWidgetPreloginOnly",value:function(){return!s.default.isWidgetShown}},{key:"getAllActivityAPI",value:function(){return s.default.channelDetails().first().allActivityAPI}},{key:"getAllDeltaActivityAPI",value:function(){return s.default.channelDetails().first().allDeltaActivityAPI}},{key:"getActivityLogAPI",value:function(){return s.default.channelDetails().first().activityAPI}},{key:"getDayFirstTimeStamp",value:function(){var t=new Date;return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t.getTime()}},{key:"getDayLastTimeStamp",value:function(){var t=new Date;return t.setHours(23),t.setMinutes(59),t.setSeconds(59),t.setMilliseconds(0),t.getTime()}},{key:"getPreloginPostAPI",value:function(){return s.default.channelDetails().first().mrgAPI}},{key:"getChannelLoginMethod",value:function(){return s.default.channelDetails().first().loginMethodName||""}},{key:"isLocalStorageSupported",value:function(){return"localStorage"in window&&null!==window.localStorage}},{key:"getFontClass",value:function(t){var e="";switch(!0){case t>=1e5:e="text-xxs";break;case t>=1e4&&t<1e5:e="text-xs";break;case t>=1e3&&t<1e4:e="text-s";break;default:e="text-normal"}return e}},{key:"addEvent",value:function(t,e,n){function r(t){var e=n.apply(this,arguments);return!1===e&&(t.stopPropagation(),t.preventDefault()),e}function i(){var e=n.call(t,window.event);return!1===e&&(window.event.returnValue=!1,window.event.cancelBubble=!0),e}return document.addEventListener?(t.addEventListener(e,r,!1),{el:t,handler:r,event:e}):(t.attachEvent("on"+e,i),{el:t,handler:i,event:e})}},{key:"triggerEvent",value:function(t,e,n){n=n||[],n=n.length>0?n:[n];var r,i={customData:n};window.CustomEvent?r=new window.CustomEvent(e,{bubbles:!0,cancelable:!0,detail:i}):(r=document.createEvent("CustomEvent"),r.initCustomEvent(e,!0,!0,i)),t.dispatchEvent(r)}},{key:"wait",value:function(t){for(var e=(new Date).getTime(),n=e;n<e+t;)n=(new Date).getTime()}},{key:"getUserRealtimePoints",value:function(t){if(this.isWidgetPreloginOnly())return!1;var e=this,n=s.default.getUserLivePoints(),r=!0;l.default.get(s.default.getUserEngagementAPI()).query({uid:t.userId,pname:t.host,pfm:"web",widget:!0}).end(function(i,o){if(s.default.retryCount++,!i){var a=o.body;"SUCCESS"===a.status&&a.response?(s.default.setUserPointsnEngagement(a.response),a.response.points&&n&&n!==a.response.points&&(r=!1),e.triggerEvent(document.body,"engage-fetch-complete")):s.default.setUserChannelDetails(),s.default.retryCount<=s.default.maxRetryCount&&s.default.ptsMerged&&r&&setTimeout(function(){e.getUserRealtimePoints(t)},Number(s.default.retryInt))}})}},{key:"initializeGA",value:function(){!function(t,e,n,r,i,o,a){t.GoogleAnalyticsObject=i,t[i]=t[i]||function(){(t[i].q=t[i].q||[]).push(arguments)},t[i].l=1*new Date,o=e.createElement(n),a=e.getElementsByTagName(n)[0],o.async=1,o.src="//www.google-analytics.com/analytics.js",a.parentNode.insertBefore(o,a)}(window,document,"script",0,"ga"),ga("create","UA-5594188-6","auto","tpTracker"),ga("require","displayfeatures")}}]),t}();e.default=new c},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(){function t(){n(this,t)}return r(t,[{key:"addEvent",value:function(t,e,n){function r(t){var e=n.apply(this,arguments);return!1===e&&(t.stopPropagation(),t.preventDefault()),e}function i(){var e=n.call(t,window.event);return!1===e&&(window.event.returnValue=!1,window.event.cancelBubble=!0),e}return document.addEventListener?(t.addEventListener(e,r,!1),{el:t,handler:r,event:e}):(t.attachEvent("on"+e,i),{el:t,handler:i,event:e})}},{key:"triggerEvent",value:function(t,e,n){n=n||[],n=n.length>0?n:[n];var r,i={customData:n};window.CustomEvent?r=new window.CustomEvent(e,{bubbles:!0,cancelable:!0,detail:i}):(r=document.createEvent("CustomEvent"),r.initCustomEvent(e,!0,!0,i)),t.dispatchEvent(r)}},{key:"asyncRequest",value:function(t,e,n,r,i,o){var a;try{a=new XMLHttpRequest}catch(t){for(var s=["MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],u=0,l=s.length;u<l;++u)try{a=new ActiveXObject(s[u]);break}catch(t){}}if(a.open(t,e,!0),i&&a.setRequestHeader("Content-Type",i),o)for(var c=Object.keys(o),u=0;u<c.length;u++)a.setRequestHeader(c[u],o[c[u]]);return function(t,e){var n=window.setInterval(function(){t&&4==t.readyState&&(window.clearInterval(n),e&&e(t))},50)}(a,n),a.send(r||null),a}}]),t}();e.default=new i},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(9),s=r(a),u=n(11),l=r(u),c=n(3),f=r(c),p=n(4),d=r(p),h=n(7),m=r(h),v=n(1);v=v.constants;var g=function(){function t(){i(this,t),this.nodes=[]}return o(t,[{key:"initializeCoreSystem",value:function(){var t=this;f.default.maxRetryCount=window.__tpTemp.rc,f.default.retryInt=window.__tpTemp.ri,null!=f.default.staticVersion&&f.default.staticVersion==window.__tpvar||(f.default.channelDetails().remove(!0),f.default.channelActivityDetails().remove(!0),localStorage.removeItem("deltaDate"),f.default.staticVersion=window.__tpvar,localStorage.setItem("tpvar",window.__tpvar)),null!=f.default.pointsVer&&f.default.pointsVer==window.__tpPointsVer||(null!=f.default.pointsVer&&localStorage.removeItem("taffy_plt"),f.default.pointsVer=window.__tpPointsVer,localStorage.setItem("tpprv",window.__tpPointsVer)),t.setChannelDetails()}},{key:"setChannelDetails",value:function(t){var e=this;if(0==f.default.channelDetails().count())s.default.get(f.default.apiEndpoint+f.default.configUrl+"domaindetails").query({version:f.default.staticVersion,domain:f.default.domain}).end(function(t,n){var r=n.body.response;if(!r.status)return!1;f.default.channelDetails.insert(r),f.default.channelName=r.channelName,f.default.subChannelName=r.subChannelName,f.default.pfm=r.pfm,f.default.maxPrePoints=r.maxTotalPts,localStorage.setItem("deltaDate",n.body.deltaDate),e.setChannelActivityDetails()});else{var n=f.default.channelDetails().first();f.default.channelName=n.channelName,f.default.subChannelName=n.subChannelName,f.default.maxPrePoints=n.maxTotalPts,f.default.pfm=n.pfm,e.setChannelActivityDetails()}}},{key:"setSystemStatusToLoaded",value:function(){window.__tpFetchComplete=!0,d.default.triggerEvent(document.body,"tpFetchComplete")}},{key:"setChannelActivityDetails",value:function(){var t=f.default.channelActivityDetails().count(),e=this;if(0==t)s.default.get(d.default.getAllActivityAPI()).query({version:f.default.staticVersion,pcode:f.default.channelName,pfm:f.default.pfm,action:"prelogin"}).end(function(t,n){f.default.channelActivityDetails.insert(n.body),m.default.init({activity:e.options.preLoginActivity}),e.setSystemStatusToLoaded()});else{var n=localStorage.getItem("deltaDate");null!=n?s.default.get(d.default.getAllDeltaActivityAPI()).query({version:f.default.staticVersion,pcode:f.default.channelName,pfm:f.default.pfm,action:"prelogin",deltaDate:n}).end(function(t,n){if(!t){var r=n.body,i=r.deltaData;localStorage.setItem("deltaDate",r.deltaDate);var o=f.default.channelActivityDetails().get()||[];if(i.length>0){f.default.channelActivityDetails().remove(!0);for(var a=0;a<i.length;a++)for(var s=i[a].aname,u=0;u<o.length;u++)o[u].aname===s&&o.splice(u,1);for(var a=0;a<i.length;a++)o.push(i[a]);f.default.channelActivityDetails.insert(o)}m.default.init({activity:e.options.preLoginActivity}),e.setSystemStatusToLoaded()}}):(m.default.init({activity:e.options.preLoginActivity}),e.setSystemStatusToLoaded())}d.default.initializeGA()}},{key:"updateUserCredentials",value:function(t){var e=d.default.checkLogin();e.status&&t.userLoginInfo||(e.status||t.userLoginInfo,void 0===t.userLoginInfo&&(f.default.srcWid="",(0,l.default)().store("plt")().remove(!0)),f.default.setUserChannelDetails(t.userLoginInfo),t.userLoginInfo&&m.default.checkAndFlushPreloginData(t.userLoginInfo))}},{key:"addPreLoginActivity",value:function(t){!1===d.default.checkLogin().status&&m.default.addPreloginActivity(t)}},{key:"getPLPoints",value:function(){return m.default.getTotalPoints()}},{key:"init",value:function(t){this.options=t,d.default.addEvent(document.body,"user-info-update",function(){var t=d.default.checkLogin();f.default.srcWid&&t.status&&t.user&&setTimeout(function(){ga("tpTracker.send","event",{eventCategory:f.default.channelName+"_"+f.default.srcWid,eventAction:"SignIn_Success",eventLabel:t.user.userId,nonInteraction:!0})},5e3)}),t.userLoginInfo&&f.default.setUserChannelDetails(t.userLoginInfo),window.__tpFetchComplete||this.initializeCoreSystem()}}]),t}();e.default=new g},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o,a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(9),u=r(s),l=n(11),c=r(l),f=n(3),p=r(f),d=n(4),h=r(d),m=function(){function t(){i(this,t),this.actID="avcode"}return a(t,[{key:"processPreLoginActivities",value:function(){var t=h.default.checkLogin(),e=localStorage.getItem("credit"),n=[];if(void 0!==this.initActivities?0==this.initActivities.length?n.push("register"):n=this.initActivities:n=[],!0===t.status)this.checkAndFlushPreloginData(t.user);else if(!1===t.status&&null==e)for(var r=0;r<n.length;r++)this.addPreloginActivity(n[r])}},{key:"getPreLoginActivityByName",value:function(t){return p.default.channelActivityDetails().filter({aname:t,pre:!0}).get()[0]}},{key:"getAllRecentActivities",value:function(){var t=new Date,e=(new Date).setDate(t.getDate()-30);return(0,c.default)().store("plt")({cdate:{lte:e}})}},{key:"getLastActivityFromDB",value:function(t,e){return(0,c.default)().store("plt")([{prelogin:e},{aname:t}]).last()}},{key:"saveActivityIntoDB",value:function(t,e,n){var r=this.getAllRecentActivities(),i=(0,c.default)().store("plt");r.count()&&r.remove();var o={id:t,cdate:(new Date).getTime(),points:e,aname:n};i.insert(o),setTimeout(function(){h.default.triggerEvent(document.body,"prelogin-activity")},200),h.default.wait(500)}},{key:"addPreloginActivity",value:function(t){var e=this.getTotalPoints(),n=this.getPreLoginActivityByName(t);if(n&&e+Number(n.points)>p.default.maxPrePoints)return!1;if(n&&n.pre){var r=this.getLastActivityFromDB(n.aname,n.prelogin);if(!n.active)return!1;if(!1!==r){var i=((new Date).getTime()-r.cdate)/1e3-n.climit;1!==n.atype&&i>=0&&this.saveActivityIntoDB(n[this.actID],n.points,n.aname)}else this.saveActivityIntoDB(n[this.actID],n.points,n.aname)}}},{key:"getTotalPoints",value:function(){return(0,c.default)().store("plt")().sum("points")}},{key:"getAllActivityFromDB",value:function(){var t="";return(0,c.default)().store("plt")({points:{gt:0}}).each(function(e){t=e.prelogin?t+(""==t?"":",")+"{'spacode':"+e.prelogin+", 'cdate':"+e.cdate+"}":t+(""==t?"":",")+"{'spavpcode':"+e.id+", 'cdate':"+e.cdate+"}"}),t="["+t+"]"}},{key:"checkAndFlushPreloginData",value:function(t){var e=(0,c.default)().store("plt"),n=e().count();if(null!=localStorage.getItem("credit")||n<=0)return h.default.getUserRealtimePoints(t),!1;var r=this.getAllActivityFromDB();try{u.default.post(h.default.getPreloginPostAPI()+"?version="+p.default.staticVersion).set("Content-Type","application/x-www-form-urlencoded").send({uid:t.userId,uemail:t.email,domain:p.default.domain,pname:p.default.channelName,userlogs:r}).end(function(n,r){n||(1==r.body&&(localStorage.setItem("credit",1),e().remove(!0),p.default.ptsMerged=!0),h.default.getUserRealtimePoints(t))})}catch(t){}}},{key:"checkCredit",value:function(){return localStorage.getItem("credit")}},{key:"init",value:function(t){h.default.isLocalStorageSupported()&&(this.initActivities=t.activity,this.processPreLoginActivities())}}]),t}();void 0===o&&(o=new m),e.default=o},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=n(12),c=r(l),f=n(12),p=r(f),d=n(24),h=r(d),m=function(t){function e(){return i(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),u(e,[{key:"componentDidMount",value:function(){this.odometer=new h.default(s({el:p.default.findDOMNode(this),value:this.props.value},this.props.options))}},{key:"componentDidUpdate",value:function(){this.odometer.update(this.props.value)}},{key:"render",value:function(){return c.default.createElement("div")}}]),e}(l.Component);m.propTypes={value:l.PropTypes.number.isRequired,options:l.PropTypes.object},e.default=m},function(t,e,n){function r(){}function i(t){if(!m(t))return t;var e=[];for(var n in t)o(e,n,t[n]);return e.join("&")}function o(t,e,n){if(null!=n)if(Array.isArray(n))n.forEach(function(n){o(t,e,n)});else if(m(n))for(var r in n)o(t,e+"["+r+"]",n[r]);else t.push(encodeURIComponent(e)+"="+encodeURIComponent(n));else null===n&&t.push(encodeURIComponent(e))}function a(t){for(var e,n,r={},i=t.split("&"),o=0,a=i.length;o<a;++o)e=i[o],n=e.indexOf("="),-1==n?r[decodeURIComponent(e)]="":r[decodeURIComponent(e.slice(0,n))]=decodeURIComponent(e.slice(n+1));return r}function s(t){var e,n,r,i,o=t.split(/\r?\n/),a={};o.pop();for(var s=0,u=o.length;s<u;++s)n=o[s],e=n.indexOf(":"),r=n.slice(0,e).toLowerCase(),i=b(n.slice(e+1)),a[r]=i;return a}function u(t){return/[\/+]json\b/.test(t)}function l(t){this.req=t,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;var e=this.xhr.status;1223===e&&(e=204),this._setStatusProperties(e),this.header=this.headers=s(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),null===this.text&&t._responseType?this.body=this.xhr.response:this.body="HEAD"!=this.req.method?this._parseBody(this.text?this.text:this.xhr.response):null}function c(t,e){var n=this;this._query=this._query||[],this.method=t,this.url=e,this.header={},this._header={},this.on("end",function(){var t=null,e=null;try{e=new l(n)}catch(e){return t=new Error("Parser is unable to parse the response"),t.parse=!0,t.original=e,n.xhr?(t.rawResponse=void 0===n.xhr.responseType?n.xhr.responseText:n.xhr.response,t.status=n.xhr.status?n.xhr.status:null,t.statusCode=t.status):(t.rawResponse=null,t.status=null),n.callback(t)}n.emit("response",e);var r;try{n._isResponseOK(e)||(r=new Error(e.statusText||"Unsuccessful HTTP response"),r.original=t,r.response=e,r.status=e.status)}catch(t){r=t}r?n.callback(r,e):n.callback(null,e)})}function f(t,e,n){var r=_("DELETE",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r}var p;p="undefined"!=typeof window?window:"undefined"!=typeof self?self:this;var d=n(22),h=n(28),m=n(10),v=n(27),g=n(29),y=n(30),_=e=t.exports=function(t,n){return"function"==typeof n?new e.Request("GET",t).end(n):1==arguments.length?new e.Request("GET",t):new e.Request(t,n)};e.Request=c,_.getXHR=function(){if(!(!p.XMLHttpRequest||p.location&&"file:"==p.location.protocol&&p.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}throw Error("Browser-only verison of superagent could not find XHR")};var b="".trim?function(t){return t.trim()}:function(t){return t.replace(/(^\s*|\s*$)/g,"")};_.serializeObject=i,_.parseString=a,_.types={html:"text/html",json:"application/json",xml:"application/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},_.serialize={"application/x-www-form-urlencoded":i,"application/json":JSON.stringify},_.parse={"application/x-www-form-urlencoded":a,"application/json":JSON.parse},g(l.prototype),l.prototype._parseBody=function(t){var e=_.parse[this.type];return this.req._parser?this.req._parser(this,t):(!e&&u(this.type)&&(e=_.parse["application/json"]),e&&t&&(t.length||t instanceof Object)?e(t):null)},l.prototype.toError=function(){var t=this.req,e=t.method,n=t.url,r="cannot "+e+" "+n+" ("+this.status+")",i=new Error(r);return i.status=this.status,i.method=e,i.url=n,i},_.Response=l,d(c.prototype),h(c.prototype),c.prototype.type=function(t){return this.set("Content-Type",_.types[t]||t),this},c.prototype.accept=function(t){return this.set("Accept",_.types[t]||t),this},c.prototype.auth=function(t,e,n){switch("object"==typeof e&&null!==e&&(n=e),n||(n={type:"function"==typeof btoa?"basic":"auto"
}),n.type){case"basic":this.set("Authorization","Basic "+btoa(t+":"+e));break;case"auto":this.username=t,this.password=e;break;case"bearer":this.set("Authorization","Bearer "+t)}return this},c.prototype.query=function(t){return"string"!=typeof t&&(t=i(t)),t&&this._query.push(t),this},c.prototype.attach=function(t,e,n){if(e){if(this._data)throw Error("superagent can't mix .send() and .attach()");this._getFormData().append(t,e,n||e.name)}return this},c.prototype._getFormData=function(){return this._formData||(this._formData=new p.FormData),this._formData},c.prototype.callback=function(t,e){if(this._maxRetries&&this._retries++<this._maxRetries&&y(t,e))return this._retry();var n=this._callback;this.clearTimeout(),t&&(this._maxRetries&&(t.retries=this._retries-1),this.emit("error",t)),n(t,e)},c.prototype.crossDomainError=function(){var t=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");t.crossDomain=!0,t.status=this.status,t.method=this.method,t.url=this.url,this.callback(t)},c.prototype.buffer=c.prototype.ca=c.prototype.agent=function(){return this},c.prototype.pipe=c.prototype.write=function(){throw Error("Streaming is not supported in browser version of superagent")},c.prototype._appendQueryString=function(){var t=this._query.join("&");if(t&&(this.url+=(this.url.indexOf("?")>=0?"&":"?")+t),this._sort){var e=this.url.indexOf("?");if(e>=0){var n=this.url.substring(e+1).split("&");v(this._sort)?n.sort(this._sort):n.sort(),this.url=this.url.substring(0,e)+"?"+n.join("&")}}},c.prototype._isHost=function(t){return t&&"object"==typeof t&&!Array.isArray(t)&&"[object Object]"!==Object.prototype.toString.call(t)},c.prototype.end=function(t){return this._endCalled,this._endCalled=!0,this._callback=t||r,this._appendQueryString(),this._end()},c.prototype._end=function(){var t=this,e=this.xhr=_.getXHR(),n=this._formData||this._data;this._setTimeouts(),e.onreadystatechange=function(){var n=e.readyState;if(n>=2&&t._responseTimeoutTimer&&clearTimeout(t._responseTimeoutTimer),4==n){var r;try{r=e.status}catch(t){r=0}if(!r){if(t.timedout||t._aborted)return;return t.crossDomainError()}t.emit("end")}};var r=function(e,n){n.total>0&&(n.percent=n.loaded/n.total*100),n.direction=e,t.emit("progress",n)};if(this.hasListeners("progress"))try{e.onprogress=r.bind(null,"download"),e.upload&&(e.upload.onprogress=r.bind(null,"upload"))}catch(t){}try{this.username&&this.password?e.open(this.method,this.url,!0,this.username,this.password):e.open(this.method,this.url,!0)}catch(t){return this.callback(t)}if(this._withCredentials&&(e.withCredentials=!0),!this._formData&&"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof n&&!this._isHost(n)){var i=this._header["content-type"],o=this._serializer||_.serialize[i?i.split(";")[0]:""];!o&&u(i)&&(o=_.serialize["application/json"]),o&&(n=o(n))}for(var a in this.header)null!=this.header[a]&&this.header.hasOwnProperty(a)&&e.setRequestHeader(a,this.header[a]);return this._responseType&&(e.responseType=this._responseType),this.emit("request",this),e.send(void 0!==n?n:null),this},_.get=function(t,e,n){var r=_("GET",t);return"function"==typeof e&&(n=e,e=null),e&&r.query(e),n&&r.end(n),r},_.head=function(t,e,n){var r=_("HEAD",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r},_.options=function(t,e,n){var r=_("OPTIONS",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r},_.del=f,_.delete=f,_.patch=function(t,e,n){var r=_("PATCH",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r},_.post=function(t,e,n){var r=_("POST",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r},_.put=function(t,e,n){var r=_("PUT",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r}},function(t,e){function n(t){return null!==t&&"object"==typeof t}t.exports=n},function(t,e,n){var r=n(25).sep;t.exports=n(14)("./taffy"+r+"lib"+r+"taffy").taffy},function(t,e,n){(function(e){!function(e,r){t.exports=function(t,n){function r(){return null}function i(t){var e=t.nodeName,n=t.attributes;t.attributes={},e.defaultProps&&w(t.attributes,e.defaultProps),n&&w(t.attributes,n)}function o(t,e){var n,r,i;if(e){for(i in e)if(n=F.test(i))break;if(n){r=t.attributes={};for(i in e)e.hasOwnProperty(i)&&(r[F.test(i)?i.replace(/([A-Z0-9])/,"-$1").toLowerCase():i]=e[i])}}}function a(t,e,r){var i=e&&e._preactCompatRendered&&e._preactCompatRendered.base;i&&i.parentNode!==e&&(i=null),i||(i=e.children[0]);for(var o=e.childNodes.length;o--;)e.childNodes[o]!==i&&e.removeChild(e.childNodes[o]);var a=n.render(t,e,i);return e&&(e._preactCompatRendered=a&&(a._component||{base:a})),"function"==typeof r&&r(),a&&a._component||a}function s(t,e,r,i){var o=n.h(G,{context:t.context},e),s=a(o,r);return i&&i(s),s._component||s.base}function u(t){var e=t._preactCompatRendered&&t._preactCompatRendered.base;return!(!e||e.parentNode!==t||(n.render(n.h(r),t,e),0))}function l(t){return h.bind(null,t)}function c(t,e){for(var n=e||0;n<t.length;n++){var r=t[n];Array.isArray(r)?c(r):r&&"object"==typeof r&&!g(r)&&(r.props&&r.type||r.attributes&&r.nodeName||r.children)&&(t[n]=h(r.type||r.nodeName,r.props||r.attributes,r.children))}}function f(t){return"function"==typeof t&&!(t.prototype&&t.prototype.render)}function p(t){return C({displayName:t.displayName||t.name,render:function(){return t(this.props,this.context)}})}function d(t){var e=t[q];return e?!0===e?t:e:(e=p(t),Object.defineProperty(e,q,{configurable:!0,value:!0}),e.displayName=t.displayName,e.propTypes=t.propTypes,e.defaultProps=t.defaultProps,Object.defineProperty(t,q,{configurable:!0,value:e}),e)}function h(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return c(t,2),m(n.h.apply(void 0,t))}function m(t){t.preactCompatNormalized=!0,b(t),f(t.nodeName)&&(t.nodeName=d(t.nodeName));var e=t.attributes.ref,n=e&&typeof e;return!$||"string"!==n&&"number"!==n||(t.attributes.ref=y(e,$)),_(t),t}function v(t,e){for(var r=[],i=arguments.length-2;i-- >0;)r[i]=arguments[i+2];if(!g(t))return t;var o=t.attributes||t.props,a=n.h(t.nodeName||t.type,o,t.children||o&&o.children),s=[a,e];return r&&r.length?s.push(r):e&&e.children&&s.push(e.children),m(n.cloneElement.apply(void 0,s))}function g(t){return t&&(t instanceof H||t.$$typeof===R)}function y(t,e){return e._refProxies[t]||(e._refProxies[t]=function(n){e&&e.refs&&(e.refs[t]=n,null===n&&(delete e._refProxies[t],e=null))})}function _(t){var e=t.nodeName,n=t.attributes;if(n&&"string"==typeof e){var r={};for(var i in n)r[i.toLowerCase()]=i;if(r.ondoubleclick&&(n.ondblclick=n[r.ondoubleclick],delete n[r.ondoubleclick]),r.onchange&&("textarea"===e||"input"===e.toLowerCase()&&!/^fil|che|rad/i.test(n.type))){var o=r.oninput||"oninput";n[o]||(n[o]=S([n[o],n[r.onchange]]),delete n[r.onchange])}}}function b(t){var e=t.attributes;if(e){var n=e.className||e.class;n&&(e.className=n)}}function w(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function x(t,e){for(var n in t)if(!(n in e))return!0;for(var r in e)if(t[r]!==e[r])return!0;return!1}function T(t){return t&&t.base||t}function P(){}function C(t){function e(t,e){A(this),I.call(this,t,e,V),j.call(this,t,e)}return t=w({constructor:e},t),t.mixins&&E(t,k(t.mixins)),t.statics&&w(e,t.statics),t.propTypes&&(e.propTypes=t.propTypes),t.defaultProps&&(e.defaultProps=t.defaultProps),t.getDefaultProps&&(e.defaultProps=t.getDefaultProps()),P.prototype=I.prototype,e.prototype=w(new P,t),e.displayName=t.displayName||"Component",e}function k(t){for(var e={},n=0;n<t.length;n++){var r=t[n];for(var i in r)r.hasOwnProperty(i)&&"function"==typeof r[i]&&(e[i]||(e[i]=[])).push(r[i])}return e}function E(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=S(e[n].concat(t[n]||J),"getDefaultProps"===n||"getInitialState"===n||"getChildContext"===n))}function A(t){for(var e in t){var n=t[e];"function"!=typeof n||n.__bound||W.hasOwnProperty(e)||((t[e]=n.bind(t)).__bound=!0)}}function O(t,e,n){if("string"==typeof e&&(e=t.constructor.prototype[e]),"function"==typeof e)return e.apply(t,n)}function S(t,e){return function(){for(var n,r=arguments,i=this,o=0;o<t.length;o++){var a=O(i,t[o],r);if(e&&null!=a){n||(n={});for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])}else void 0!==a&&(n=a)}return n}}function j(t,e){D.call(this,t,e),this.componentWillReceiveProps=S([D,this.componentWillReceiveProps||"componentWillReceiveProps"]),this.render=S([D,N,this.render||"render",L])}function D(t,e){var n=this;if(t){var r=t.children;if(r&&Array.isArray(r)&&1===r.length&&(t.children=r[0],t.children&&"object"==typeof t.children&&(t.children.length=1,t.children[0]=t.children)),B){var i="function"==typeof this?this:this.constructor,o=this.propTypes||i.propTypes;if(o)for(var a in o)if(o.hasOwnProperty(a)&&"function"==typeof o[a]){var s=n.displayName||i.name;o[a](t,a,s,"prop")}}}}function N(t){$=this}function L(){$===this&&($=null)}function I(t,e,r){n.Component.call(this,t,e),this.state=this.getInitialState?this.getInitialState():{},this.refs={},this._refProxies={},r!==V&&j.call(this,t,e)}function M(t,e){I.call(this,t,e)}t="default"in t?t.default:t;var U="a abbr address area article aside audio b base bdi bdo big blockquote body br button canvas caption cite code col colgroup data datalist dd del details dfn dialog div dl dt em embed fieldset figcaption figure footer form h1 h2 h3 h4 h5 h6 head header hgroup hr html i iframe img input ins kbd keygen label legend li link main map mark menu menuitem meta meter nav noscript object ol optgroup option output p param picture pre progress q rp rt ruby s samp script section select small source span strong style sub summary sup table tbody td textarea tfoot th thead time title tr track u ul var video wbr circle clipPath defs ellipse g image line linearGradient mask path pattern polygon polyline radialGradient rect stop svg text tspan".split(" "),R="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,q="undefined"!=typeof Symbol?Symbol.for("__preactCompatWrapper"):"__preactCompatWrapper",W={constructor:1,render:1,shouldComponentUpdate:1,componentWillReceiveProps:1,componentWillUpdate:1,componentDidUpdate:1,componentWillMount:1,componentDidMount:1,componentWillUnmount:1,componentDidUnmount:1},F=/^(?:accent|alignment|arabic|baseline|cap|clip|color|fill|flood|font|glyph|horiz|marker|overline|paint|stop|strikethrough|stroke|text|underline|unicode|units|v|vert|word|writing|x)[A-Z]/,V={},B=void 0===e||!e.env||"production"!==e.env.NODE_ENV,H=n.h("a",null).constructor;H.prototype.$$typeof=R,H.prototype.preactCompatUpgraded=!1,H.prototype.preactCompatNormalized=!1,Object.defineProperty(H.prototype,"type",{get:function(){return this.nodeName},set:function(t){this.nodeName=t},configurable:!0}),Object.defineProperty(H.prototype,"props",{get:function(){return this.attributes},set:function(t){this.attributes=t},configurable:!0});var X=n.options.event;n.options.event=function(t){return X&&(t=X(t)),t.persist=Object,t.nativeEvent=t,t};var z=n.options.vnode;n.options.vnode=function(t){if(!t.preactCompatUpgraded){t.preactCompatUpgraded=!0;var e=t.nodeName,n=t.attributes=w({},t.attributes);"function"==typeof e?(!0===e[q]||e.prototype&&"isReactComponent"in e.prototype)&&(t.children&&!t.children.length&&(t.children=void 0),t.children&&(n.children=t.children),t.preactCompatNormalized||m(t),i(t)):(t.children&&!t.children.length&&(t.children=void 0),t.children&&(n.children=t.children),n.defaultValue&&(n.value||0===n.value||(n.value=n.defaultValue),delete n.defaultValue),o(t,n))}z&&z(t)};var G=function(){};G.prototype.getChildContext=function(){return this.props.context},G.prototype.render=function(t){return t.children[0]};for(var $,J=[],Z={map:function(t,e,n){return null==t?null:(t=Z.toArray(t),n&&n!==t&&(e=e.bind(n)),t.map(e))},forEach:function(t,e,n){if(null==t)return null;t=Z.toArray(t),n&&n!==t&&(e=e.bind(n)),t.forEach(e)},count:function(t){return t&&t.length||0},only:function(t){if(t=Z.toArray(t),1!==t.length)throw new Error("Children.only() expects only one child.");return t[0]},toArray:function(t){return Array.isArray&&Array.isArray(t)?t:J.concat(t)}},K={},Y=U.length;Y--;)K[U[Y]]=l(U[Y]);return w(I.prototype=new n.Component,{constructor:I,isReactComponent:{},replaceState:function(t,e){var n=this;this.setState(t,e);for(var r in n.state)r in t||delete n.state[r]},getDOMNode:function(){return this.base},isMounted:function(){return!!this.base}}),P.prototype=I.prototype,M.prototype=new P,M.prototype.shouldComponentUpdate=function(t,e){return x(this.props,t)||x(this.state,e)},{version:"15.1.0",DOM:K,PropTypes:t,Children:Z,render:a,createClass:C,createFactory:l,createElement:h,cloneElement:v,isValidElement:g,findDOMNode:T,unmountComponentAtNode:u,Component:I,PureComponent:M,unstable_renderSubtreeIntoContainer:s}}(n(26),n(2))}()}).call(e,n(13))},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(t){if(c===setTimeout)return setTimeout(t,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(t,0);try{return c(t,0)}catch(e){try{return c.call(null,t,0)}catch(e){return c.call(this,t,0)}}}function o(t){if(f===clearTimeout)return clearTimeout(t);if((f===r||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(t);try{return f(t)}catch(e){try{return f.call(null,t)}catch(e){return f.call(this,t)}}}function a(){m&&d&&(m=!1,d.length?h=d.concat(h):v=-1,h.length&&s())}function s(){if(!m){var t=i(a);m=!0;for(var e=h.length;e;){for(d=h,h=[];++v<e;)d&&d[v].run();v=-1,e=h.length}d=null,m=!1,o(t)}}function u(t,e){this.fun=t,this.array=e}function l(){}var c,f,p=t.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(t){c=n}try{f="function"==typeof clearTimeout?clearTimeout:r}catch(t){f=r}}();var d,h=[],m=!1,v=-1;p.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];h.push(new u(t,e)),1!==h.length||m||i(s)},u.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=l,p.addListener=l,p.once=l,p.off=l,p.removeListener=l,p.removeAllListeners=l,p.emit=l,p.binding=function(t){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(t){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(t,e,n){function r(t){return n(i(t))}function i(t){return o[t]||function(){throw new Error("Cannot find module '"+t+"'.")}()}var o={"./taffy/lib/taffy":32};r.keys=function(){return Object.keys(o)},r.resolve=i,t.exports=r,r.id=14},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(2),s=n(17),u=r(s),l=n(5),c=r(l),f=function(){function t(){i(this,t)}return o(t,[{key:"init",value:function(t){if(window.__tpFetchComplete)(0,a.render)((0,a.h)(u.default,null),t.ele);else{var e=document.body;c.default.addEvent(e,"tpFetchComplete",function(){(0,a.render)((0,a.h)(u.default,null),t.ele)})}}}]),t}();e.default=new f},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(2),s=n(21),u=r(s),l=n(5),c=r(l),f=function(){function t(){i(this,t)}return o(t,[{key:"init",value:function(t){if(window.__tpFetchComplete)(0,a.render)((0,a.h)(u.default,null),t.ele);else{var e=document.body;c.default.addEvent(e,"tpFetchComplete",function(){(0,a.render)((0,a.h)(u.default,null),t.ele)})}}}]),t}();e.default=new f},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=n(2),c=n(4),f=r(c),p=n(3),d=r(p),h=n(7),m=r(h),v=n(19),g=r(v),y=n(20),_=r(y),b=n(1);b=b.constants;var w=function(t){function e(){i(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this)),n=d.default.getUserPointsnEngagement(),r=d.default.getUserChannelDetails();return t.state={activeView:r&&r.userId?n?"postlogin":"":"prelogin",points:m.default.getTotalPoints()},t.initListners(),t}return a(e,t),u(e,[{key:"initListners",value:function(){var t=this;f.default.addEvent(document.body,"prelogin-activity",function(){t.setState({points:m.default.getTotalPoints(),activeView:"prelogin"})}),f.default.addEvent(document.body,"engage-fetch-complete",function(e){t.setState({activeView:"postlogin"})})}},{key:"render",value:function(){if(""==this.state.activeView)return null;var t=f.default.getChannelLoginMethod();return(0,l.h)("div",null,(0,l.h)(_.default,{showComponent:"prelogin"===this.state.activeView,points:this.state.points,loginMethod:t}),(0,l.h)(g.default,{showComponent:"postlogin"===this.state.activeView}))}}]),e}(l.Component);e.default=w},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(2),u=n(1);u=u.constants;var l=function(t){function e(){return r(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this))}return o(e,t),a(e,[{key:"render",value:function(){return(0,s.h)("div",{class:this.props.fadeClass+" animated points-added"},(0,s.h)("span",{class:"odometer-num"},this.props.points)," TimesPoints Added")}}]),e}(s.Component);e.default=l},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=n(2),l=n(6),c=(r(l),n(4)),f=r(c),p=n(3),d=r(p),h=n(8),m=r(h),v=n(18),g=r(v),y=n(1);y=y.constants;var _=function(t){function e(){i(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.state={fetchComplete:!1,showPointsAdded:!1,points:0},t.fireGAPixel=t.fireGAPixel.bind(t),t.fireClickPixel=t.fireClickPixel.bind(t),t}return a(e,t),s(e,[{key:"fireGAPixel",value:function(){this.state.description&&ga("tpTracker.send","event",{eventCategory:d.default.channelName+"_widgetone",eventAction:"hover",eventLabel:this.state.description,nonInteraction:!0})}},{key:"fireClickPixel",value:function(){this.state.description&&(d.default.getUserChannelDetails(),ga("tpTracker.send","event",{eventCategory:d.default.channelName+"_widgetone",eventAction:"click_out",eventLabel:this.state.description,nonInteraction:!0}))}},{key:"componentWillReceiveProps",value:function(t){this.updateWidget(t.showComponent)}},{key:"updateWidget",value:function(t){if(t){var e=this,n=f.default.checkLogin(),r=d.default.ltp({e:n.user.email}),i=r.first();i=Number(i.p);var o=0,a=d.default.getUserPointsnEngagement();i<=0?(e.setState({description:a.description,link:a.link,fetchComplete:!0,showPointsAdded:!1,points:a.points,showComponent:!0,aText:a.aText}),i?d.default.ltp({e:n.user.email}).update({e:n.user.email,p:a.points}):d.default.ltp.insert({e:n.user.email,p:a.points})):(e.setState({points:isNaN(i)?0:i,showComponent:!0}),i>0&&a.points>i?(setTimeout(function(){e.setState({showPointsAdded:!0,fadeClass:"fadeIn",addedPoints:a.points-i})},2e3),o=5e3):o=0,setTimeout(function(){i?d.default.ltp({e:n.user.email}).update({e:n.user.email,p:a.points}):d.default.ltp.insert({e:n.user.email,p:a.points}),e.setState({fadeClass:"fadeOut"})},o),setTimeout(function(){e.setState({description:a.description,link:a.link,fetchComplete:!0,showPointsAdded:!1,aText:a.aText})},o+500),setTimeout(function(){e.setState({points:a.points,showComponent:!0})},o+1e3))}else this.setState({showComponent:t})}},{key:"componentWillMount",value:function(){this.updateWidget(this.props.showComponent)}},{key:"getNextEngagementView",value:function(){return this.state.fetchComplete?(0,u.h)("a",{class:"hover-state",onClick:this.fireClickPixel,href:this.state.link,target:"_blank"},(0,u.h)("div",{class:"widget-text"},this.state.description),(0,u.h)("span",{class:"tp-btn"},this.state.aText)):""}},{key:"getPersistantView",value:function(){return(0,u.h)("div",{class:this.state.showPointsAdded?"hidden ":"normal-state"},(0,u.h)("div",{class:"tp-logo"},(0,u.h)("img",{src:y.staticPath+"/static/dist/images/crown.png"})),(0,u.h)("div",{class:"widget-text"},(0,u.h)("span",{class:"odometer-num"},(0,u.h)(m.default,{value:this.state.points,options:{format:""}}))," TimesPoints"))}},{key:"render",value:function(){return(0,u.h)("div",{id:"tpwidget-postlogin",class:"text-right tpwidget tpwidget-postlogin"+(this.state.showComponent?"":" hidden")},(0,u.h)("div",{class:"tpwidget-inline widget-postlogin clearfix",onMouseEnter:this.fireGAPixel},this.state.showPointsAdded?(0,u.h)(g.default,{points:this.state.addedPoints,fadeClass:this.state.fadeClass}):"",this.getPersistantView(),this.getNextEngagementView()))}}]),e}(u.Component);e.default=_},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),_preact=__webpack_require__(2),_reactOdometerjs=__webpack_require__(8),_reactOdometerjs2=_interopRequireDefault(_reactOdometerjs),_tpShared=__webpack_require__(3),_tpShared2=_interopRequireDefault(_tpShared),envSettings=__webpack_require__(1);envSettings=envSettings.constants;var TPWidgetOnePrelogin=function(_Component){function TPWidgetOnePrelogin(){_classCallCheck(this,TPWidgetOnePrelogin);var t=_possibleConstructorReturn(this,(TPWidgetOnePrelogin.__proto__||Object.getPrototypeOf(TPWidgetOnePrelogin)).call(this));return t.fireSignIn=t.fireSignIn.bind(t),t}return _inherits(TPWidgetOnePrelogin,_Component),_createClass(TPWidgetOnePrelogin,[{key:"fireSignIn",value:function fireSignIn(){var engagement=this.props.points<=0?_tpShared2.default.getZeroPLEngagement():_tpShared2.default.getPLEngagement();engagement.btnText&&(ga("tpTracker.send","event",{eventCategory:_tpShared2.default.channelName+"_widgetone",eventAction:"sign_in",eventLabel:"sign_in",nonInteraction:!0}),eval(this.props.loginMethod),_tpShared2.default.srcWid="widgetone")}},{key:"componentWillReceiveProps",value:function(t){this.setState({showComponent:t.showComponent})}},{key:"componentWillMount",value:function(){this.setState({showComponent:this.props.showComponent||!1})}},{key:"render",value:function(){var t=_tpShared2.default.getPLEngagement(),e=_tpShared2.default.getZeroPLEngagement();if(!t||!e)return null;var n=this.props.points>0?t.btnText:e.btnText;return(0,_preact.h)("div",{id:"tpwidget-prelogin",className:"tpwidget text-right tpwidget-prelogin"+(this.state.showComponent?"":" hidden")+(n?"":" reset-cursor")},(0,_preact.h)("div",{className:"tpwidget-inline widget-prelogin clearfix",onClick:this.fireSignIn},(0,_preact.h)("div",{className:"tp-logo"},(0,_preact.h)("img",{src:envSettings.staticPath+"/static/dist/images/crown.png"})),this.props.points>0?t.index>=0?(0,_preact.h)("div",{className:"widget-text"},t.txtArr[0]," ",(0,_preact.h)("span",{className:"odometer-num"},(0,_preact.h)(_reactOdometerjs2.default,{value:this.props.points})),1==this.props.points?" point":" points"," ",t.txtArr[1]):(0,_preact.h)("div",{className:"widget-text"},t.txtArr[0]," ",t.txtArr[1]):(0,_preact.h)("div",{className:"widget-text"},e.txtArr),n?(0,_preact.h)("span",{"data-action":"login",className:"tp-btn"},n):null))}}]),TPWidgetOnePrelogin}(_preact.Component);exports.default=TPWidgetOnePrelogin},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),_preact=__webpack_require__(2),_tpCore=__webpack_require__(6),_tpCore2=_interopRequireDefault(_tpCore),_tpShared=__webpack_require__(3),_tpShared2=_interopRequireDefault(_tpShared),_tpPrelogin=__webpack_require__(7),_tpPrelogin2=_interopRequireDefault(_tpPrelogin),_tpUtils=__webpack_require__(4),_tpUtils2=_interopRequireDefault(_tpUtils),_reactOdometerjs=__webpack_require__(8),_reactOdometerjs2=_interopRequireDefault(_reactOdometerjs),envSettings=__webpack_require__(1);envSettings=envSettings.constants;var envSettings=__webpack_require__(1);envSettings=envSettings.constants;var TPWidgetTwo=function(_Component){function TPWidgetTwo(){_classCallCheck(this,TPWidgetTwo);var t=_possibleConstructorReturn(this,(TPWidgetTwo.__proto__||Object.getPrototypeOf(TPWidgetTwo)).call(this)),e=_tpShared2.default.getUserPointsnEngagement();return t.state={activeView:e?"postlogin":"prelogin",points:_tpPrelogin2.default.getTotalPoints(),description:"Youre one step away from claiming",pointsUpdated:!1,numberOfPointsAdded:0,zeroPlText:"To Earn Points",zeroPlBtn:"Login",plBtnTxt:"Login",zeroPlBtnUrl:""},t.fireGAPixel=t.fireGAPixel.bind(t),t.fireGAEngageClickPixel=t.fireGAEngageClickPixel.bind(t),t.fireSignIn=t.fireSignIn.bind(t),t.initListners(),t}return _inherits(TPWidgetTwo,_Component),_createClass(TPWidgetTwo,[{key:"componentWillMount",value:function(){if(_tpUtils2.default.checkLogin().status){var t=_tpShared2.default.getUserPointsnEngagement();t&&void 0!==t.points?this.showPostLoginView():this.showPointsAddedView()}else{var e=_tpPrelogin2.default.getTotalPoints(),n=_tpShared2.default.getPLEngagement(),r=_tpShared2.default.getZeroPLEngagement();n&&r?this.setState({className:_tpUtils2.default.getFontClass(this.state.points),points:e,activeView:"prelogin",showPLPoints:n.index>=0,description:n.txtArr[0],postText:n.txtArr[1],plBtnTxt:n.btnText,zeroPlText:r.txtArr,zeroPlBtn:r.btnText,zeroPlBtnUrl:r.btnURL}):this.setState({className:_tpUtils2.default.getFontClass(this.state.points),points:e})}}},{key:"showPointsAddedView",value:function(t){if(this.setState({activeView:"postlogin",description:""}),t>0){var e=_tpUtils2.default.getFontClass(t);this.setState({points:t,className:e,pointsUpdated:!0})}}},{key:"showPostLoginView",value:function(){var t=_tpUtils2.default.checkLogin(),e=this,n=_tpShared2.default.ltp({e:t.user.email}),r=n.first();r=Number(r.p),e.showPointsAddedView(r);var i=_tpShared2.default.getUserPointsnEngagement(),o=0;r>0&&i.points>r?(setTimeout(function(){var t=_tpUtils2.default.getFontClass(i.points-r)+" points-added";e.setState({numberOfPointsAdded:i.points-r,description:"",className:t,isPointsAdded:!0,pointsUpdated:!1})},2e3),o=5e3):o=0,setTimeout(function(){var n=_tpUtils2.default.getFontClass(r||i.points);e.setState({numberOfPointsAdded:0,points:i.points,description:i.description,activeView:"postlogin",link:i.link,className:n,isPointsAdded:!1,pointsUpdated:!0,aText:i.aText}),r?_tpShared2.default.ltp({e:t.user.email}).update({e:t.user.email,p:i.points}):_tpShared2.default.ltp.insert({e:t.user.email,p:i.points})},o),setTimeout(function(){e.setState({className:_tpUtils2.default.getFontClass(i.points)})},o+3e3)}},{key:"initListners",value:function(){var t=this;_tpUtils2.default.addEvent(document.body,"prelogin-activity",function(){window.clearTimeout(e),t.setState({pointsUpdated:!1});var e=setTimeout(function(){
var e=_tpPrelogin2.default.getTotalPoints(),n=!!e,r=_tpShared2.default.getPLEngagement(),i=_tpShared2.default.getZeroPLEngagement();t.setState({points:e,activeView:"prelogin",showPLPoints:r.index>=0,pointsUpdated:n,description:r.txtArr[0],postText:r.txtArr[1],plBtnTxt:r.btnText,zeroPlText:i.txtArr,zeroPlBtn:i.btnText,zeroPlBtnUrl:i.btnURL})},10)}),_tpUtils2.default.addEvent(document.body,"engage-fetch-complete",function(){t.showPostLoginView()})}},{key:"fireGAPixel",value:function(){"postlogin"===this.state.activeView&&ga("tpTracker.send","event",{eventCategory:_tpShared2.default.channelName+"_widgettwo",eventAction:"hover",eventLabel:this.state.description,nonInteraction:!0})}},{key:"fireGAEngageClickPixel",value:function(){ga("tpTracker.send","event",{eventCategory:_tpShared2.default.channelName+"_widgettwo",eventAction:"click_out",eventLabel:this.state.description,nonInteraction:!0})}},{key:"fireSignIn",value:function fireSignIn(){var engagement=this.state.points&&this.state.points>0?_tpShared2.default.getPLEngagement():_tpShared2.default.getZeroPLEngagement();if(engagement.btnText){ga("tpTracker.send","event",{eventCategory:_tpShared2.default.channelName+"_widgettwo",eventAction:"sign_in",eventLabel:"sign_in",nonInteraction:!0});var lm=_tpUtils2.default.getChannelLoginMethod();eval(lm),_tpShared2.default.srcWid="widgettwo"}}},{key:"render",value:function(){var t=this.state.points<=0?this.state.zeroPlBtn:this.state.plBtnTxt;return(0,_preact.h)("div",{className:"tpwidget tpwidget-two"},(0,_preact.h)("h4",{className:"tp-name"},"TimesPoints"),(0,_preact.h)("div",{className:"tpwidget-float pos-rel"+(this.state.points<=0?" no-points":""),onMouseEnter:this.fireGAPixel},(0,_preact.h)("div",{className:"tp-logo"},(0,_preact.h)("img",{src:envSettings.staticPath+"/static/dist/images/crown.png"})),(0,_preact.h)("div",{className:(this.state.numberOfPointsAdded?"hidden ":"")+this.state.className+" tpwidget-float-head"},(0,_preact.h)("span",{className:this.state.points>0?"":" hidden"},(0,_preact.h)(_reactOdometerjs2.default,{value:this.state.points,options:{format:""}}))),(0,_preact.h)("div",{className:(this.state.numberOfPointsAdded?"animate-points ":"hidden ")+this.state.className+" tpwidget-float-head"},(0,_preact.h)("span",{className:"mid-points animated"},this.state.numberOfPointsAdded)," ",(0,_preact.h)("span",{class:"text-tiny block animated"},"Added")),(0,_preact.h)("div",{className:"ripple "+(this.state.pointsUpdated?"animate ":"")}),this.state.description||this.state.postText?(0,_preact.h)("div",{className:"tpwidget-float-content"},(0,_preact.h)("p",null,this.state.points<=0&&"prelogin"===this.state.activeView?this.state.zeroPlText:this.state.description),"prelogin"===this.state.activeView&&this.state.points>0&&this.state.showPLPoints?(0,_preact.h)("div",null,(0,_preact.h)("div",{className:"text-gold"},(0,_preact.h)("span",{className:"odometer-num"},this.state.points),1==this.state.points?" Point":" Points"),(0,_preact.h)("p",null,this.state.postText)):"",(0,_preact.h)("div",{className:"btn-space"},"prelogin"===this.state.activeView||this.state.points<=0&&"prelogin"===this.state.activeView?t?(0,_preact.h)("button",{"data-action":"login",onClick:this.fireSignIn,className:"tp-btn-flat"},t):null:(0,_preact.h)("a",{href:this.state.link,target:"_blank",onClick:this.fireGAEngageClickPixel,className:"tp-btn-flat"},this.state.aText))):""))}}]),TPWidgetTwo}(_preact.Component);exports.default=TPWidgetTwo},function(t,e,n){function r(t){if(t)return i(t)}function i(t){for(var e in r.prototype)t[e]=r.prototype[e];return t}t.exports=r,r.prototype.on=r.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},r.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+t];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var r,i=0;i<n.length;i++)if((r=n[i])===e||r.fn===e){n.splice(i,1);break}return this},r.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),n=this._callbacks["$"+t];if(n){n=n.slice(0);for(var r=0,i=n.length;r<i;++r)n[r].apply(this,e)}return this},r.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},r.prototype.hasListeners=function(t){return!!this.listeners(t).length}},,function(t,e,n){var r,i;(function(){var n,o,a,s,u,l,c,f,p,d,h,m,v,g,y,_,b,w,x,T,P,C,k,E,A,O,S,j,D,N,L,I,M=[].slice;b='<span class="odometer-value"></span>',g='<span class="odometer-ribbon"><span class="odometer-ribbon-inner">'+b+"</span></span>",s='<span class="odometer-digit"><span class="odometer-digit-spacer">8</span><span class="odometer-digit-inner">'+g+"</span></span>",c='<span class="odometer-formatting-mark"></span>',a="(,ddd).dd",f=/^\(?([^)]*)\)?(?:(.)(d+))?$/,p=30,l=2e3,n=20,d=2,u=.5,h=1e3/p,o=1e3/n,y="transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",A=document.createElement("div").style,_=null!=A.transition||null!=A.webkitTransition||null!=A.mozTransition||null!=A.oTransition,k=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,m=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,x=function(t){var e;return e=document.createElement("div"),e.innerHTML=t,e.children[0]},C=function(t,e){return t.className=t.className.replace(new RegExp("(^| )"+e.split(" ").join("|")+"( |$)","gi")," ")},w=function(t,e){return C(t,e),t.className+=" "+e},O=function(t,e){var n;if(null!=document.createEvent)return n=document.createEvent("HTMLEvents"),n.initEvent(e,!0,!0),t.dispatchEvent(n)},P=function(){var t,e;return null!=(t=null!=(e=window.performance)&&"function"==typeof e.now?e.now():void 0)?t:+new Date},E=function(t,e){return null==e&&(e=0),e?(t*=Math.pow(10,e),t+=.5,t=Math.floor(t),t/=Math.pow(10,e)):Math.round(t)},S=function(t){return t<0?Math.ceil(t):Math.floor(t)},T=function(t){return t-E(t)},D=!1,(j=function(){var t,e,n,r,i;if(!D&&null!=window.jQuery){for(D=!0,r=["html","text"],i=[],e=0,n=r.length;e<n;e++)t=r[e],i.push(function(t){var e;return e=window.jQuery.fn[t],window.jQuery.fn[t]=function(t){var n;return null==t||null==(null!=(n=this[0])?n.odometer:void 0)?e.apply(this,arguments):this[0].odometer.update(t)}}(t));return i}})(),setTimeout(j,0),v=function(){function t(e){var n,r,i,o,a,s,u,c,f,p=this;if(this.options=e,this.el=this.options.el,null!=this.el.odometer)return this.el.odometer;this.el.odometer=this,u=t.options;for(n in u)i=u[n],null==this.options[n]&&(this.options[n]=i);null==(o=this.options).duration&&(o.duration=l),this.MAX_VALUES=this.options.duration/h/d|0,this.resetFormat(),this.value=this.cleanValue(null!=(c=this.options.value)?c:""),this.renderInside(),this.render();try{for(f=["innerHTML","innerText","textContent"],a=0,s=f.length;a<s;a++)r=f[a],null!=this.el[r]&&function(t){Object.defineProperty(p.el,t,{get:function(){var e;return"innerHTML"===t?p.inside.outerHTML:null!=(e=p.inside.innerText)?e:p.inside.textContent},set:function(t){return p.update(t)}})}(r)}catch(t){this.watchForMutations()}}return t.prototype.renderInside=function(){return this.inside=document.createElement("div"),this.inside.className="odometer-inside",this.el.innerHTML="",this.el.appendChild(this.inside)},t.prototype.watchForMutations=function(){var t=this;if(null!=m)try{return null==this.observer&&(this.observer=new m(function(e){var n;return n=t.el.innerText,t.renderInside(),t.render(t.value),t.update(n)})),this.watchMutations=!0,this.startWatchingMutations()}catch(t){}},t.prototype.startWatchingMutations=function(){if(this.watchMutations)return this.observer.observe(this.el,{childList:!0})},t.prototype.stopWatchingMutations=function(){var t;return null!=(t=this.observer)?t.disconnect():void 0},t.prototype.cleanValue=function(t){var e;return"string"==typeof t&&(t=t.replace(null!=(e=this.format.radix)?e:".","<radix>"),t=t.replace(/[.,]/g,""),t=t.replace("<radix>","."),t=parseFloat(t,10)||0),E(t,this.format.precision)},t.prototype.bindTransitionEnd=function(){var t,e,n,r,i,o,a=this;if(!this.transitionEndBound){for(this.transitionEndBound=!0,e=!1,i=y.split(" "),o=[],n=0,r=i.length;n<r;n++)t=i[n],o.push(this.el.addEventListener(t,function(){return!!e||(e=!0,setTimeout(function(){return a.render(),e=!1,O(a.el,"odometerdone")},0),!0)},!1));return o}},t.prototype.resetFormat=function(){var t,e,n,r,i,o,s,u;if(t=null!=(s=this.options.format)?s:a,t||(t="d"),!(n=f.exec(t)))throw new Error("Odometer: Unparsable digit format");return u=n.slice(1,4),o=u[0],i=u[1],e=u[2],r=(null!=e?e.length:void 0)||0,this.format={repeating:o,radix:i,precision:r}},t.prototype.render=function(t){var e,n,r,i,o,a,s;for(null==t&&(t=this.value),this.stopWatchingMutations(),this.resetFormat(),this.inside.innerHTML="",o=this.options.theme,e=this.el.className.split(" "),i=[],a=0,s=e.length;a<s;a++)n=e[a],n.length&&((r=/^odometer-theme-(.+)$/.exec(n))?o=r[1]:/^odometer(-|$)/.test(n)||i.push(n));return i.push("odometer"),_||i.push("odometer-no-transitions"),o?i.push("odometer-theme-"+o):i.push("odometer-auto-theme"),this.el.className=i.join(" "),this.ribbons={},this.formatDigits(t),this.startWatchingMutations()},t.prototype.formatDigits=function(t){var e,n,r,i,o,a,s,u,l,c;if(this.digits=[],this.options.formatFunction)for(r=this.options.formatFunction(t),l=r.split("").reverse(),o=0,s=l.length;o<s;o++)n=l[o],n.match(/0-9/)?(e=this.renderDigit(),e.querySelector(".odometer-value").innerHTML=n,this.digits.push(e),this.insertDigit(e)):this.addSpacer(n);else for(i=!this.format.precision||!T(t)||!1,c=t.toString().split("").reverse(),a=0,u=c.length;a<u;a++)e=c[a],"."===e&&(i=!0),this.addDigit(e,i)},t.prototype.update=function(t){var e,n=this;if(t=this.cleanValue(t),e=t-this.value)return C(this.el,"odometer-animating-up odometer-animating-down odometer-animating"),e>0?w(this.el,"odometer-animating-up"):w(this.el,"odometer-animating-down"),this.stopWatchingMutations(),this.animate(t),this.startWatchingMutations(),setTimeout(function(){return n.el.offsetHeight,w(n.el,"odometer-animating")},0),this.value=t},t.prototype.renderDigit=function(){return x(s)},t.prototype.insertDigit=function(t,e){return null!=e?this.inside.insertBefore(t,e):this.inside.children.length?this.inside.insertBefore(t,this.inside.children[0]):this.inside.appendChild(t)},t.prototype.addSpacer=function(t,e,n){var r;return r=x(c),r.innerHTML=t,n&&w(r,n),this.insertDigit(r,e)},t.prototype.addDigit=function(t,e){var n,r,i,o;if(null==e&&(e=!0),"-"===t)return this.addSpacer(t,null,"odometer-negation-mark");if("."===t)return this.addSpacer(null!=(o=this.format.radix)?o:".",null,"odometer-radix-mark");if(e)for(i=!1;;){if(!this.format.repeating.length){if(i)throw new Error("Bad odometer format without digits");this.resetFormat(),i=!0}if(n=this.format.repeating[this.format.repeating.length-1],this.format.repeating=this.format.repeating.substring(0,this.format.repeating.length-1),"d"===n)break;this.addSpacer(n)}return r=this.renderDigit(),r.querySelector(".odometer-value").innerHTML=t,this.digits.push(r),this.insertDigit(r)},t.prototype.animate=function(t){return _&&"count"!==this.options.animation?this.animateSlide(t):this.animateCount(t)},t.prototype.animateCount=function(t){var e,n,r,i,a,s=this;if(n=+t-this.value)return i=r=P(),e=this.value,(a=function(){var u,l,c;return P()-i>s.options.duration?(s.value=t,s.render(),void O(s.el,"odometerdone")):(u=P()-r,u>o&&(r=P(),c=u/s.options.duration,l=n*c,e+=l,s.render(Math.round(e))),null!=k?k(a):setTimeout(a,o))})()},t.prototype.getDigitCount=function(){var t,e,n,r,i,o;for(r=1<=arguments.length?M.call(arguments,0):[],t=i=0,o=r.length;i<o;t=++i)n=r[t],r[t]=Math.abs(n);return e=Math.max.apply(Math,r),Math.ceil(Math.log(e+1)/Math.log(10))},t.prototype.getFractionalDigitCount=function(){var t,e,n,r,i,o,a;for(i=1<=arguments.length?M.call(arguments,0):[],e=/^\-?\d*\.(\d*?)0*$/,t=o=0,a=i.length;o<a;t=++o)r=i[t],i[t]=r.toString(),n=e.exec(i[t]),i[t]=null==n?0:n[1].length;return Math.max.apply(Math,i)},t.prototype.resetDigits=function(){return this.digits=[],this.ribbons=[],this.inside.innerHTML="",this.resetFormat()},t.prototype.animateSlide=function(t){var e,n,r,i,o,a,s,l,c,f,p,d,h,m,v,g,y,_,b,x,T,P,C,k,E,A,O;if(g=this.value,l=this.getFractionalDigitCount(g,t),l&&(t*=Math.pow(10,l),g*=Math.pow(10,l)),r=t-g){for(this.bindTransitionEnd(),i=this.getDigitCount(g,t),o=[],e=0,p=b=0;0<=i?b<i:b>i;p=0<=i?++b:--b){if(y=S(g/Math.pow(10,i-p-1)),s=S(t/Math.pow(10,i-p-1)),a=s-y,Math.abs(a)>this.MAX_VALUES){for(f=[],d=a/(this.MAX_VALUES+this.MAX_VALUES*e*u),n=y;a>0&&n<s||a<0&&n>s;)f.push(Math.round(n)),n+=d;f[f.length-1]!==s&&f.push(s),e++}else f=function(){O=[];for(var t=y;y<=s?t<=s:t>=s;y<=s?t++:t--)O.push(t);return O}.apply(this);for(p=x=0,P=f.length;x<P;p=++x)c=f[p],f[p]=Math.abs(c%10);o.push(f)}for(this.resetDigits(),A=o.reverse(),p=T=0,C=A.length;T<C;p=++T)for(f=A[p],this.digits[p]||this.addDigit(" ",p>=l),null==(_=this.ribbons)[p]&&(_[p]=this.digits[p].querySelector(".odometer-ribbon-inner")),this.ribbons[p].innerHTML="",r<0&&(f=f.reverse()),h=E=0,k=f.length;E<k;h=++E)c=f[h],v=document.createElement("div"),v.className="odometer-value",v.innerHTML=c,this.ribbons[p].appendChild(v),h===f.length-1&&w(v,"odometer-last-value"),0===h&&w(v,"odometer-first-value");return y<0&&this.addDigit("-"),m=this.inside.querySelector(".odometer-radix-mark"),null!=m&&m.parent.removeChild(m),l?this.addSpacer(this.format.radix,this.digits[l-1],"odometer-radix-mark"):void 0}},t}(),v.options=null!=(L=window.odometerOptions)?L:{},setTimeout(function(){var t,e,n,r,i;if(window.odometerOptions){r=window.odometerOptions,i=[];for(t in r)e=r[t],i.push(null!=(n=v.options)[t]?(n=v.options)[t]:n[t]=e);return i}},0),v.init=function(){var t,e,n,r,i,o;if(null!=document.querySelectorAll){for(e=document.querySelectorAll(v.options.selector||".odometer"),o=[],n=0,r=e.length;n<r;n++)t=e[n],o.push(t.odometer=new v({el:t,value:null!=(i=t.innerText)?i:t.textContent}));return o}},null!=(null!=(I=document.documentElement)?I.doScroll:void 0)&&null!=document.createEventObject?(N=document.onreadystatechange,document.onreadystatechange=function(){return"complete"===document.readyState&&!1!==v.options.auto&&v.init(),null!=N?N.apply(this,arguments):void 0}):document.addEventListener("DOMContentLoaded",function(){if(!1!==v.options.auto)return v.init()},!1),r=[],void 0!==(i=function(){return v}.apply(e,r))&&(t.exports=i)}).call(this)},function(t,e,n){(function(t){function n(t,e){for(var n=0,r=t.length-1;r>=0;r--){var i=t[r];"."===i?t.splice(r,1):".."===i?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function r(t,e){if(t.filter)return t.filter(e);for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}var i=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,o=function(t){return i.exec(t).slice(1)};e.resolve=function(){for(var e="",i=!1,o=arguments.length-1;o>=-1&&!i;o--){var a=o>=0?arguments[o]:t.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(e=a+"/"+e,i="/"===a.charAt(0))}return e=n(r(e.split("/"),function(t){return!!t}),!i).join("/"),(i?"/":"")+e||"."},e.normalize=function(t){var i=e.isAbsolute(t),o="/"===a(t,-1);return t=n(r(t.split("/"),function(t){return!!t}),!i).join("/"),t||i||(t="."),t&&o&&(t+="/"),(i?"/":"")+t},e.isAbsolute=function(t){return"/"===t.charAt(0)},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(r(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},e.relative=function(t,n){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=e.resolve(t).substr(1),n=e.resolve(n).substr(1);for(var i=r(t.split("/")),o=r(n.split("/")),a=Math.min(i.length,o.length),s=a,u=0;u<a;u++)if(i[u]!==o[u]){s=u;break}for(var l=[],u=s;u<i.length;u++)l.push("..");return l=l.concat(o.slice(s)),l.join("/")},e.sep="/",e.delimiter=":",e.dirname=function(t){var e=o(t),n=e[0],r=e[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},e.basename=function(t,e){var n=o(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},e.extname=function(t){return o(t)[3]};var a="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}}).call(e,n(13))},function(t,e,n){var r,i,o;!function(n,a){i=[e,t],r=a,void 0!==(o="function"==typeof r?r.apply(e,i):r)&&(t.exports=o)}(0,function(t,e){"use strict";function n(t){var e=t&&(b&&t[b]||t[w]);if("function"==typeof e)return e}function r(t){function e(e,n,r,i,o,a){if(i=i||x,a=a||r,null==n[r]){var s=y[o];return e?new Error("Required "+s+" `"+a+"` was not specified in `"+i+"`."):null}return t(n,r,i,o,a)}var n=e.bind(null,!1);return n.isRequired=e.bind(null,!0),n}function i(t){function e(e,n,r,i,o){var a=e[n];if(d(a)!==t){var s=y[i],u=h(a);return new Error("Invalid "+s+" `"+o+"` of type `"+u+"` supplied to `"+r+"`, expected `"+t+"`.")}return null}return r(e)}function o(t){function e(e,n,r,i,o){var a=e[n];if(!Array.isArray(a)){var s=y[i],u=d(a);return new Error("Invalid "+s+" `"+o+"` of type `"+u+"` supplied to `"+r+"`, expected an array.")}for(var l=0;l<a.length;l++){var c=t(a,l,r,i,o+"["+l+"]");if(c instanceof Error)return c}return null}return r(e)}function a(t){function e(e,n,r,i,o){if(!(e[n]instanceof t)){var a=y[i],s=t.name||x,u=m(e[n]);return new Error("Invalid "+a+" `"+o+"` of type `"+u+"` supplied to `"+r+"`, expected instance of `"+s+"`.")}return null}return r(e)}function s(t){function e(e,n,r,i,o){for(var a=e[n],s=0;s<t.length;s++)if(a===t[s])return null;var u=y[i],l=JSON.stringify(t);return new Error("Invalid "+u+" `"+o+"` of value `"+a+"` supplied to `"+r+"`, expected one of "+l+".")}return r(Array.isArray(t)?e:function(){return new Error("Invalid argument supplied to oneOf, expected an instance of array.")})}function u(t){function e(e,n,r,i,o){var a=e[n],s=d(a);if("object"!==s){var u=y[i];return new Error("Invalid "+u+" `"+o+"` of type `"+s+"` supplied to `"+r+"`, expected an object.")}for(var l in a)if(a.hasOwnProperty(l)){var c=t(a,l,r,i,o+"."+l);if(c instanceof Error)return c}return null}return r(e)}function l(t){function e(e,n,r,i,o){for(var a=0;a<t.length;a++)if(null==(0,t[a])(e,n,r,i,o))return null;var s=y[i];return new Error("Invalid "+s+" `"+o+"` supplied to `"+r+"`.")}return r(Array.isArray(t)?e:function(){return new Error("Invalid argument supplied to oneOfType, expected an instance of array.")})}function c(t){function e(e,n,r,i,o){var a=e[n],s=d(a);if("object"!==s){var u=y[i];return new Error("Invalid "+u+" `"+o+"` of type `"+s+"` supplied to `"+r+"`, expected `object`.")}for(var l in t){var c=t[l];if(c){var f=c(a,l,r,i,o+"."+l);if(f)return f}}return null}return r(e)}function f(t){switch(typeof t){case"number":case"string":case"undefined":return!0;case"boolean":return!t;case"object":if(Array.isArray(t))return t.every(f);if(null===t||g.isValidElement(t))return!0;var e=n(t);if(!e)return!1;var r,i=e.call(t);if(e!==t.entries){for(;!(r=i.next()).done;)if(!f(r.value))return!1}else for(;!(r=i.next()).done;){var o=r.value;if(o&&!f(o[1]))return!1}return!0;default:return!1}}function p(t,e){return"symbol"===t||"Symbol"===e["@@toStringTag"]||"function"==typeof Symbol&&e instanceof Symbol}function d(t){var e=typeof t;return Array.isArray(t)?"array":t instanceof RegExp?"object":p(e,t)?"symbol":e}function h(t){var e=d(t);if("object"===e){if(t instanceof Date)return"date";if(t instanceof RegExp)return"regexp"}return e}function m(t){return t.constructor&&t.constructor.name?t.constructor.name:x}var v="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,g={};g.isValidElement=function(t){return"object"==typeof t&&null!==t&&t.$$typeof===v};var y={prop:"prop",context:"context",childContext:"child context"},_={thatReturns:function(t){return function(){return t}}},b="function"==typeof Symbol&&Symbol.iterator,w="@@iterator",x="<<anonymous>>",T={array:i("array"),bool:i("boolean"),func:i("function"),number:i("number"),object:i("object"),string:i("string"),symbol:i("symbol"),any:function(){return r(_.thatReturns(null))}(),arrayOf:o,element:function(){function t(t,e,n,r,i){if(!g.isValidElement(t[e])){var o=y[r];return new Error("Invalid "+o+" `"+i+"` supplied to `"+n+"`, expected a single ReactElement.")}return null}return r(t)}(),instanceOf:a,node:function(){function t(t,e,n,r,i){if(!f(t[e])){var o=y[r];return new Error("Invalid "+o+" `"+i+"` supplied to `"+n+"`, expected a ReactNode.")}return null}return r(t)}(),objectOf:u,oneOf:s,oneOfType:l,shape:c};e.exports=T})},function(t,e,n){function r(t){return"[object Function]"===(i(t)?Object.prototype.toString.call(t):"")}var i=n(10);t.exports=r},function(t,e,n){function r(t){if(t)return i(t)}function i(t){for(var e in r.prototype)t[e]=r.prototype[e];return t}var o=n(10);t.exports=r,r.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,this},r.prototype.parse=function(t){return this._parser=t,this},r.prototype.responseType=function(t){return this._responseType=t,this},r.prototype.serialize=function(t){return this._serializer=t,this},r.prototype.timeout=function(t){if(!t||"object"!=typeof t)return this._timeout=t,this._responseTimeout=0,this;for(var e in t)switch(e){case"deadline":this._timeout=t.deadline;break;case"response":this._responseTimeout=t.response}return this},r.prototype.retry=function(t){return 0!==arguments.length&&!0!==t||(t=1),t<=0&&(t=0),this._maxRetries=t,this._retries=0,this},r.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this._end()},r.prototype.then=function(t,e){if(!this._fullfilledPromise){var n=this;this._endCalled,this._fullfilledPromise=new Promise(function(t,e){n.end(function(n,r){n?e(n):t(r)})})}return this._fullfilledPromise.then(t,e)},r.prototype.catch=function(t){return this.then(void 0,t)},r.prototype.use=function(t){return t(this),this},r.prototype.ok=function(t){if("function"!=typeof t)throw Error("Callback required");return this._okCallback=t,this},r.prototype._isResponseOK=function(t){return!!t&&(this._okCallback?this._okCallback(t):t.status>=200&&t.status<300)},r.prototype.get=function(t){return this._header[t.toLowerCase()]},r.prototype.getHeader=r.prototype.get,r.prototype.set=function(t,e){if(o(t)){for(var n in t)this.set(n,t[n]);return this}return this._header[t.toLowerCase()]=e,this.header[t]=e,this},r.prototype.unset=function(t){return delete this._header[t.toLowerCase()],delete this.header[t],this},r.prototype.field=function(t,e){if(null===t||void 0===t)throw new Error(".field(name, val) name can not be empty");if(this._data,o(t)){for(var n in t)this.field(n,t[n]);return this}if(Array.isArray(e)){for(var r in e)this.field(t,e[r]);return this}if(null===e||void 0===e)throw new Error(".field(name, val) val can not be empty");return"boolean"==typeof e&&(e=""+e),this._getFormData().append(t,e),this},r.prototype.abort=function(){return this._aborted?this:(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit("abort"),this)},r.prototype.withCredentials=function(t){return void 0==t&&(t=!0),this._withCredentials=t,this},r.prototype.redirects=function(t){return this._maxRedirects=t,this},r.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},r.prototype.send=function(t){var e=o(t),n=this._header["content-type"];if(this._formData,e&&!this._data)Array.isArray(t)?this._data=[]:this._isHost(t)||(this._data={});else if(t&&this._data&&this._isHost(this._data))throw Error("Can't merge these send calls");if(e&&o(this._data))for(var r in t)this._data[r]=t[r];else"string"==typeof t?(n||this.type("form"),n=this._header["content-type"],this._data="application/x-www-form-urlencoded"==n?this._data?this._data+"&"+t:t:(this._data||"")+t):this._data=t;return!e||this._isHost(t)?this:(n||this.type("json"),this)},r.prototype.sortQuery=function(t){return this._sort=void 0===t||t,this},r.prototype._timeoutError=function(t,e,n){if(!this._aborted){var r=new Error(t+e+"ms exceeded");r.timeout=e,r.code="ECONNABORTED",r.errno=n,this.timedout=!0,this.abort(),this.callback(r)}},r.prototype._setTimeouts=function(){var t=this;this._timeout&&!this._timer&&(this._timer=setTimeout(function(){t._timeoutError("Timeout of ",t._timeout,"ETIME")},this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout(function(){t._timeoutError("Response timeout of ",t._responseTimeout,"ETIMEDOUT")},this._responseTimeout))}},function(t,e,n){function r(t){if(t)return i(t)}function i(t){for(var e in r.prototype)t[e]=r.prototype[e];return t}var o=n(31);t.exports=r,r.prototype.get=function(t){return this.header[t.toLowerCase()]},r.prototype._setHeaderProperties=function(t){var e=t["content-type"]||"";this.type=o.type(e);var n=o.params(e);for(var r in n)this[r]=n[r];this.links={};try{t.link&&(this.links=o.parseLinks(t.link))}catch(t){}},r.prototype._setStatusProperties=function(t){var e=t/100|0;this.status=this.statusCode=t,this.statusType=e,this.info=1==e,this.ok=2==e,this.redirect=3==e,this.clientError=4==e,this.serverError=5==e,this.error=(4==e||5==e)&&this.toError(),this.accepted=202==t,this.noContent=204==t,this.badRequest=400==t,this.unauthorized=401==t,this.notAcceptable=406==t,this.forbidden=403==t,this.notFound=404==t}},function(t,e){var n=["ECONNRESET","ETIMEDOUT","EADDRINFO","ESOCKETTIMEDOUT"];t.exports=function(t,e){return!!(t&&t.code&&~n.indexOf(t.code)||e&&e.status&&e.status>=500||t&&"timeout"in t&&"ECONNABORTED"==t.code||t&&"crossDomain"in t)}},function(t,e){e.type=function(t){return t.split(/ *; */).shift()},e.params=function(t){return t.split(/ *; */).reduce(function(t,e){var n=e.split(/ *= */),r=n.shift(),i=n.shift();return r&&i&&(t[r]=i),t},{})},e.parseLinks=function(t){return t.split(/ *, */).reduce(function(t,e){var n=e.split(/ *; */),r=n[0].slice(1,-1);return t[n[1].split(/ *= */)[1].slice(1,-1)]=r,t},{})},e.cleanHeader=function(t,e){return delete t["content-type"],delete t["content-length"],delete t["transfer-encoding"],delete t.host,e&&delete t.cookie,t}},function(t,e){var n,e,r;!function(){"use strict";var t,e,i,o,a,s,u,l,c,f,p,d,h,m,v,g,y;if(!n)for(a=1,s="000000",u=1e3,l={},c=function(t){return n.isArray(t)||n.isObject(t)?t:JSON.parse(t)},f=function(t,e,n){var i,o,a;if(t&&(r.isArray(t)&&1===t.length||!r.isArray(t)))e(r.isArray(t)?t[0]:t,0);else for(o=0,t=r.isArray(t)?t:[t],a=t.length;o<a&&(i=t[o],r.isUndefined(i)&&!n||e(i,o)!==r.EXIT);o++);},p=function(t,e){var n,i=0;for(n in t)if(t.hasOwnProperty(n)&&e(t[n],n,i++)===r.EXIT)break},l.extend=function(t,e){l[t]=function(){return e.apply(this,arguments)}},d=function(t){var e;return!(!r.isString(t)||!/[t][0-9]*[r][0-9]*/i.test(t))||!!(r.isObject(t)&&t.___id&&t.___s)||!!r.isArray(t)&&(e=!0,f(t,function(t){if(!d(t))return e=!1,n.EXIT}),e)},m=function(t,e){var i=!0;return f(e,function(e){switch(r.typeOf(e)){case"function":if(!e.apply(t))return i=!1,n.EXIT;break;case"array":i=1===e.length?m(t,e[0]):2===e.length?m(t,e[0])||m(t,e[1]):3===e.length?m(t,e[0])||m(t,e[1])||m(t,e[2]):4===e.length&&(m(t,e[0])||m(t,e[1])||m(t,e[2])||m(t,e[3])),e.length>4&&f(e,function(e){m(t,e)&&(i=!0)})}}),i},h=function(t){var e=[];return r.isString(t)&&/[t][0-9]*[r][0-9]*/i.test(t)&&(t={___id:t}),r.isArray(t)?(f(t,function(t){e.push(h(t))}),t=function(){var t=this,n=!1;return f(e,function(e){m(t,e)&&(n=!0)}),n}):r.isObject(t)?(r.isObject(t)&&t.___id&&t.___s&&(t={___id:t.___id}),p(t,function(t,i){r.isObject(t)||(t={is:t}),p(t,function(t,o){var a,s=[];a="hasAll"===o?function(t,e){e(t)}:f,a(t,function(t){var e,a=!0;e=function(){var e,s=this[i];return 0===o.indexOf("!")&&"!="!==o&&"!=="!==o&&(a=!1,o=o.substring(1,o.length)),e="regex"===o?t.test(s):"lt"===o||"<"===o?s<t:"gt"===o||">"===o?s>t:"lte"===o||"<="===o?s<=t:"gte"===o||">="===o?s>=t:"left"===o?0===s.indexOf(t):"leftnocase"===o?0===s.toLowerCase().indexOf(t.toLowerCase()):"right"===o?s.substring(s.length-t.length)===t:"rightnocase"===o?s.toLowerCase().substring(s.length-t.length)===t.toLowerCase():"like"===o?s.indexOf(t)>=0:"likenocase"===o?s.toLowerCase().indexOf(t.toLowerCase())>=0:"==="===o||"is"===o?s===t:"=="===o?s==t:"!=="===o?s!==t:"!="===o?s!=t:"isnocase"===o?s.toLowerCase?s.toLowerCase()===t.toLowerCase():s===t:"has"===o?r.has(s,t):"hasall"===o?r.hasAll(s,t):-1!==o.indexOf("is")||n.isNull(s)||n.isUndefined(s)||n.isObject(t)||n.isArray(t)?r[o]&&r.isFunction(r[o])&&0===o.indexOf("is")?r[o](s)===t:!(!r[o]||!r.isFunction(r[o]))&&r[o](s,t):t===s[o],e=!(e&&!a)&&(!e&&!a||e)},s.push(e)}),1===s.length?e.push(s[0]):e.push(function(){var t=this,e=!1;return f(s,function(n){n.apply(t)&&(e=!0)}),e})})}),t=function(){var t=this,n=!0;return n=!(1===e.length&&!e[0].apply(t)||!(2!==e.length||e[0].apply(t)&&e[1].apply(t))||!(3!==e.length||e[0].apply(t)&&e[1].apply(t)&&e[2].apply(t))||!(4!==e.length||e[0].apply(t)&&e[1].apply(t)&&e[2].apply(t)&&e[3].apply(t))),e.length>4&&f(e,function(e){m(t,e)||(n=!1)}),n}):r.isFunction(t)?t:void 0},g=function(t,e){var i=function(t,i){var o=0;return r.each(e,function(e){var a,s,u,l,c;if(a=e.split(" "),s=a[0],"logical"===(u=1===a.length?"logical":a[1]))l=v(t[s]),c=v(i[s]),r.each(l.length<=c.length?l:c,function(t,e){return l[e]<c[e]?(o=-1,n.EXIT):l[e]>c[e]?(o=1,n.EXIT):void 0});else if("logicaldesc"===u)l=v(t[s]),c=v(i[s]),r.each(l.length<=c.length?l:c,function(t,e){return l[e]>c[e]?(o=-1,n.EXIT):l[e]<c[e]?(o=1,n.EXIT):void 0});else{if("asec"===u&&t[s]<i[s])return o=-1,r.EXIT;if("asec"===u&&t[s]>i[s])return o=1,r.EXIT;if("desc"===u&&t[s]>i[s])return o=-1,r.EXIT;if("desc"===u&&t[s]<i[s])return o=1,r.EXIT}if(0===o&&"logical"===u&&l.length<c.length?o=-1:0===o&&"logical"===u&&l.length>c.length?o=1:0===o&&"logicaldesc"===u&&l.length>c.length?o=-1:0===o&&"logicaldesc"===u&&l.length<c.length&&(o=1),0!==o)return r.EXIT}),o};return t&&t.push?t.sort(i):t},function(){var t={},e=0;v=function(n){return e>u&&(t={},e=0),t["_"+n]||function(){var r,i,o,a=String(n),s=[],u="_",l="";for(r=0,i=a.length;r<i;r++)o=a.charCodeAt(r),o>=48&&o<=57||46===o?("n"!==l&&(l="n",s.push(u.toLowerCase()),u=""),u+=a.charAt(r)):("s"!==l&&(l="s",s.push(parseFloat(u)),u=""),u+=a.charAt(r));return s.push("n"===l?parseFloat(u):u.toLowerCase()),s.shift(),t["_"+n]=s,e++,s}()}}(),y=function(){this.context({results:this.getDBI().query(this.context())})},l.extend("filter",function(){var t=n.mergeObj(this.context(),{run:null}),e=[];return f(t.q,function(t){e.push(t)}),t.q=e,f(arguments,function(e){t.q.push(h(e)),t.filterRaw.push(e)}),this.getroot(t)}),l.extend("order",function(t){t=t.split(",");var e,r=[];return f(t,function(t){r.push(t.replace(/^\s*/,"").replace(/\s*$/,""))}),e=n.mergeObj(this.context(),{sort:null}),e.order=r,this.getroot(e)}),l.extend("limit",function(t){var e,r=n.mergeObj(this.context(),{});return r.limit=t,r.run&&r.sort&&(e=[],f(r.results,function(r,i){if(i+1>t)return n.EXIT;e.push(r)}),r.results=e),this.getroot(r)}),l.extend("start",function(t){var e,r=n.mergeObj(this.context(),{});return r.start=t,r.run&&r.sort&&!r.limit?(e=[],f(r.results,function(n,r){r+1>t&&e.push(n)}),r.results=e):r=n.mergeObj(this.context(),{run:null,start:t}),this.getroot(r)}),l.extend("update",function(t,e,i){var o,a=!0,s={},u=arguments;return!n.isString(t)||2!==arguments.length&&3!==arguments.length?(s=t,2===u.length&&(a=e)):(s[t]=e,3===arguments.length&&(a=i)),o=this,y.call(this),
f(this.context().results,function(t){var e=s;n.isFunction(e)?e=e.apply(n.mergeObj(t,{})):r.isFunction(e)&&(e=e(n.mergeObj(t,{}))),n.isObject(e)&&o.getDBI().update(t.___id,e,a)}),this.context().results.length&&this.context({run:null}),this}),l.extend("remove",function(t){var e=this,n=0;return y.call(this),f(this.context().results,function(t){e.getDBI().remove(t.___id),n++}),this.context().results.length&&(this.context({run:null}),e.getDBI().removeCommit(t)),n}),l.extend("count",function(){return y.call(this),this.context().results.length}),l.extend("callback",function(t,e){if(t){var n=this;setTimeout(function(){y.call(n),t.call(n.getroot(n.context()))},e||0)}return null}),l.extend("get",function(){return y.call(this),this.context().results}),l.extend("stringify",function(){return JSON.stringify(this.get())}),l.extend("first",function(){return y.call(this),this.context().results[0]||!1}),l.extend("last",function(){return y.call(this),this.context().results[this.context().results.length-1]||!1}),l.extend("sum",function(){var t=0,e=this;return y.call(e),f(arguments,function(n){f(e.context().results,function(e){t+=e[n]})}),t}),l.extend("min",function(t){var e=null;return y.call(this),f(this.context().results,function(n){(null===e||n[t]<e)&&(e=n[t])}),e}),function(){var t=function(){var t,e;return t=function(t,e,n){var r,i,o;switch(2===n.length?(r=t[n[0]],o="===",i=e[n[1]]):(r=t[n[0]],o=n[1],i=e[n[2]]),o){case"===":return r===i;case"!==":return r!==i;case"<":return r<i;case">":return r>i;case"<=":return r<=i;case">=":return r>=i;case"==":return r==i;case"!=":return r!=i;default:throw String(o)+" is not supported"}},e=function(t,e){var r,i,o={};for(r in t)t.hasOwnProperty(r)&&(o[r]=t[r]);for(r in e)e.hasOwnProperty(r)&&"___id"!==r&&"___s"!==r&&(i=n.isUndefined(o[r])?"":"right_",o[i+String(r)]=e[r]);return o},function(r){var i,o,a=arguments,s=a.length,u=[];if("function"!=typeof r.filter){if(!r.TAFFY)throw"TAFFY DB or result not supplied";i=r()}else i=r;return this.context({results:this.getDBI().query(this.context())}),n.each(this.context().results,function(n){i.each(function(r){var i,l=!0;for(o=1;o<s&&(i=a[o],l="function"==typeof i?i(n,r):!("object"!=typeof i||!i.length)&&t(n,r,i));o++);l&&u.push(e(n,r))})}),n(u)()}}();l.extend("join",t)}(),l.extend("max",function(t){var e=null;return y.call(this),f(this.context().results,function(n){(null===e||n[t]>e)&&(e=n[t])}),e}),l.extend("select",function(){var t=[],e=arguments;return y.call(this),1===arguments.length?f(this.context().results,function(n){t.push(n[e[0]])}):f(this.context().results,function(n){var r=[];f(e,function(t){r.push(n[t])}),t.push(r)}),t}),l.extend("distinct",function(){var t=[],e=arguments;return y.call(this),1===arguments.length?f(this.context().results,function(r){var i=r[e[0]],o=!1;f(t,function(t){if(i===t)return o=!0,n.EXIT}),o||t.push(i)}):f(this.context().results,function(r){var i=[],o=!1;f(e,function(t){i.push(r[t])}),f(t,function(t){var r=!0;if(f(e,function(e,o){if(i[o]!==t[o])return r=!1,n.EXIT}),r)return o=!0,n.EXIT}),o||t.push(i)}),t}),l.extend("supplant",function(t,e){var n=[];return y.call(this),f(this.context().results,function(e){n.push(t.replace(/\{([^\{\}]*)\}/g,function(t,n){var r=e[n];return"string"==typeof r||"number"==typeof r?r:t}))}),e?n:n.join("")}),l.extend("each",function(t){return y.call(this),f(this.context().results,t),this}),l.extend("map",function(t){var e=[];return y.call(this),f(this.context().results,function(n){e.push(t(n))}),e}),r=function(t){var e,i,o,u=[],v={},y=1,_={template:!1,onInsert:!1,onUpdate:!1,onRemove:!1,onDBChange:!1,storageName:!1,forcePropertyCase:null,cacheSize:100,name:""},b=new Date,w=0,x=0,T={};return i=function(t){var e=[],n=!1;return 0===t.length?u:(f(t,function(t){r.isString(t)&&/[t][0-9]*[r][0-9]*/i.test(t)&&u[v[t]]&&(e.push(u[v[t]]),n=!0),r.isObject(t)&&t.___id&&t.___s&&u[v[t.___id]]&&(e.push(u[v[t.___id]]),n=!0),r.isArray(t)&&f(t,function(t){f(i(t),function(t){e.push(t)})})}),n&&e.length>1&&(e=[]),e)},e={dm:function(t){return t&&(b=t,T={},w=0,x=0),_.onDBChange&&setTimeout(function(){_.onDBChange.call(u)},0),_.storageName&&setTimeout(function(){localStorage.setItem("taffy_"+_.storageName,JSON.stringify(u))}),b},insert:function(t,i){var l=[],d=[],h=c(t);return f(h,function(t,o){var c,h;if(r.isArray(t)&&0===o)return f(t,function(t){l.push("lower"===_.forcePropertyCase?t.toLowerCase():"upper"===_.forcePropertyCase?t.toUpperCase():t)}),!0;r.isArray(t)?(c={},f(t,function(t,e){c[l[e]]=t}),t=c):r.isObject(t)&&_.forcePropertyCase&&(h={},p(t,function(e,n){h["lower"===_.forcePropertyCase?n.toLowerCase():"upper"===_.forcePropertyCase?n.toUpperCase():n]=t[n]}),t=h),y++,t.___id="T"+String(s+a).slice(-6)+"R"+String(s+y).slice(-6),t.___s=!0,d.push(t.___id),_.template&&(t=r.mergeObj(_.template,t)),u.push(t),v[t.___id]=u.length-1,_.onInsert&&(i||n.isUndefined(i))&&_.onInsert.call(t),e.dm(new Date)}),o(d)},sort:function(t){return u=g(u,t.split(",")),v={},f(u,function(t,e){v[t.___id]=e}),e.dm(new Date),!0},update:function(t,i,o){var a,s,l,c,f={};_.forcePropertyCase&&(p(i,function(t,e){f["lower"===_.forcePropertyCase?e.toLowerCase():"upper"===_.forcePropertyCase?e.toUpperCase():e]=t}),i=f),a=u[v[t]],s=r.mergeObj(a,i),l={},c=!1,p(s,function(t,e){(n.isUndefined(a[e])||a[e]!==t)&&(l[e]=t,c=!0)}),c&&(_.onUpdate&&(o||n.isUndefined(o))&&_.onUpdate.call(s,u[v[t]],l),u[v[t]]=s,e.dm(new Date))},remove:function(t){u[v[t]].___s=!1},removeCommit:function(t){var r;for(r=u.length-1;r>-1;r--)u[r].___s||(_.onRemove&&(t||n.isUndefined(t))&&_.onRemove.call(u[r]),v[u[r].___id]=void 0,u.splice(r,1));v={},f(u,function(t,e){v[t.___id]=e}),e.dm(new Date)},query:function(t){var o,a,s,l,c,d;if(_.cacheSize&&(a="",f(t.filterRaw,function(t){if(r.isFunction(t))return a="nocache",n.EXIT}),""===a&&(a=JSON.stringify(r.mergeObj(t,{q:!1,run:!1,sort:!1})))),!t.results||!t.run||t.run&&e.dm()>t.run){if(s=[],_.cacheSize&&T[a])return T[a].i=w++,T[a].results;0===t.q.length&&0===t.index.length?(f(u,function(t){s.push(t)}),o=s):(l=i(t.index),f(l,function(e){(0===t.q.length||m(e,t.q))&&s.push(e)}),o=s)}else o=t.results;return!(t.order.length>0)||t.run&&t.sort||(o=g(o,t.order)),o.length&&(t.limit&&t.limit<o.length||t.start)&&(c=[],f(o,function(e,r){if(!t.start||t.start&&r+1>=t.start)if(t.limit){if((d=t.start?r+1-t.start:r)<t.limit)c.push(e);else if(d>t.limit)return n.EXIT}else c.push(e)}),o=c),_.cacheSize&&"nocache"!==a&&(x++,setTimeout(function(){var t,e;x>=2*_.cacheSize&&(x=0,t=w-_.cacheSize,e={},p(function(n,r){n.i>=t&&(e[r]=n)}),T=e)},0),T[a]={i:w++,results:o}),o}},o=function(){var t,r;return t=n.mergeObj(n.mergeObj(l,{insert:void 0}),{getDBI:function(){return e},getroot:function(t){return o.call(t)},context:function(t){return t&&(r=n.mergeObj(r,t.hasOwnProperty("results")?n.mergeObj(t,{run:new Date,sort:new Date}):t)),r},extend:void 0}),r=this&&this.q?this:{limit:!1,start:!1,q:[],filterRaw:[],index:[],order:[],results:!1,run:null,sort:null,settings:_},f(arguments,function(t){d(t)?r.index.push(t):r.q.push(h(t)),r.filterRaw.push(t)}),t},a++,t&&e.insert(t),o.insert=e.insert,o.merge=function(t,n,r){var i={},a=[],s={};return r=r||!1,n=n||"id",f(t,function(t){var s;i[n]=t[n],a.push(t[n]),s=o(i).first(),s?e.update(s.___id,t,r):e.insert(t,r)}),s[n]=a,o(s)},o.TAFFY=!0,o.sort=e.sort,o.settings=function(t){return t&&(_=n.mergeObj(_,t),t.template&&o().update(t.template)),_},o.store=function(t){var e;return localStorage&&(t&&(e=localStorage.getItem("taffy_"+t),e&&e.length>0&&o.insert(e),u.length>0&&setTimeout(function(){localStorage.setItem("taffy_"+_.storageName,JSON.stringify(u))})),o.settings({storageName:t})),o},o},n=r,r.each=f,r.eachin=p,r.extend=l.extend,n.EXIT="TAFFYEXIT",n.mergeObj=function(t,e){var n={};return p(t,function(e,r){n[r]=t[r]}),p(e,function(t,r){n[r]=e[r]}),n},n.has=function(t,e){var i,o=!0;if(t.TAFFY)return o=t(e),o.length>0;switch(r.typeOf(t)){case"object":if(r.isObject(e))p(e,function(i,a){if(!0!==o||r.isUndefined(t[a])||!t.hasOwnProperty(a))return o=!1,n.EXIT;o=r.has(t[a],e[a])});else if(r.isArray(e))f(e,function(i,a){if(o=r.has(t,e[a]))return n.EXIT});else if(r.isString(e))return!n.isUndefined(t[e]);return o;case"array":if(r.isObject(e))f(t,function(i,a){if(!0===(o=r.has(t[a],e)))return n.EXIT});else if(r.isArray(e))f(e,function(i,a){if(f(t,function(i,s){if(!0===(o=r.has(t[s],e[a])))return n.EXIT}),!0===o)return n.EXIT});else if(r.isString(e)||r.isNumber(e))for(i=0;i<t.length;i++)if(o=r.has(t[i],e))return!0;return o;case"string":if(r.isString(e)&&e===t)return!0;break;default:if(r.typeOf(t)===r.typeOf(e)&&t===e)return!0}return!1},n.hasAll=function(t,e){var r,i=n;return i.isArray(e)?(r=!0,f(e,function(e){if(!1===(r=i.has(t,e)))return n.EXIT}),r):i.has(t,e)},n.typeOf=function(t){var e=typeof t;return"object"===e&&(t?"number"!=typeof t.length||t.propertyIsEnumerable("length")||(e="array"):e="null"),e},n.getObjectKeys=function(t){var e=[];return p(t,function(t,n){e.push(n)}),e.sort(),e},n.isSameArray=function(t,e){return!(!n.isArray(t)||!n.isArray(e)||t.join(",")!==e.join(","))},n.isSameObject=function(t,e){var r=n,i=!0;return r.isObject(t)&&r.isObject(e)&&r.isSameArray(r.getObjectKeys(t),r.getObjectKeys(e))?p(t,function(o,a){if(!(r.isObject(t[a])&&r.isObject(e[a])&&r.isSameObject(t[a],e[a])||r.isArray(t[a])&&r.isArray(e[a])&&r.isSameArray(t[a],e[a])||t[a]===e[a]))return i=!1,n.EXIT}):i=!1,i},t=["String","Number","Object","Array","Boolean","Null","Function","Undefined"],e=function(t){return function(e){return n.typeOf(e)===t.toLowerCase()}},i=0;i<t.length;i++)o=t[i],n["is"+o]=e(o)}(),"object"==typeof e&&(e.taffy=n)}]);