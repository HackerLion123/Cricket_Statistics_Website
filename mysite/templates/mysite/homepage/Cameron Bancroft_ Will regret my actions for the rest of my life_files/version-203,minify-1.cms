(function(a){a.fn.ticker=function(c){var e=a.extend({},a.fn.ticker.defaults,c);if(a(this).length==0){if(window.console&&window.console.log){window.console.log("Element does not exist in DOM!")}else{alert("Element does not exist in DOM!")}return false}var b="#"+a(this).attr("id");var d=a(this).get(0).tagName;return this.each(function(){var g=o();var i={position:0,time:0,distance:0,newsArr:{},play:true,paused:false,contentLoaded:false,dom:{contentID:"#ticker-content-"+g,titleID:"#ticker-title-"+g,titleElem:"#ticker-title-"+g+" SPAN",tickerID:"#ticker-"+g,wrapperID:"#ticker-wrapper-"+g,revealID:"#ticker-swipe-"+g,revealElem:"#ticker-swipe-"+g+" SPAN",controlsID:"#ticker-controls-"+g,prevID:"#prev-"+g,nextID:"#next-"+g,playPauseID:"#play-pause-"+g}};
if(d!="UL"&&d!="OL"&&e.htmlFeed===true){q("Cannot use <"+d.toLowerCase()+"> type of element for this plugin - must of type <ul> or <ol>");return false}e.direction=="rtl"?e.direction="right":e.direction="left";f();function l(v){var u=0,t;for(t in v){if(v.hasOwnProperty(t)){u++}}return u}function o(){var t=new Date;return t.getTime()}function q(t){if(e.debugMode){if(window.console&&window.console.log){window.console.log(t)}else{alert(t)}}}function f(){m();a(b).wrap('<div id="'+i.dom.wrapperID.replace("#","")+'"></div>');
a(i.dom.wrapperID).children().remove();a(i.dom.wrapperID).append('<div id="'+i.dom.tickerID.replace("#","")+'" class="ticker"><div id="'+i.dom.titleID.replace("#","")+'" class="ticker-title"><span><!-- --></span></div><p class="ticker-content"> <span id="'+i.dom.contentID.replace("#","")+'" ></span></p><div id="'+i.dom.revealID.replace("#","")+'" class="ticker-swipe"><span><!-- --></span></div></div>');a(i.dom.wrapperID).removeClass("no-js").addClass("ticker-wrapper has-js "+e.direction);a(i.dom.tickerElem+","+i.dom.contentID).hide();
if(e.controls){a(i.dom.controlsID).live("click mouseover mousedown mouseout mouseup",function(u){var t=u.target.id;if(u.type=="click"){switch(t){case i.dom.prevID.replace("#",""):i.paused=true;a(i.dom.playPauseID).addClass("paused");n("prev");break;case i.dom.nextID.replace("#",""):i.paused=true;a(i.dom.playPauseID).addClass("paused");n("next");break;case i.dom.playPauseID.replace("#",""):if(i.play==true){i.paused=true;a(i.dom.playPauseID).addClass("paused");j()}else{i.paused=false;a(i.dom.playPauseID).removeClass("paused");
p()}break}}else{if(u.type=="mouseover"&&a("#"+t).hasClass("controls")){a("#"+t).addClass("over")}else{if(u.type=="mousedown"&&a("#"+t).hasClass("controls")){a("#"+t).addClass("down")}else{if(u.type=="mouseup"&&a("#"+t).hasClass("controls")){a("#"+t).removeClass("down")}else{if(u.type=="mouseout"&&a("#"+t).hasClass("controls")){a("#"+t).removeClass("over")}}}}}});a(i.dom.wrapperID).append('<ul id="'+i.dom.controlsID.replace("#","")+'" class="ticker-controls"><li id="'+i.dom.prevID.replace("#","")+'" class="jnt-prev controls"><a href=""><!-- --></a></li><li id="'+i.dom.playPauseID.replace("#","")+'" class="jnt-play-pause controls"><a href=""><!-- --></a></li><li id="'+i.dom.nextID.replace("#","")+'" class="jnt-next controls"><a href=""><!-- --></a></li></ul><a class="mailer_icon" title="Subscribe to Newsletter" href=/newsletterhome.cms?utm_source='+window.location.href+"&utm_medium=referral&utm_campaign=breakingnewsletter ></a>")
}if(e.displayType!="fade"){}if(!e.ajaxFeed){r()}}function m(){if(i.contentLoaded==false){if(e.ajaxFeed){if(e.feedType=="xml"){a.ajax({url:e.feedUrl,cache:false,dataType:e.feedType,async:true,success:function(z){count=0;for(var u=0;u<z.childNodes.length;u++){if(z.childNodes[u].nodeName=="rss"){xmlContent=z.childNodes[u]}}for(var v=0;v<xmlContent.childNodes.length;v++){if(xmlContent.childNodes[v].nodeName=="channel"){xmlChannel=xmlContent.childNodes[v]}}for(var t=0;t<xmlChannel.childNodes.length;t++){if(xmlChannel.childNodes[t].nodeName=="item"){xmlItems=xmlChannel.childNodes[t];
var A,w=false;for(var B=0;B<xmlItems.childNodes.length;B++){if(xmlItems.childNodes[B].nodeName=="title"){A=xmlItems.childNodes[B].lastChild.nodeValue}else{if(xmlItems.childNodes[B].nodeName=="link"){w=xmlItems.childNodes[B].lastChild.nodeValue}}if((A!==false&&A!="")&&w!==false){i.newsArr["item-"+count]={type:e.titleText,content:'<a href="'+w+'">'+A+"</a>"};count++;A=false;w=false}}}}if(l(i.newsArr<1)){q("Couldn't find any content from the XML feed for the ticker to use!");return false}i.contentLoaded=true;
r()}})}else{q("Code Me!")}}else{if(e.htmlFeed){if(a(b+" LI").length>0){a(b+" LI").each(function(t){i.newsArr["item-"+t]={type:e.titleText,content:a(this).html()}})}else{q("Couldn't find HTML any content for the ticker to use!");return false}}else{q("The ticker is set to not use any types of content! Check the settings for the ticker.");return false}}}}function r(){i.contentLoaded=true;i.nextnewslock=0;a(i.dom.titleElem).html(i.newsArr["item-"+i.position].type);a(i.dom.contentID).html(i.newsArr["item-"+i.position].content);
var w=a(i.dom.contentID).text();a(".ticker-content").css("margin-left","0px");a(".ticker-content span").css("margin-left","0px");var t=90;var u=window.innerWidth;if(u>=768&&u<=999){t=40}var v=1;if((w.length>t)&&v==1){i.nextnewslock=1;var x=(navigator.userAgent.match(/(iPad)/g)?true:false);if(x){timer=3000}else{timer=6500}shift=0;setTimeout(function(){mycount=function(z,A){var B=window.innerWidth;if(B>=768&&B<=999){A+=8.5}else{A+=11.5}z++;if((w.length-t)>=z){A=mycount(z++,A)}return A};var y=mycount(1,0);
if(i.nextnewslock==1){a(".ticker-content span").css("margin-left","").delay(1).animate({marginLeft:"-"+y+"px"},((w.length-t)*310),"linear",function(){try{if(homeObj.breakingNewsPause==1){a(".ticker-content span").css("margin-left","0px")}}catch(z){console.log(z)}})}},timer)}if(i.position==(l(i.newsArr)-1)){i.position=0}else{i.position++}distance=a(i.dom.contentID).width();time=distance/e.speed;h()}function h(){a(i.dom.contentID).css("opacity","1");if(i.play){var t=a(i.dom.titleID).width()+45;a(i.dom.revealID).css(e.direction,t+"px");
if(e.displayType=="fade"){a(i.dom.revealID).hide(0,function(){a(i.dom.contentID).css(e.direction,t+"px").fadeIn(e.fadeInSpeed,k)})}else{if(e.displayType=="scroll"){}else{a(i.dom.revealElem).show(0,function(){a(i.dom.contentID).css(e.direction,t+"px").show();animationAction=e.direction=="right"?{marginRight:distance+"px"}:{marginLeft:distance+"px"};a(i.dom.revealID).css("margin-"+e.direction,"0px").delay(20).animate(animationAction,time,"linear",k)})}}}else{return false}}function k(){if(i.play){a(i.dom.contentID).delay(2500).fadeOut(e.fadeOutSpeed);
if(e.displayType=="fade"){a(i.dom.contentID).fadeOut(e.fadeOutSpeed,function(){a(i.dom.wrapperID).find(i.dom.revealElem+","+i.dom.contentID).hide().end().find(i.dom.tickerID+","+i.dom.revealID).show().end().find(i.dom.tickerID+","+i.dom.revealID).removeAttr("style");r()})}else{a(i.dom.revealID).hide(0,function(){a(i.dom.contentID).fadeOut(e.fadeOutSpeed,function(){a(i.dom.wrapperID).find(i.dom.revealElem+","+i.dom.contentID).hide().end().find(i.dom.tickerID+","+i.dom.revealID).show().end().find(i.dom.tickerID+","+i.dom.revealID).removeAttr("style");
r()})})}}else{a(i.dom.revealElem).hide()}}function j(){homeObj.breakingNewsPause=1;i.play=false;a(i.dom.tickerID+","+i.dom.revealID+","+i.dom.titleID+","+i.dom.titleElem+","+i.dom.revealElem+","+i.dom.contentID).stop(true,true);a(i.dom.revealID+","+i.dom.revealElem).hide();a(i.dom.wrapperID).find(i.dom.titleID+","+i.dom.titleElem).show().end().find(i.dom.contentID).show()}function p(){i.nextnewslock=0;i.play=true;i.paused=false;homeObj.breakingNewsPause=0;k()}function n(t){j();homeObj.breakingNewsPause=1;
a(".ticker-content span").css("margin-left","0px");switch(t){case"prev":if(i.position==0){i.position=l(i.newsArr)-2}else{if(i.position==1){i.position=l(i.newsArr)-1}else{i.position=i.position-2}}a(i.dom.titleElem).html(i.newsArr["item-"+i.position].type);a(i.dom.contentID).html(i.newsArr["item-"+i.position].content);break;case"next":a(i.dom.titleElem).html(i.newsArr["item-"+i.position].type);a(i.dom.contentID).html(i.newsArr["item-"+i.position].content);break}if(i.position==(l(i.newsArr)-1)){i.position=0
}else{i.position++}}})};a.fn.ticker.defaults={speed:0.1,ajaxFeed:false,feedUrl:"",feedType:"xml",displayType:"reveal",htmlFeed:true,debugMode:true,controls:true,titleText:"Breaking News",direction:"ltr",pauseOnItems:3000,fadeInSpeed:600,fadeOutSpeed:300}})(jQuery);(function(f){function g(a){var n=a||window.event,m=[].slice.call(arguments,1),l=0,k=!0,j=0,i=0;return a=f.event.fix(n),a.type="mousewheel",n.wheelDelta&&(l=n.wheelDelta/120),n.detail&&(l=-n.detail/3),i=l,n.axis!==undefined&&n.axis===n.HORIZONTAL_AXIS&&(i=0,j=-1*l),n.wheelDeltaY!==undefined&&(i=n.wheelDeltaY/120),n.wheelDeltaX!==undefined&&(j=-1*n.wheelDeltaX/120),m.unshift(a,l,j,i),(f.event.dispatch||f.event.handle).apply(this,m)
}var e=["DOMMouseScroll","mousewheel"];if(f.event.fixHooks){for(var h=e.length;h;){f.event.fixHooks[e[--h]]=f.event.mouseHooks}}f.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var b=e.length;b;){this.addEventListener(e[--b],g,!1)}}else{this.onmousewheel=g}},teardown:function(){if(this.removeEventListener){for(var b=e.length;b;){this.removeEventListener(e[--b],g,!1)}}else{this.onmousewheel=null}}},f.fn.extend({mousewheel:function(b){return b?this.bind("mousewheel",b):this.trigger("mousewheel")
},unmousewheel:function(b){return this.unbind("mousewheel",b)}})})(jQuery);(function(h){var e={init:function(b){var a={set_width:false,set_height:false,horizontalScroll:false,scrollInertia:950,mouseWheel:true,mouseWheelPixels:"auto",autoDraggerLength:true,autoHideScrollbar:false,alwaysShowScrollbar:false,snapAmount:null,snapOffset:0,scrollButtons:{enable:false,scrollType:"continuous",scrollSpeed:"auto",scrollAmount:40},advanced:{updateOnBrowserResize:true,updateOnContentResize:false,autoExpandHorizontalScroll:false,autoScrollOnFocus:true,normalizeMouseWheelDelta:false},contentTouchScroll:true,callbacks:{onScrollStart:function(){},onScroll:function(){},onTotalScroll:function(){},onTotalScrollBack:function(){},onTotalScrollOffset:0,onTotalScrollBackOffset:0,whileScrolling:function(){}},theme:"light"},b=h.extend(true,a,b);
return this.each(function(){var y=h(this);if(b.set_width){y.css("width",b.set_width)}if(b.set_height){y.css("height",b.set_height)}if(!h(document).data("mCustomScrollbar-index")){h(document).data("mCustomScrollbar-index","1")}else{var G=parseInt(h(document).data("mCustomScrollbar-index"));h(document).data("mCustomScrollbar-index",G+1)}y.wrapInner("<div class='mCustomScrollBox mCS-"+b.theme+"' id='mCSB_"+h(document).data("mCustomScrollbar-index")+"' style='position:relative; height:100%; overflow:hidden; max-width:100%;' />").addClass("mCustomScrollbar _mCS_"+h(document).data("mCustomScrollbar-index"));
var E=y.children(".mCustomScrollBox");if(b.horizontalScroll){E.addClass("mCSB_horizontal").wrapInner("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />");var A=E.children(".mCSB_h_wrapper");A.wrapInner("<div class='mCSB_container' style='position:absolute; left:0;' />").children(".mCSB_container").css({width:A.children().outerWidth(),position:"relative"}).unwrap()}else{E.wrapInner("<div class='mCSB_container' style='position:relative; top:0;' />")}var w=E.children(".mCSB_container");
if(h.support.touch){w.addClass("mCS_touch")}w.after("<div class='mCSB_scrollTools' style='position:absolute;'><div class='mCSB_draggerContainer'><div class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' style='position:relative;'></div></div><div class='mCSB_draggerRail'></div></div></div>");var z=E.children(".mCSB_scrollTools"),D=z.children(".mCSB_draggerContainer"),d=D.children(".mCSB_dragger");if(b.horizontalScroll){d.data("minDraggerWidth",d.width())
}else{d.data("minDraggerHeight",d.height())}if(b.scrollButtons.enable){if(b.horizontalScroll){z.prepend("<a class='mCSB_buttonLeft' oncontextmenu='return false;'></a>").append("<a class='mCSB_buttonRight' oncontextmenu='return false;'></a>")}else{z.prepend("<a class='mCSB_buttonUp' oncontextmenu='return false;'></a>").append("<a class='mCSB_buttonDown' oncontextmenu='return false;'></a>")}}E.bind("scroll",function(){if(!y.is(".mCS_disabled")){E.scrollTop(0).scrollLeft(0)}});y.data({mCS_Init:true,mCustomScrollbarIndex:h(document).data("mCustomScrollbar-index"),horizontalScroll:b.horizontalScroll,scrollInertia:b.scrollInertia,scrollEasing:"mcsEaseOut",mouseWheel:b.mouseWheel,mouseWheelPixels:b.mouseWheelPixels,autoDraggerLength:b.autoDraggerLength,autoHideScrollbar:b.autoHideScrollbar,alwaysShowScrollbar:b.alwaysShowScrollbar,snapAmount:b.snapAmount,snapOffset:b.snapOffset,scrollButtons_enable:b.scrollButtons.enable,scrollButtons_scrollType:b.scrollButtons.scrollType,scrollButtons_scrollSpeed:b.scrollButtons.scrollSpeed,scrollButtons_scrollAmount:b.scrollButtons.scrollAmount,autoExpandHorizontalScroll:b.advanced.autoExpandHorizontalScroll,autoScrollOnFocus:b.advanced.autoScrollOnFocus,normalizeMouseWheelDelta:b.advanced.normalizeMouseWheelDelta,contentTouchScroll:b.contentTouchScroll,onScrollStart_Callback:b.callbacks.onScrollStart,onScroll_Callback:b.callbacks.onScroll,onTotalScroll_Callback:b.callbacks.onTotalScroll,onTotalScrollBack_Callback:b.callbacks.onTotalScrollBack,onTotalScroll_Offset:b.callbacks.onTotalScrollOffset,onTotalScrollBack_Offset:b.callbacks.onTotalScrollBackOffset,whileScrolling_Callback:b.callbacks.whileScrolling,bindEvent_scrollbar_drag:false,bindEvent_content_touch:false,bindEvent_scrollbar_click:false,bindEvent_mousewheel:false,bindEvent_buttonsContinuous_y:false,bindEvent_buttonsContinuous_x:false,bindEvent_buttonsPixels_y:false,bindEvent_buttonsPixels_x:false,bindEvent_focusin:false,bindEvent_autoHideScrollbar:false,mCSB_buttonScrollRight:false,mCSB_buttonScrollLeft:false,mCSB_buttonScrollDown:false,mCSB_buttonScrollUp:false});
if(b.horizontalScroll){if(y.css("max-width")!=="none"){if(!b.advanced.updateOnContentResize){b.advanced.updateOnContentResize=true}}}else{if(y.css("max-height")!=="none"){var H=false,c=parseInt(y.css("max-height"));if(y.css("max-height").indexOf("%")>=0){H=c,c=y.parent().height()*H/100}y.css("overflow","hidden");E.css("max-height",c)}}y.mCustomScrollbar("update");if(b.advanced.updateOnBrowserResize){var C,B=h(window).width(),F=h(window).height();h(window).bind("resize."+y.data("mCustomScrollbarIndex"),function(){if(C){clearTimeout(C)
}C=setTimeout(function(){if(!y.is(".mCS_disabled")&&!y.is(".mCS_destroyed")){var i=h(window).width(),j=h(window).height();if(B!==i||F!==j){if(y.css("max-height")!=="none"&&H){E.css("max-height",y.parent().height()*H/100)}y.mCustomScrollbar("update");B=i;F=j}}},150)})}if(b.advanced.updateOnContentResize){var v;if(b.horizontalScroll){var x=w.outerWidth()}else{var x=w.outerHeight()}v=setInterval(function(){if(b.horizontalScroll){if(b.advanced.autoExpandHorizontalScroll){w.css({position:"absolute",width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:w.outerWidth(),position:"relative"}).unwrap()
}var i=w.outerWidth()}else{var i=w.outerHeight()}if(i!=x){y.mCustomScrollbar("update");x=i}},300)}})},update:function(){var Q=h(this),T=Q.children(".mCustomScrollBox"),M=T.children(".mCSB_container");M.removeClass("mCS_no_scrollbar");Q.removeClass("mCS_disabled mCS_destroyed");T.scrollTop(0).scrollLeft(0);var b=T.children(".mCSB_scrollTools"),P=b.children(".mCSB_draggerContainer"),R=P.children(".mCSB_dragger");if(Q.data("horizontalScroll")){var O=b.children(".mCSB_buttonLeft"),G=b.children(".mCSB_buttonRight"),Y=T.width();
if(Q.data("autoExpandHorizontalScroll")){M.css({position:"absolute",width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:M.outerWidth(),position:"relative"}).unwrap()}var a=M.outerWidth()}else{var d=b.children(".mCSB_buttonUp"),X=b.children(".mCSB_buttonDown"),K=T.height(),V=M.outerHeight()}if(V>K&&!Q.data("horizontalScroll")){b.css("display","block");var I=P.height();if(Q.data("autoDraggerLength")){var F=Math.round(K/V*I),S=R.data("minDraggerHeight");
if(F<=S){R.css({height:S})}else{if(F>=I-10){var N=I-10;R.css({height:N})}else{R.css({height:F})}}R.children(".mCSB_dragger_bar").css({"line-height":R.height()+"px"})}var L=R.height(),c=(V-K)/(I-L);Q.data("scrollAmount",c).mCustomScrollbar("scrolling",T,M,P,R,d,X,O,G);var H=Math.abs(M.position().top);Q.mCustomScrollbar("scrollTo",H,{scrollInertia:0,trigger:"internal"})}else{if(a>Y&&Q.data("horizontalScroll")){b.css("display","block");var W=P.width();if(Q.data("autoDraggerLength")){var U=Math.round(Y/a*W),J=R.data("minDraggerWidth");
if(U<=J){R.css({width:J})}else{if(U>=W-10){var Z=W-10;R.css({width:Z})}else{R.css({width:U})}}}var E=R.width(),c=(a-Y)/(W-E);Q.data("scrollAmount",c).mCustomScrollbar("scrolling",T,M,P,R,d,X,O,G);var H=Math.abs(M.position().left);Q.mCustomScrollbar("scrollTo",H,{scrollInertia:0,trigger:"internal"})}else{T.unbind("mousewheel focusin");if(Q.data("horizontalScroll")){R.add(M).css("left",0)}else{R.add(M).css("top",0)}if(Q.data("alwaysShowScrollbar")){if(!Q.data("horizontalScroll")){R.css({height:P.height()})
}else{if(Q.data("horizontalScroll")){R.css({width:P.width()})}}}else{b.css("display","none");M.addClass("mCS_no_scrollbar")}Q.data({bindEvent_mousewheel:false,bindEvent_focusin:false})}}},scrolling:function(Z,Q,U,X,R,ac,M,c){var W=h(this);if(!W.data("bindEvent_scrollbar_drag")){var T,S,O,a,ad;if(h.support.pointer){O="pointerdown";a="pointermove";ad="pointerup"}else{if(h.support.msPointer){O="MSPointerDown";a="MSPointerMove";ad="MSPointerUp"}}if(h.support.pointer||h.support.msPointer){X.bind(O,function(j){j.preventDefault();
W.data({on_drag:true});X.addClass("mCSB_dragger_onDrag");var k=h(this),m=k.offset(),l=j.originalEvent.pageX-m.left,i=j.originalEvent.pageY-m.top;if(l<k.width()&&l>0&&i<k.height()&&i>0){T=i;S=l}});h(document).bind(a+"."+W.data("mCustomScrollbarIndex"),function(j){j.preventDefault();if(W.data("on_drag")){var k=X,m=k.offset(),l=j.originalEvent.pageX-m.left,i=j.originalEvent.pageY-m.top;x(T,S,i,l)}}).bind(ad+"."+W.data("mCustomScrollbarIndex"),function(i){W.data({on_drag:false});X.removeClass("mCSB_dragger_onDrag")
})}else{X.bind("mousedown touchstart",function(j){j.preventDefault();j.stopImmediatePropagation();var k=h(this),m=k.offset(),l,n;if(j.type==="touchstart"){var i=j.originalEvent.touches[0]||j.originalEvent.changedTouches[0];l=i.pageX-m.left;n=i.pageY-m.top}else{W.data({on_drag:true});X.addClass("mCSB_dragger_onDrag");l=j.pageX-m.left;n=j.pageY-m.top}if(l<k.width()&&l>0&&n<k.height()&&n>0){T=n;S=l}}).bind("touchmove",function(j){j.preventDefault();j.stopImmediatePropagation();var m=j.originalEvent.touches[0]||j.originalEvent.changedTouches[0],k=h(this),n=k.offset(),l=m.pageX-n.left,i=m.pageY-n.top;
x(T,S,i,l)});h(document).bind("mousemove."+W.data("mCustomScrollbarIndex"),function(j){if(W.data("on_drag")){var k=X,m=k.offset(),l=j.pageX-m.left,i=j.pageY-m.top;x(T,S,i,l)}}).bind("mouseup."+W.data("mCustomScrollbarIndex"),function(i){W.data({on_drag:false});X.removeClass("mCSB_dragger_onDrag")})}W.data({bindEvent_scrollbar_drag:true})}function x(k,j,i,l){if(W.data("horizontalScroll")){W.mCustomScrollbar("scrollTo",(X.position().left-(j))+l,{moveDragger:true,trigger:"internal"})}else{W.mCustomScrollbar("scrollTo",(X.position().top-(k))+i,{moveDragger:true,trigger:"internal"})
}}if(h.support.touch&&W.data("contentTouchScroll")){if(!W.data("bindEvent_content_touch")){var V,K,L,J,d,I,b;Q.bind("touchstart",function(i){i.stopImmediatePropagation();V=i.originalEvent.touches[0]||i.originalEvent.changedTouches[0];K=h(this);L=K.offset();d=V.pageX-L.left;J=V.pageY-L.top;I=J;b=d});Q.bind("touchmove",function(i){i.preventDefault();i.stopImmediatePropagation();V=i.originalEvent.touches[0]||i.originalEvent.changedTouches[0];K=h(this).parent();L=K.offset();d=V.pageX-L.left;J=V.pageY-L.top;
if(W.data("horizontalScroll")){W.mCustomScrollbar("scrollTo",b-d,{trigger:"internal"})}else{W.mCustomScrollbar("scrollTo",I-J,{trigger:"internal"})}})}}if(!W.data("bindEvent_scrollbar_click")){U.bind("click",function(j){var i=(j.pageY-U.offset().top)*W.data("scrollAmount"),k=h(j.target);if(W.data("horizontalScroll")){i=(j.pageX-U.offset().left)*W.data("scrollAmount")}if(k.hasClass("mCSB_draggerContainer")||k.hasClass("mCSB_draggerRail")){W.mCustomScrollbar("scrollTo",i,{trigger:"internal",scrollEasing:"draggerRailEase"})
}});W.data({bindEvent_scrollbar_click:true})}if(W.data("mouseWheel")){if(!W.data("bindEvent_mousewheel")){Z.bind("mousewheel",function(k,o){var l,m=W.data("mouseWheelPixels"),j=Math.abs(Q.position().top),i=X.position().top,n=U.height()-X.height();if(W.data("normalizeMouseWheelDelta")){if(o<0){o=-1}else{o=1}}if(m==="auto"){m=100+Math.round(W.data("scrollAmount")/2)}if(W.data("horizontalScroll")){i=X.position().left;n=U.width()-X.width();j=Math.abs(Q.position().left)}if((o>0&&i!==0)||(o<0&&i!==n)){k.preventDefault();
k.stopImmediatePropagation()}l=j-(o*m);W.mCustomScrollbar("scrollTo",l,{trigger:"internal"})});W.data({bindEvent_mousewheel:true})}}if(W.data("scrollButtons_enable")){if(W.data("scrollButtons_scrollType")==="pixels"){if(W.data("horizontalScroll")){c.add(M).unbind("mousedown touchstart MSPointerDown pointerdown mouseup MSPointerUp pointerup mouseout MSPointerOut pointerout touchend",Y,aa);W.data({bindEvent_buttonsContinuous_x:false});if(!W.data("bindEvent_buttonsPixels_x")){c.bind("click",function(i){i.preventDefault();
N(Math.abs(Q.position().left)+W.data("scrollButtons_scrollAmount"))});M.bind("click",function(i){i.preventDefault();N(Math.abs(Q.position().left)-W.data("scrollButtons_scrollAmount"))});W.data({bindEvent_buttonsPixels_x:true})}}else{ac.add(R).unbind("mousedown touchstart MSPointerDown pointerdown mouseup MSPointerUp pointerup mouseout MSPointerOut pointerout touchend",Y,aa);W.data({bindEvent_buttonsContinuous_y:false});if(!W.data("bindEvent_buttonsPixels_y")){ac.bind("click",function(i){i.preventDefault();
N(Math.abs(Q.position().top)+W.data("scrollButtons_scrollAmount"))});R.bind("click",function(i){i.preventDefault();N(Math.abs(Q.position().top)-W.data("scrollButtons_scrollAmount"))});W.data({bindEvent_buttonsPixels_y:true})}}function N(i){if(!X.data("preventAction")){X.data("preventAction",true);W.mCustomScrollbar("scrollTo",i,{trigger:"internal"})}}}else{if(W.data("horizontalScroll")){c.add(M).unbind("click");W.data({bindEvent_buttonsPixels_x:false});if(!W.data("bindEvent_buttonsContinuous_x")){c.bind("mousedown touchstart MSPointerDown pointerdown",function(j){j.preventDefault();
var i=P();W.data({mCSB_buttonScrollRight:setInterval(function(){W.mCustomScrollbar("scrollTo",Math.abs(Q.position().left)+i,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var Y=function(i){i.preventDefault();clearInterval(W.data("mCSB_buttonScrollRight"))};c.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout",Y);M.bind("mousedown touchstart MSPointerDown pointerdown",function(j){j.preventDefault();var i=P();W.data({mCSB_buttonScrollLeft:setInterval(function(){W.mCustomScrollbar("scrollTo",Math.abs(Q.position().left)-i,{trigger:"internal",scrollEasing:"easeOutCirc"})
},17)})});var aa=function(i){i.preventDefault();clearInterval(W.data("mCSB_buttonScrollLeft"))};M.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout",aa);W.data({bindEvent_buttonsContinuous_x:true})}}else{ac.add(R).unbind("click");W.data({bindEvent_buttonsPixels_y:false});if(!W.data("bindEvent_buttonsContinuous_y")){ac.bind("mousedown touchstart MSPointerDown pointerdown",function(j){j.preventDefault();var i=P();W.data({mCSB_buttonScrollDown:setInterval(function(){W.mCustomScrollbar("scrollTo",Math.abs(Q.position().top)+i,{trigger:"internal",scrollEasing:"easeOutCirc"})
},17)})});var y=function(i){i.preventDefault();clearInterval(W.data("mCSB_buttonScrollDown"))};ac.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout",y);R.bind("mousedown touchstart MSPointerDown pointerdown",function(j){j.preventDefault();var i=P();W.data({mCSB_buttonScrollUp:setInterval(function(){W.mCustomScrollbar("scrollTo",Math.abs(Q.position().top)-i,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var ab=function(i){i.preventDefault();clearInterval(W.data("mCSB_buttonScrollUp"))
};R.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout",ab);W.data({bindEvent_buttonsContinuous_y:true})}}function P(){var i=W.data("scrollButtons_scrollSpeed");if(W.data("scrollButtons_scrollSpeed")==="auto"){i=Math.round((W.data("scrollInertia")+100)/40)}return i}}}if(W.data("autoScrollOnFocus")){if(!W.data("bindEvent_focusin")){Z.bind("focusin",function(){Z.scrollTop(0).scrollLeft(0);var i=h(document.activeElement);if(i.is("input,textarea,select,button,a[tabindex],area,object")){var j=Q.position().top,l=i.position().top,k=Z.height()-i.outerHeight();
if(W.data("horizontalScroll")){j=Q.position().left;l=i.position().left;k=Z.width()-i.outerWidth()}if(j+l<0||j+l>k){W.mCustomScrollbar("scrollTo",l,{trigger:"internal"})}}});W.data({bindEvent_focusin:true})}}if(W.data("autoHideScrollbar")&&!W.data("alwaysShowScrollbar")){if(!W.data("bindEvent_autoHideScrollbar")){Z.bind("mouseenter",function(i){Z.addClass("mCS-mouse-over");g.showScrollbar.call(Z.children(".mCSB_scrollTools"))}).bind("mouseleave touchend",function(i){Z.removeClass("mCS-mouse-over");
if(i.type==="mouseleave"){g.hideScrollbar.call(Z.children(".mCSB_scrollTools"))}});W.data({bindEvent_autoHideScrollbar:true})}}},scrollTo:function(J,I){var F=h(this),z={moveDragger:false,trigger:"external",callbacks:true,scrollInertia:F.data("scrollInertia"),scrollEasing:F.data("scrollEasing")},I=h.extend(z,I),y,H=F.children(".mCustomScrollBox"),D=H.children(".mCSB_container"),w=H.children(".mCSB_scrollTools"),E=w.children(".mCSB_draggerContainer"),G=E.children(".mCSB_dragger"),c=draggerSpeed=I.scrollInertia,x,d,B,C;
if(!D.hasClass("mCS_no_scrollbar")){F.data({mCS_trigger:I.trigger});if(F.data("mCS_Init")){I.callbacks=false}if(J||J===0){if(typeof(J)==="number"){if(I.moveDragger){y=J;if(F.data("horizontalScroll")){J=G.position().left*F.data("scrollAmount")}else{J=G.position().top*F.data("scrollAmount")}draggerSpeed=0}else{y=J/F.data("scrollAmount")}}else{if(typeof(J)==="string"){var a;if(J==="top"){a=0}else{if(J==="bottom"&&!F.data("horizontalScroll")){a=D.outerHeight()-H.height()}else{if(J==="left"){a=0}else{if(J==="right"&&F.data("horizontalScroll")){a=D.outerWidth()-H.width()
}else{if(J==="first"){a=F.find(".mCSB_container").find(":first")}else{if(J==="last"){a=F.find(".mCSB_container").find(":last")}else{a=F.find(J)}}}}}}if(a.length===1){if(F.data("horizontalScroll")){J=a.position().left}else{J=a.position().top}y=J/F.data("scrollAmount")}else{y=J=a}}}if(F.data("horizontalScroll")){if(F.data("onTotalScrollBack_Offset")){d=-F.data("onTotalScrollBack_Offset")}if(F.data("onTotalScroll_Offset")){C=H.width()-D.outerWidth()+F.data("onTotalScroll_Offset")}if(y<0){y=J=0;clearInterval(F.data("mCSB_buttonScrollLeft"));
if(!d){x=true}}else{if(y>=E.width()-G.width()){y=E.width()-G.width();J=H.width()-D.outerWidth();clearInterval(F.data("mCSB_buttonScrollRight"));if(!C){B=true}}else{J=-J}}var A=F.data("snapAmount");if(A){J=Math.round(J/A)*A-F.data("snapOffset")}g.mTweenAxis.call(this,G[0],"left",Math.round(y),draggerSpeed,I.scrollEasing);g.mTweenAxis.call(this,D[0],"left",Math.round(J),c,I.scrollEasing,{onStart:function(){if(I.callbacks&&!F.data("mCS_tweenRunning")){b("onScrollStart")}if(F.data("autoHideScrollbar")&&!F.data("alwaysShowScrollbar")){g.showScrollbar.call(w)
}},onUpdate:function(){if(I.callbacks){b("whileScrolling")}},onComplete:function(){if(I.callbacks){b("onScroll");if(x||(d&&D.position().left>=d)){b("onTotalScrollBack")}if(B||(C&&D.position().left<=C)){b("onTotalScroll")}}G.data("preventAction",false);F.data("mCS_tweenRunning",false);if(F.data("autoHideScrollbar")&&!F.data("alwaysShowScrollbar")){if(!H.hasClass("mCS-mouse-over")){g.hideScrollbar.call(w)}}}})}else{if(F.data("onTotalScrollBack_Offset")){d=-F.data("onTotalScrollBack_Offset")}if(F.data("onTotalScroll_Offset")){C=H.height()-D.outerHeight()+F.data("onTotalScroll_Offset")
}if(y<0){y=J=0;clearInterval(F.data("mCSB_buttonScrollUp"));if(!d){x=true}}else{if(y>=E.height()-G.height()){y=E.height()-G.height();J=H.height()-D.outerHeight();clearInterval(F.data("mCSB_buttonScrollDown"));if(!C){B=true}}else{J=-J}}var A=F.data("snapAmount");if(A){J=Math.round(J/A)*A-F.data("snapOffset")}g.mTweenAxis.call(this,G[0],"top",Math.round(y),draggerSpeed,I.scrollEasing);g.mTweenAxis.call(this,D[0],"top",Math.round(J),c,I.scrollEasing,{onStart:function(){if(I.callbacks&&!F.data("mCS_tweenRunning")){b("onScrollStart")
}if(F.data("autoHideScrollbar")&&!F.data("alwaysShowScrollbar")){g.showScrollbar.call(w)}},onUpdate:function(){if(I.callbacks){b("whileScrolling")}},onComplete:function(){if(I.callbacks){b("onScroll");if(x||(d&&D.position().top>=d)){b("onTotalScrollBack")}if(B||(C&&D.position().top<=C)){b("onTotalScroll")}}G.data("preventAction",false);F.data("mCS_tweenRunning",false);if(F.data("autoHideScrollbar")&&!F.data("alwaysShowScrollbar")){if(!H.hasClass("mCS-mouse-over")){g.hideScrollbar.call(w)}}}})}if(F.data("mCS_Init")){F.data({mCS_Init:false})
}}}function b(i){if(F.data("mCustomScrollbarIndex")){this.mcs={top:D.position().top,left:D.position().left,draggerTop:G.position().top,draggerLeft:G.position().left,topPct:Math.round((100*Math.abs(D.position().top))/Math.abs(D.outerHeight()-H.height())),leftPct:Math.round((100*Math.abs(D.position().left))/Math.abs(D.outerWidth()-H.width()))};switch(i){case"onScrollStart":F.data("mCS_tweenRunning",true).data("onScrollStart_Callback").call(F,this.mcs);break;case"whileScrolling":F.data("whileScrolling_Callback").call(F,this.mcs);
break;case"onScroll":F.data("onScroll_Callback").call(F,this.mcs);break;case"onTotalScrollBack":F.data("onTotalScrollBack_Callback").call(F,this.mcs);break;case"onTotalScroll":F.data("onTotalScroll_Callback").call(F,this.mcs);break}}}},stop:function(){var a=h(this),c=a.children().children(".mCSB_container"),b=a.children().children().children().children(".mCSB_dragger");g.mTweenAxisStop.call(this,c[0]);g.mTweenAxisStop.call(this,b[0])},disable:function(l){var a=h(this),k=a.children(".mCustomScrollBox"),c=k.children(".mCSB_container"),d=k.children(".mCSB_scrollTools"),b=d.children().children(".mCSB_dragger");
k.unbind("mousewheel focusin mouseenter mouseleave touchend");c.unbind("touchstart touchmove");if(l){if(a.data("horizontalScroll")){b.add(c).css("left",0)}else{b.add(c).css("top",0)}}d.css("display","none");c.addClass("mCS_no_scrollbar");a.data({bindEvent_mousewheel:false,bindEvent_focusin:false,bindEvent_content_touch:false,bindEvent_autoHideScrollbar:false}).addClass("mCS_disabled")},destroy:function(){var a=h(this);a.removeClass("mCustomScrollbar _mCS_"+a.data("mCustomScrollbarIndex")).addClass("mCS_destroyed").children().children(".mCSB_container").unwrap().children().unwrap().siblings(".mCSB_scrollTools").remove();
h(document).unbind("mousemove."+a.data("mCustomScrollbarIndex")+" mouseup."+a.data("mCustomScrollbarIndex")+" MSPointerMove."+a.data("mCustomScrollbarIndex")+" MSPointerUp."+a.data("mCustomScrollbarIndex"));h(window).unbind("resize."+a.data("mCustomScrollbarIndex"))}},g={showScrollbar:function(){this.stop().animate({opacity:1},"fast")},hideScrollbar:function(){this.stop().animate({opacity:0},"fast")},mTweenAxis:function(N,L,M,O,F,a){var a=a||{},d=a.onStart||function(){},E=a.onUpdate||function(){},c=a.onComplete||function(){};
var G=A(),I,K=0,C=N.offsetTop,B=N.style;if(L==="left"){C=N.offsetLeft}var H=M-C;D();P();function A(){if(window.performance&&window.performance.now){return window.performance.now()}else{if(window.performance&&window.performance.webkitNow){return window.performance.webkitNow()}else{if(Date.now){return Date.now()}else{return new Date().getTime()}}}}function b(){if(!K){d.call()}K=A()-G;z();if(K>=N._time){N._time=(K>N._time)?K+I-(K-N._time):K+I-1;if(N._time<K+1){N._time=K+1}}if(N._time<O){N._id=_request(b)
}else{c.call()}}function z(){if(O>0){N.currVal=J(N._time,C,H,O,F);B[L]=Math.round(N.currVal)+"px"}else{B[L]=M+"px"}E.call()}function P(){I=1000/60;N._time=K+I;_request=(!window.requestAnimationFrame)?function(i){z();return setTimeout(i,0.01)}:window.requestAnimationFrame;N._id=_request(b)}function D(){if(N._id==null){return}if(!window.requestAnimationFrame){clearTimeout(N._id)}else{window.cancelAnimationFrame(N._id)}N._id=null}function J(o,i,j,k,n){switch(n){case"linear":return j*o/k+i;break;case"easeOutQuad":o/=k;
return -j*o*(o-2)+i;break;case"easeInOutQuad":o/=k/2;if(o<1){return j/2*o*o+i}o--;return -j/2*(o*(o-2)-1)+i;break;case"easeOutCubic":o/=k;o--;return j*(o*o*o+1)+i;break;case"easeOutQuart":o/=k;o--;return -j*(o*o*o*o-1)+i;break;case"easeOutQuint":o/=k;o--;return j*(o*o*o*o*o+1)+i;break;case"easeOutCirc":o/=k;o--;return j*Math.sqrt(1-o*o)+i;break;case"easeOutSine":return j*Math.sin(o/k*(Math.PI/2))+i;break;case"easeOutExpo":return j*(-Math.pow(2,-10*o/k)+1)+i;break;case"mcsEaseOut":var l=(o/=k)*o,m=l*o;
return i+j*(0.499999999999997*m*l+-2.5*l*l+5.5*m+-6.5*l+4*o);break;case"draggerRailEase":o/=k/2;if(o<1){return j/2*o*o*o+i}o-=2;return j/2*(o*o*o+2)+i;break}}},mTweenAxisStop:function(a){if(a._id==null){return}if(!window.requestAnimationFrame){clearTimeout(a._id)}else{window.cancelAnimationFrame(a._id)}a._id=null},rafPolyfill:function(){var a=["ms","moz","webkit","o"],b=a.length;while(--b>-1&&!window.requestAnimationFrame){window.requestAnimationFrame=window[a[b]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[a[b]+"CancelAnimationFrame"]||window[a[b]+"CancelRequestAnimationFrame"]
}}};g.rafPolyfill.call();h.support.touch=!!("ontouchstart" in window);h.support.pointer=window.navigator.pointerEnabled;h.support.msPointer=window.navigator.msPointerEnabled;var f=("https:"==document.location.protocol)?"https:":"http:";h.event.special.mousewheel||document.write('<script src="'+f+'//cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.0.6/jquery.mousewheel.min.js"><\/script>');h.fn.mCustomScrollbar=function(a){if(e[a]){return e[a].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof a==="object"||!a){return e.init.apply(this,arguments)
}else{h.error("Method "+a+" does not exist")}}}})(jQuery);var videos_section_slider=(function(){var e='[data-plugin="videos_section_slider"]';function c(g,f,h){if((Math.abs(parseFloat(g.css("margin-left")))+f.outerWidth())<h){return false}return true}function d(f){if(Math.abs(parseInt(f.css("margin-left")))===0){return true}return false}function a(i,h,j,g){var f=j-(Math.abs(parseFloat(i.css("margin-left")))+h.outerWidth());return f<g?f:0}function b(i,g,h,f){$.ajax({url:g,success:function(k){var j=$("<div>");
j.html(k);i.append(j.find("li"));if(typeof h=="function"){h()}},error:function(){if(typeof f=="function"){f()}}})}return{init:function(w,j,y){var o=0,q=false,k=y?y:$('<span class="btn prev disabled"><i></i></span>'),f=j?j:$('<span class="btn next disabled"><i></i></span>'),t=w.find("ul"),r=w.find("li"),m=t.closest(".slideshowbox"),p=r.length,h=r.eq(0).outerWidth(true)*Math.floor((w.outerWidth()/r.eq(0).outerWidth(true))),l=0,u=0,i=0,g=false,n=false,v=false;function x(A,z){if(z==="charts"){return}if(q){return
}if(g){q=true;k.addClass("disabled");t.animate({"margin-left":"0px"},500,function(){q=false;o=0;i=0;if(t.outerWidth(true)>=l){f.addClass("disabled");g=false}else{g=true;f.removeClass("disabled")}})}else{if(t.outerWidth(true)>=l){f.addClass("disabled");g=false}else{g=true;f.removeClass("disabled")}}if(w.outerWidth()>0&&r.eq(0).outerWidth(true)>0){h=r.eq(0).outerWidth(true)*Math.floor((w.outerWidth()/r.eq(0).outerWidth(true)))}}if(w.find(".npbtn.next").length){u=0;r.each(function(){u+=$(this).outerWidth(true)
});u=Math.round(u*10)/10;if(u===l){return}else{x();return}}r.each(function(){l+=$(this).outerWidth(true);l=Math.round(l*10)/10});if(l>t.outerWidth(true)){if(!y){w.append(k)}if(!j){w.append(f)}g=true;f.removeClass("disabled")}require(["tiljs/event"],function(z){z.subscribe("window.resize",x)});f.on("click",function(){var z=a(t,m,l,h),A=h;if(v||q||c(t,m,l)){return}if(k.hasClass("disabled")){k.removeClass("disabled")}if(z>0){A=z;i=z}if(!n&&w.data("next-url")){v=true;f.addClass("loader");b(t,w.data("next-url"),function(){l=0;
r=t.find("li");r.each(function(){l+=$(this).outerWidth(true)});l=Math.round(l*10)/10;n=true;v=false;f.removeClass("loader");require(["tiljs/plugin/lazy","toicommonjs/rodate"],function(B,C){B.load();C.uptime();if(TimesApps.WatchLaterManager.getInitStatus()){TimesApps.WatchLaterManager.updateStatus(w)}else{$(window).load(function(){TimesApps.WatchLaterManager.updateStatus(w)})}})},function(){v=false})}q=true;t.animate({"margin-left":parseFloat(t.css("margin-left"))-(A)+"px"},500,function(){q=false;
o+=1;if(c(t,m,l)){f.addClass("disabled")}})});k.on("click",function(){var A=h,z;if(v||q||d(t)){return}if(f.hasClass("disabled")){f.removeClass("disabled")}q=true;if(i>0){A=i}z=parseFloat(t.css("margin-left"))+(A);t.animate({"margin-left":(Math.abs(z)>1?z:0)+"px"},500,function(){q=false;o-=1;if(i>0){i=0}if(d(t)){k.addClass("disabled")}})})}}})();$(function(){$('[data-plugin="videos_section_slider"]').each(function(){videos_section_slider.init($(this))})});var requirejs,require,define;(function(e){var h,a,m,n,d={},c={},u={},q={},l=Object.prototype.hasOwnProperty,i=[].slice,k=/\.js$/;
function v(w,x){return l.call(w,x)}function o(z,x){var H,D,B,E,I,A,K,M,G,F,C,L,J=x&&x.split("/"),y=u.map,w=(y&&y["*"])||{};if(z){z=z.split("/");I=z.length-1;if(u.nodeIdCompat&&k.test(z[I])){z[I]=z[I].replace(k,"")}if(z[0].charAt(0)==="."&&J){L=J.slice(0,J.length-1);z=L.concat(z)}for(G=0;G<z.length;G++){C=z[G];if(C==="."){z.splice(G,1);G-=1}else{if(C===".."){if(G===0||(G===1&&z[2]==="..")||z[G-1]===".."){continue}else{if(G>0){z.splice(G-1,2);G-=2}}}}}z=z.join("/")}if((J||w)&&y){H=z.split("/");for(G=H.length;
G>0;G-=1){D=H.slice(0,G).join("/");if(J){for(F=J.length;F>0;F-=1){B=y[J.slice(0,F).join("/")];if(B){B=B[D];if(B){E=B;A=G;break}}}}if(E){break}if(!K&&w&&w[D]){K=w[D];M=G}}if(!E&&K){E=K;A=M}if(E){H.splice(0,A,E);z=H.join("/")}}return z}function t(w,x){return function(){var y=i.call(arguments,0);if(typeof y[0]!=="string"&&y.length===1){y.push(null)}return a.apply(e,y.concat([w,x]))}}function p(w){return function(x){return o(x,w)}}function f(w){return function(x){d[w]=x}}function g(x){if(v(c,x)){var w=c[x];
delete c[x];q[x]=true;h.apply(e,w)}if(!v(d,x)&&!v(q,x)){throw new Error("No "+x)}return d[x]}function r(x){var y,w=x?x.indexOf("!"):-1;if(w>-1){y=x.substring(0,w);x=x.substring(w+1,x.length)}return[y,x]}function j(w){return w?r(w):[]}m=function(w,z){var x,A=r(w),y=A[0],B=z[1];w=A[1];if(y){y=o(y,B);x=g(y)}if(y){if(x&&x.normalize){w=x.normalize(w,p(B))}else{w=o(w,B)}}else{w=o(w,B);A=r(w);y=A[0];w=A[1];if(y){x=g(y)}}return{f:y?y+"!"+w:w,n:w,pr:y,p:x}};function b(w){return function(){return(u&&u.config&&u.config[w])||{}
}}n={require:function(w){return t(w)},exports:function(w){var x=d[w];if(typeof x!=="undefined"){return x}else{return(d[w]={})}},module:function(w){return{id:w,uri:"",exports:d[w],config:b(w)}}};h=function(x,I,H,G){var B,F,C,w,z,A,D=[],y=typeof H,E;G=G||x;A=j(G);if(y==="undefined"||y==="function"){I=!I.length&&H.length?["require","exports","module"]:I;for(z=0;z<I.length;z+=1){w=m(I[z],A);F=w.f;if(F==="require"){D[z]=n.require(x)}else{if(F==="exports"){D[z]=n.exports(x);E=true}else{if(F==="module"){B=D[z]=n.module(x)
}else{if(v(d,F)||v(c,F)||v(q,F)){D[z]=g(F)}else{if(w.p){w.p.load(w.n,t(G,true),f(F),{});D[z]=d[F]}else{throw new Error(x+" missing "+F)}}}}}}C=H?H.apply(d[x],D):undefined;if(x){if(B&&B.exports!==e&&B.exports!==d[x]){d[x]=B.exports}else{if(C!==e||!E){d[x]=C}}}}else{if(x){d[x]=H}}};requirejs=require=a=function(z,A,w,x,y){if(typeof z==="string"){if(n[z]){return n[z](A)}return g(m(z,j(A)).f)}else{if(!z.splice){u=z;if(u.deps){a(u.deps,u.callback)}if(!A){return}if(A.splice){z=A;A=w;w=null}else{z=e}}}A=A||function(){};
if(typeof w==="function"){w=x;x=y}if(x){h(e,z,A,w)}else{setTimeout(function(){h(e,z,A,w)},4)}return a};a.config=function(w){return a(w)};requirejs._defined=d;define=function(w,x,y){if(typeof w!=="string"){throw new Error("See almond README: incorrect module build, no module name")}if(!x.splice){y=x;x=[]}if(!v(d,w)&&!v(c,w)){c[w]=[w,x,y]}};define.amd={jQuery:true}}());(function(){var g={};var f={};var e=[];var c=".min";var a=[{module:"json",variable:"JSON",js:"//cdnjs.cloudflare.com/ajax/libs/json2/20121008/json2"+c},{module:"jquery",variable:"jQuery",js:["//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery"+c,"//cdnjs.cloudflare.com/ajax/libs/jquery/1.8.2/jquery"+c]}];
for(var b=0;b<a.length;b++){var d=a[b];if(!window[d.variable]){f[d.module]=d.js;g[d.module]={exports:d.variable};e.push(d.module)}else{define(d.module,(function(i,h){return function(){return window[i.variable]}}(d,c)))}}require({deps:e,shim:g,paths:f})}());define("config",[],function(){return{}});require.config({shim:{},paths:{},config:{"tiljs/page":{channel:"TOI",siteId:"541cc79a8638cfd34bdc56d1a27c8cd7",domain:"indiatimes.com"},"tiljs/plugin/lazy":{skew:0,error_image:$("[data-default-image-msid]").length?("/photo/"+$("[data-default-image-msid]").attr("data-default-image-msid")+".cms"):"/photo/34824568.cms"},"tiljs/social/facebook":{xfbml:true,parse:false,appid:117787264903013,load_js:false,init:false},"tiljs/social/twitter":{parse:false,load_js:false,init:false},"tiljs/analytics/mytimes":{appKey:"TOI"},"tiljs/apps/times/comments":{loadCommentFromMytimes:true,commentType:"comments_agree"},"tiljs/apps/times/api":{post_comment:{url:"/postro2.cms",params:{medium:"WEB"}},comments:{url:"/commentsdata.cms",type:"json",params:{appkey:"TOI",msid:window.msid,sortcriteria:"CreationDate",order:"asc",size:25,lastdeenid:123,after:true,withReward:true}},comments_oldest:{url:"/commentsdata.cms",type:"json",params:{appkey:"TOI",msid:window.msid,sortcriteria:"CreationDate",order:"desc",size:25,lastdeenid:123,after:true,withReward:true}},comments_agree:{url:"/commentsdata.cms",type:"json",params:{appkey:"TOI",msid:window.msid,sortcriteria:"AgreeCount",order:"desc",size:25,lastdeenid:123,after:true,withReward:true,medium:"WEB"}},comments_disagree:{url:"/commentsdata.cms",type:"json",params:{appkey:"TOI",msid:window.msid,sortcriteria:"DisagreeCount",order:"desc",size:25,lastdeenid:123,after:true,withReward:true}},comments_discussed:{url:"/commentsdata.cms",type:"json",params:{appkey:"TOI",msid:window.msid,sortcriteria:"discussed",order:"desc",size:25,lastdeenid:123,after:true,withReward:true}}}}});
define("jquery",[],function(){return jQuery});define("tiljs/compatibility",["jquery"],function(b){var a={};if(!Array.prototype.indexOf){Array.prototype.indexOf=a.Array_indexOf=function(c,d){if(this===undefined||this===null){throw new TypeError('"this" is null or not defined')}var e=this.length>>>0;d=+d||0;if(Math.abs(d)===Infinity){d=0}if(d<0){d+=e;if(d<0){d=0}}for(;d<e;d++){if(this[d]===c){return d}}return -1}}if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/gm,"")
}}if(!String.prototype.splice){String.prototype.splice=function(c,e,d){return(this.slice(0,c)+d+this.slice(c+Math.abs(e)))}}b(function(){b("body").on("focus","[placeholder]",function(){var c=b(this);if(c.val()===c.attr("placeholder")){c.val("");c.removeClass("placeholder")}});b("body").on("blur","[placeholder]",function(){var c=b(this);if(c.val()===""||c.val()===c.attr("placeholder")){c.addClass("placeholder");c.val(c.attr("placeholder"))}});b("[placeholder]").blur()});return a});define("tiljs/cookie",[],function(){var a={};
a.get=function(d){var b=d?undefined:{};var h=document.cookie?document.cookie.split("; "):[];for(var g=0,c=h.length;g<c;g++){var j=h[g].split("=");var f=decodeURIComponent(j.shift());var e=j.join("=");e=a._parseCookieValue(e);if(d&&d===f){b=e;break}if(!d&&e!==undefined){b[f]=e}}return b};a.getAll=function(){return a.get()};a.remove=function(b,d,c){if(b){c=(c||document.location.host).split(":")[0];d=d||document.location.pathname;a.set(b,null,-1,d,c)}};a.set=function(d,f,i,h,e,g){var b="";i=(i!==undefined)?i:30;
var c=new Date();c.setTime(c.getTime()+(i*24*60*60*1000));b="; expires="+c.toGMTString();e=(e||document.location.host).split(":")[0];h=h||document.location.pathname;if(/\/.*\..*/.test(h)){h=h.split("/");h.pop();h=h.join("/")}document.cookie=d+"="+f+b+((h)?";path="+h:"")+((e&&e!="localhost")?";domain="+e:"")+((g)?";secure":"")};a._parseCookieValue=function(b){if(b.indexOf('"')===0){b=b.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")}try{return decodeURIComponent(b.replace(/\+/g," "))}catch(c){}};
return a});define("tiljs/event",[],function(){var a={},b={},d="__on_",c=(function(){var e=0;return function(){return e++}})();a.publish=function(f,i){if(!f){return null}if(b[f]){for(var j in b[f]){if(b[f].hasOwnProperty(j)){var h=b[f][j];try{h(i)}catch(g){a.publish("logger.error",g.stack)}}}}};a.subscribeAll=function(f,k,e){if(f instanceof Array){var h=[];var j=[];for(var g=0;g<f.length;g++){h.push(a.subscribe(f[g],function(i){j.push(i);if(h.length===j.length){if(k){k(j)}j=[]}},e))}return h}return a.subscribe(f,k,e)
};a.subscribe=function(f,k,e){if(f instanceof Array){var h=[];for(var g=0;g<f.length;g++){h.push(a.subscribe(f[g],k,e))}return h}if(!f||!k){return null}if(!b[f]){b[f]={}}var j=f+":"+c();b[f][j]=k;if(e){e.__callback=k}a.publish(d+f,e);return j};a.unsubscribe=function(f){if(!f){return null}var g=f.split(":");if(g.length===2){var e=g[0];if(b[e][f]){delete b[e][f];return true}}return false};a.getSubscriptions=function(e){if(!e){return b}return b[e]};a.onsubscribe=function(e,g){if(!e||!g){return null}e=d+e;
if(!b[e]){b[e]={}}var f=e+":"+c();b[e][f]=g;return f};return a});define("tiljs/logger",["./cookie","module","./event","jquery"],function(b,d,a,i){var g={},c=[];var j=["log","debug","info","warn","error"];var h={cookieName:"d",hashString:"#debugdsfgw456g",prefix:"[times_log] ",time:false,handleWindowError:true,handleJqueryError:true,logModuleLoad:true,log:false};var f=i.extend({},h,d.config());function e(l){var n=new RegExp("/(.*):([0-9]*):([0-9]*)","g");var m=n.exec(l);m=n.exec(l);m=n.exec(l);if(m){m.shift()
}return m?m.join(":").replace(f.hashString,""):null}g={};g.disable=function(){f.log=false;b.remove(f.cookieName,"/");var l,m;for(l in j){if(j.hasOwnProperty(l)){m=j[l];g[m]=(function(n){return function(){c.push.apply(c,arguments)}})(m)}}return"Logging Disabled"};g.enable=function(){f.log=true;b.set(f.cookieName,f.hashString,30,"/");var m,n;for(m in j){if(j.hasOwnProperty(m)){n=j[m];function l(){console.log.apply(this,arguments)}g[n]=(function(q){var r=function(){};var p;var o=f.prefix;if(console.log.bind==="undefined"){p=Function.prototype.bind.call(console[q],console,o)
}else{p=console[q].bind(console,o)}return p})(n);(function(o){a.subscribe("logger."+o,function(p){Function.prototype.apply.call(g[o],console,arguments)})}(n))}}return"Logging Enabled"};g.isEnabled=function(){return f.log||(window.location.hash.length>0&&window.location.hash===(f.hashString))||(b.get(f.cookieName)===f.hashString)};g.handleWindowError=function(){window.onerror=function(p,o,n,m,l){g.error.apply(this,["Error message: "+p+"\n\tURL: "+o+(n?":"+n+":"+m:"")+"\n\tLine Number: "+n+":"+m+"\n\tError: "+l]);
return true}};g.handleJqueryError=function(){i(document).ajaxError(function(n,o,m,l){if(l==="timeout"){g.error.apply(this,[l+": "+m.url])}else{g.error.apply(this,[l])}});i(document).error(function(l){g.error.apply(this,l)})};function k(){f.log=g.isEnabled();if(f.log){g.enable()}else{g.disable()}if(f.handleWindowError===true){g.handleWindowError();a.subscribe("window.load",function(){g.handleWindowError()})}if(f.handleJqueryError===true){g.handleJqueryError()}}g.getLogs=function(){return c.slice(0)
};g.getLogsStr=function(){return g.getLogs().join("\n")};k();return g});define("tiljs/is",[],function(){var a={};a.number=function(b){return typeof b==="number"};a.string=function(b){return typeof b==="string"};a.funct=a.method=function(b){return typeof b==="function"};a.object=function(b){return b!==null&&typeof b==="object"};a.array=Array&&Array.isArray?Array.isArray:function(b){return b instanceof Array};a.undefined=function(b){return typeof b==="undefined"};a.defined=function(b){return typeof b!=="undefined"
};a.exists=function(b){return a.defined(b)||b===""};a.empty=function(c){if(!a.defined(c)){return true}else{if(a.string(c)||a.array(c)){return c.length===0}else{if(a.object(c)){var b=0,d;for(d in c){if(c.hasOwnProperty(d)){b++}}return b===0}else{if(a.number(c)){return false}else{return true}}}}};a.alphaOnly=function(b){return/^[A-z\s]+$/.test(b)};a.numberOnly=function(b){return/^[0-9]+$/.test(b)};a.mobile=function(){return(function(b){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,4))
})(navigator.userAgent||navigator.vendor||window.opera)};a.tablet=function(){return(function(b){return/(?:ipad|tab)/i.test(b)})(navigator.userAgent||navigator.vendor||window.opera)};a.desktop=function(){return !a.mobile()&&!a.tablet()};a.touch=function(){return(("ontouchstart" in window)||("DocumentTouch" in window))};a.IE=function(){var c=window.navigator.userAgent;var b=c.indexOf("MSIE ");if(b>0||!!navigator.userAgent.match(/Trident.*rv\:11\./)){return true}else{return false}};a.IE11=function(){return(!!navigator.userAgent.match(/Trident\/7\./))
};a.visible=function(b){return b&&b.is(":visible")};a.iframe=function(b){return b.tagName==="IFRAME"};a.dateStr=function(c){try{new Date(c);return true}catch(b){return false}};a.email=function(b){var c=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return c.test(b)};a.url=function(c){var b=/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[\-;:&=\+\$,\w]+@)?[A-Za-z0-9\.\-]+|(?:www\.|[\-;:&=\+\$,\w]+@)[A-Za-z0-9\.\-]+)((?:\/[\+~%\/\.\w\-]*)?\??(?:[\-\+=&;%@\.\w]*)#?(?:[\.\!\/\\\w]*))?)/g;
return b.test(c)};return a});define("tiljs/string",[],function(){var a={};a.camelCase=function(b){return b.replace(/(?:^|\s)\w/g,function(c){return c.toUpperCase()}).replace(/(\s|-|_)/g,"")};a.splice=function(d,b,e,c){return(d.slice(0,b)+c+d.slice(b+Math.abs(e)))};a.startsWith=function(b,c){return b.indexOf(c)===0};return a});define("json",[],function(){return JSON});define("tiljs/util",["./logger","jquery","./is","./string","json"],function(b,g,e,a,c){b.log("util loaded");var h={};h.extend=g.extend;
h.deepextend=function(){return g.extend.apply(this,arguments)};h.xor=function(l,j){var i={},k;for(k in j){if(!l.hasOwnProperty(k)){i[k]=j[k]}}return i};h.convertObj=function(i,k){var j={};util.each(i,function(m,l){j[m]=k(m,l)});return j};h.each=function(k,m){var j,l;if(!m){return null}if(k instanceof Array){for(j=0;j<k.length;j++){if(m(j,k[j])===false){break}}}else{if(k instanceof Object){for(l in k){if(k.hasOwnProperty(l)){if(m(l,k[l])===false){break}}}}else{}}};h.wrapCallback=function(k,j){try{if(k){k.apply(this,args)
}}catch(i){b.error(i)}};h.formatNumber=function(i){if(i>=1000000000){return(i/1000000000).toFixed(1)+"G"}if(i>=1000000){return(i/1000000).toFixed(1)+"M"}if(i>=1000){return(i/1000).toFixed(1)+"K"}return i};h.getJsonFromString=function(m,j,k){j=j||"&";k=k||"=";var i={};var l=m.split(j);h.each(l,function(o,n){var p=n.split(k);i[p[0]]=p[1]});return i};h.val=function(j,i){if(e.funct(j)){return j(i)}return j};h.throttle=function(j,m){var k;var l=0;return function i(){var n=+new Date()-l;var p=this;var o=arguments;
function q(){l=+new Date();m.apply(p,o)}k&&clearTimeout(k);if(n>j){q()}else{k=setTimeout(q,j-n)}}};h.getDate=function(j){try{if(e.number(j)){return new Date(j)}else{j=j.replace(/(\d)(A|P)M/,"$1 $2M")}return new Date(j)}catch(i){b.error(i);return null}};var d=0;h.uuid=function(){var j=new Date().getTime();var i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(l){var k=(j+Math.random()*16)%16|0;j=Math.floor(j/16);return(l=="x"?k:(k&7|8)).toString(16)});return i};h.mapObj=function(j,k){if(!e.object(j)&&!e.object(k)){throw new Error("Invalid Parameters")
}var i={};h.each(j,function(m,l){if(e.funct(l)){i[m]=l(k)}else{i[m]=k[l]}});return i};h.getDomainOnly=function(i){return"."+(i||document.location.host).split(":")[0].split(".").reverse().slice(0,2).reverse().join(".")};h.format=function(k,j){var i=k;h.each(j,function(m,l){i=i.replace("{{:"+m+"}}",j[m])});i=i.replace(/{{:[a-zA_Z0-9]+}}/,"");return i};h.stringify=JSON?JSON.stringify:null;h.checkNoScript=function(i){};h.getClick=function(){return e.touch()?"touchstart":"click"};h.getParam=function(j){var i=window.location.search.replace("?","");
if(e.defined(j)){return h.deparam(i)[j]}else{return h.deparam(i)}};h.deparam=function(j){var i={};h.each(j.replace(/\+/g," ").split("&"),function(k,m){var l=m.split("=");i[decodeURIComponent(l[0])]=decodeURIComponent(l[1]||"")});return i};h.data=function(j){var k={};var i=g(j)[0].attributes;g.each(i,function(l,n){var m=n.nodeName.substr(0,5);if(m==="data-"){k[n.nodeName.replace(m,"")]=n.nodeValue}});return k};var f=function(i){Error.prototype.constructor.apply(this,arguments);this.message=i};f.prototype=new Error();
h.wrapCallback=function(i){return function(){try{return i.apply(this,arguments)}catch(j){if(j instanceof f){throw j}b.error(j);throw j}}};h.md5=function(av){function ag(i,j){return(i<<j)|(i>>>(32-j))}function ah(n,j){var l,p,o,m,i;o=(n&2147483648);m=(j&2147483648);l=(n&1073741824);p=(j&1073741824);i=(n&1073741823)+(j&1073741823);if(l&p){return(i^2147483648^o^m)}if(l|p){if(i&1073741824){return(i^3221225472^o^m)}else{return(i^1073741824^o^m)}}else{return(i^o^m)}}function aw(l,j,i){return(l&j)|((~l)&i)
}function ax(l,j,i){return(l&i)|(j&(~i))}function ay(l,j,i){return(l^j^i)}function aA(l,j,i){return(j^(l|(~i)))}function at(m,n,p,o,i,l,j){m=ah(m,ah(ah(aw(n,p,o),i),j));return ah(ag(m,l),n)}function aH(m,n,p,o,i,l,j){m=ah(m,ah(ah(ax(n,p,o),i),j));return ah(ag(m,l),n)}function ak(m,n,p,o,i,l,j){m=ah(m,ah(ah(ay(n,p,o),i),j));return ah(ag(m,l),n)}function au(m,n,p,o,i,l,j){m=ah(m,ah(ah(aA(n,p,o),i),j));return ah(ag(m,l),n)}function aI(q){var j;var r=q.length;var n=r+8;var l=(n-(n%64))/64;var o=(l+1)*16;
var i=Array(o-1);var m=0;var p=0;while(p<r){j=(p-(p%4))/4;m=(p%4)*8;i[j]=(i[j]|(q.charCodeAt(p)<<m));p++}j=(p-(p%4))/4;m=(p%4)*8;i[j]=i[j]|(128<<m);i[o-2]=r<<3;i[o-1]=r>>>29;return i}function am(i){var j="",m="",l,n;for(n=0;n<=3;n++){l=(i>>>(n*8))&255;m="0"+l.toString(16);j=j+m.substr(m.length-2,2)}return j}function ai(j){j=j.replace(/rn/g,"n");var m="";for(var l=0;l<j.length;l++){var i=j.charCodeAt(l);if(i<128){m+=String.fromCharCode(i)}else{if((i>127)&&(i<2048)){m+=String.fromCharCode((i>>6)|192);
m+=String.fromCharCode((i&63)|128)}else{m+=String.fromCharCode((i>>12)|224);m+=String.fromCharCode(((i>>6)&63)|128);m+=String.fromCharCode((i&63)|128)}}}return m}var al=Array();var ac,aF,aj,ar,aG,k,x,F,G;var Z=7,ab=12,ae=17,af=22;var an=5,ao=9,ap=14,aq=20;var az=4,aB=11,aC=16,aD=23;var H=6,I=10,aa=15,ad=21;av=ai(av);al=aI(av);k=1732584193;x=4023233417;F=2562383102;G=271733878;for(ac=0;ac<al.length;ac+=16){aF=k;aj=x;ar=F;aG=G;k=at(k,x,F,G,al[ac+0],Z,3614090360);G=at(G,k,x,F,al[ac+1],ab,3905402710);
F=at(F,G,k,x,al[ac+2],ae,606105819);x=at(x,F,G,k,al[ac+3],af,3250441966);k=at(k,x,F,G,al[ac+4],Z,4118548399);G=at(G,k,x,F,al[ac+5],ab,1200080426);F=at(F,G,k,x,al[ac+6],ae,2821735955);x=at(x,F,G,k,al[ac+7],af,4249261313);k=at(k,x,F,G,al[ac+8],Z,1770035416);G=at(G,k,x,F,al[ac+9],ab,2336552879);F=at(F,G,k,x,al[ac+10],ae,4294925233);x=at(x,F,G,k,al[ac+11],af,2304563134);k=at(k,x,F,G,al[ac+12],Z,1804603682);G=at(G,k,x,F,al[ac+13],ab,4254626195);F=at(F,G,k,x,al[ac+14],ae,2792965006);x=at(x,F,G,k,al[ac+15],af,1236535329);
k=aH(k,x,F,G,al[ac+1],an,4129170786);G=aH(G,k,x,F,al[ac+6],ao,3225465664);F=aH(F,G,k,x,al[ac+11],ap,643717713);x=aH(x,F,G,k,al[ac+0],aq,3921069994);k=aH(k,x,F,G,al[ac+5],an,3593408605);G=aH(G,k,x,F,al[ac+10],ao,38016083);F=aH(F,G,k,x,al[ac+15],ap,3634488961);x=aH(x,F,G,k,al[ac+4],aq,3889429448);k=aH(k,x,F,G,al[ac+9],an,568446438);G=aH(G,k,x,F,al[ac+14],ao,3275163606);F=aH(F,G,k,x,al[ac+3],ap,4107603335);x=aH(x,F,G,k,al[ac+8],aq,1163531501);k=aH(k,x,F,G,al[ac+13],an,2850285829);G=aH(G,k,x,F,al[ac+2],ao,4243563512);
F=aH(F,G,k,x,al[ac+7],ap,1735328473);x=aH(x,F,G,k,al[ac+12],aq,2368359562);k=ak(k,x,F,G,al[ac+5],az,4294588738);G=ak(G,k,x,F,al[ac+8],aB,2272392833);F=ak(F,G,k,x,al[ac+11],aC,1839030562);x=ak(x,F,G,k,al[ac+14],aD,4259657740);k=ak(k,x,F,G,al[ac+1],az,2763975236);G=ak(G,k,x,F,al[ac+4],aB,1272893353);F=ak(F,G,k,x,al[ac+7],aC,4139469664);x=ak(x,F,G,k,al[ac+10],aD,3200236656);k=ak(k,x,F,G,al[ac+13],az,681279174);G=ak(G,k,x,F,al[ac+0],aB,3936430074);F=ak(F,G,k,x,al[ac+3],aC,3572445317);x=ak(x,F,G,k,al[ac+6],aD,76029189);
k=ak(k,x,F,G,al[ac+9],az,3654602809);G=ak(G,k,x,F,al[ac+12],aB,3873151461);F=ak(F,G,k,x,al[ac+15],aC,530742520);x=ak(x,F,G,k,al[ac+2],aD,3299628645);k=au(k,x,F,G,al[ac+0],H,4096336452);G=au(G,k,x,F,al[ac+7],I,1126891415);F=au(F,G,k,x,al[ac+14],aa,2878612391);x=au(x,F,G,k,al[ac+5],ad,4237533241);k=au(k,x,F,G,al[ac+12],H,1700485571);G=au(G,k,x,F,al[ac+3],I,2399980690);F=au(F,G,k,x,al[ac+10],aa,4293915773);x=au(x,F,G,k,al[ac+1],ad,2240044497);k=au(k,x,F,G,al[ac+8],H,1873313359);G=au(G,k,x,F,al[ac+15],I,4264355552);
F=au(F,G,k,x,al[ac+6],aa,2734768916);x=au(x,F,G,k,al[ac+13],ad,1309151649);k=au(k,x,F,G,al[ac+4],H,4149444226);G=au(G,k,x,F,al[ac+11],I,3174756917);F=au(F,G,k,x,al[ac+2],aa,718787259);x=au(x,F,G,k,al[ac+9],ad,3951481745);k=ah(k,aF);x=ah(x,aj);F=ah(F,ar);G=ah(G,aG)}var aE=am(k)+am(x)+am(F)+am(G);return aE.toLowerCase()};h.encodeHTML=function(i){return g("<div/>").text(i).html()};h.decodeHTML=function(i){return g("<div/>").html(i).text()};h.reloadIframe=function(i){if(g(i).length>0){g(i).attr("src",g(i).attr("src"));
return true}return false};h.trimText=function(k,j){var i=k.substr(0,j);if(k.length>j){i=k.replace(new RegExp("^(.{"+j+"}[^\\s]*).*"),"$1")}return i};return h});define("tiljs/timer",["./util","./is"],function(a,c){var b={};b.every=function(d,e){return setInterval(e,d)};b.after=b.delay=function(d,e){return setTimeout(e,d)};b.available=function(d,g,f,e){if(e==0){g(null)}if(window[d]){if(g){g(window[d])}}else{f=f||2000;setTimeout(function(){b.available(d,g,f,--e)},f)}};b.cancel=function(f){try{clearTimeout(f)
}catch(d){}try{clearInterval(f)}catch(d){}};b.elapsedTime=function(o,g,d){if(!c.number(o)){try{o=parseInt(o,10);return b.elapsedTime(o,g,d)}catch(n){return""}}var r={year:"year",day:"day",hour:"hour",minute:"minute",second:"second",ago:"ago"};var m=a.extend(true,{},r,g);var q=[{name:m.year,div:31536000000,mod:10000},{name:m.day,div:86400000,mod:365},{name:m.hour,div:3600000,mod:24},{name:m.minute,div:60000,mod:60},{name:m.second,div:1000,mod:60}];var k=0,h=q.length,j,p=[],f=new Date().getTime()-o;
while(k<h){j=Math.floor(f/q[k].div)%q[k].mod;if(j&&j>=0){p.push(j+" "+q[k].name+(j>1?"s":""))}k+=1}if(p.length===0){p.push("1 "+m.second)}if(d===true){return p[0]+" "+m.ago}else{return p.join(", ")+" "+m.ago}};return b});define("tiljs/ajax",["./timer","./util","jquery","./is","module"],function(h,a,g,e,d){var f={timeout:60000},c=a.extend(true,{},f,d.config()),b={};g.ajaxSetup({timeout:c.timeout});b.getAll=function(l,j,r,o){var p=this,t=[],m=[],n,q;function k(i){m.push(i);if(m.length===l.length){r.apply(p,m)
}}for(n=0;n<l.length;n++){q=j&&j.length>n?j[n]:{};t.push(g.get(l[n],q,k,o))}return t};b.param=g.param;b.ajax=g.ajax;b.get=function(i,k,l,j){if(e.funct(i)){return i(k,l)}else{return g.get(i,k,l,j)}};b.post=function(i,k,l,j){return g.post(i,k,l,j)};b.postCrossDomain=function(j,m){var i="postFrame"+new Date().getTime()+Math.floor((Math.random()*1000)),k=g("<iframe></iframe>").attr("name",i),l=g("<form action='"+j+"' method='post' target='"+i+"'></form>");a.each(m,function(o,n){l.append(g("<input type='hidden' name='"+o+"' />").attr("value",n))
});k.appendTo("body");l.appendTo("body").submit().remove();h.after(10000,function(){k.remove()})};b.getJSONP=function(i,j,k){return b.get(i,j,k,"jsonp")};b.getJSON=function(i,j,k){return b.get(i,j,k,"json")};return b});define("tiljs/user",["./util","./ajax","./cookie","./event","jquery","./is","./logger","./string"],function(f,i,b,a,d,e,j,g){var c={},h=function(k,l){var n={},m=this;if(l&&e.object(l)){k=f.mapObj(l,k)}f.each(k,function(p,o){n[p]=o;var q=g.camelCase(p);m["get"+q]=function(){return n[p]
}});this.getMappedUser=function(){return n};this.getOriginalUser=function(){return k};this.toString=this.toJson=function(){return f.stringify(n,true,"\t")}};c.getNewUser=function(l,k){if(l instanceof h){return l}else{if(e.object(l)){return new h(l,k)}else{return null}}};c.isUser=function(k){return k instanceof h};return c});define("tiljs/login",["./util","./ajax","./cookie","./event","jquery","module","./user","./string","./logger"],function(j,l,b,a,i,c,h,k,m){var g,e,d,f,n;g={autoinit:false,multiuser:false,login:"",logout:"",check_user_status:"",mapping:null,renderer:true};
e=j.extend(true,{},g,c.config());d={};f={};n="SINGLE_USER";d.login=function(q,o,p){if(!q){p(null,"Username is required for login.")}if(!o){p(null,"Password is required for login.")}l.get(e.login,{username:q,password:o},function(t,u){var r=h.getNewUser(t,e.mapping);if(r){d.setUser(r)}else{d.removeUser()}if(u){a.publish("login.error",u)}if(p){p(r,u)}})};d.logout=function(o){l.get(e.logout,{},function(p){d.removeUser();if(o){o(p)}})};d.register=function(){m.info("Register event called.")};d.isLoggedIn=function(o){l.get(e.check_user_status,{},function(q){var p=h.getNewUser(q,e.mapping);
if(p){p.loginType=b.get("LoginType");p.facebook={name:b.get("fbookname"),location:b.get("fbooklocation"),image:b.get("Fbimage"),email:b.get("FaceBookEmail"),oauth:b.get("Fboauthid")};p.twitter={name:b.get("TwitterUserName"),image:b.get("Twimage"),oauth:b.get("Twoauthid")};d.setUser(p)}else{d.removeUser()}if(o){o(p)}})};d.removeUser=function(o){if(e.multiuser){if(o){delete f[o]}else{throw new Error("'userId' is required to remove a user.")}}else{delete f[n]}d.statusChange(null)};d.setUser=d.addUser=function(o){if(typeof o!=="undefined"&&!h.isUser(o)){throw new Error("Object is not an instance of User, use 'user.getNewUser()' to get a User object.")
}if(e.multiuser){f[o.id](o)}else{f[n]=o}d.statusChange(o)};d.getUser=function(o){if(e.multiuser){return j.extend(true,{},f[o])}else{return f[n]}};d.statusChange=function(o){m.info("User Status:"+(o?o.toString():null));a.publish("user.status",o);d.refreshIframes()};d.refreshIframes=function(){i(window.parent.document).find("iframe[data-refreshstate]").each(function(o,p){i(p).attr("src",i(p).attr("src"))})};d.onStatusChange=function(o){a.subscribe("user.status",o)};d.updateConfig=function(o){if(o){e=j.extend(true,{},e,o)
}};d.init=function(o){d.updateConfig(o);if(e.renderer===true){d.onStatusChange(function(p){d.renderPlugins(p)})}d.isLoggedIn(function(){});d.initActions()};d.initActions=function(){i("[data-plugin='user-isloggedin']").on("click","[data-plugin='user-logout']",function(){d.logout()});i("[data-plugin='user-notloggedin']").on("click","[data-plugin='user-login']",function(){d.login(function(){if(window.ga){ga("send","event","Login","Mast Head Success",document.location.href,{nonInteraction:1})}})}).on("click","[data-plugin='user-register']",function(){d.register()
}).on("click","[data-plugin='user-login-facebook']",function(){d.loginWithFacebook()}).on("click","[data-plugin='user-login-twitter']",function(){d.loginWithTwitter()}).on("click","[data-plugin='user-login-google']",function(){d.loginWithGoogle()})};d.renderPlugins=function(o){var q=i("[data-plugin='user-isloggedin']"),p=i("[data-plugin='user-notloggedin']");if(p.length===0){m.warn("Cannot render plugins. data-plugin='user-isloggedin' not found")}if(o){q.show();p.hide();i("[data-plugin='user-info']").each(function(){var r=i(this),t=r.attr("data-info");
try{r.text(o["get"+k.camelCase(t)]());m.info("user-info="+t+":"+o["get"+k.camelCase(t)]())}catch(u){m.error("user-info="+t+":"+u.message)}})}else{q.hide();p.show()}};if(e.autoinit===true){d.init()}return d});define("tiljs/page",["module","./util","jquery"],function(d,a,f){var e={msid:window.msid,channel:"",siteId:"",domain:""};var c=a.extend(true,{},e,d.config());var b={};b.getMsid=function(g){try{if(!g||g.length===0||g==="#"){g=location.href;return/(\d*)\.cms/.exec(g)[1]}else{return c.msid}}catch(h){return c.msid
}};b.getSiteId=function(){return c.siteId};b.getDomain=function(){return c.domain};b.getChannel=function(){return c.channel};b.getMeta=function(g){if(g){return f("meta[property='"+g+"']").attr("content")}else{var h={};f("meta[property]").each(function(l,j){var i=f(j);h[i.attr("property")]=i.attr("content")});return h}};return b});define("tiljs/analytics/mytimes",["module","../ajax","../util"],function(c,e,a){var f={};var d={url:"https://myt.indiatimes.com/mytimes/",appKey:""};var b=a.extend(true,{},d,c.config());
f.log=function(g,i){var h=new Image();h.src=g+"?"+e.param(i)};f.logActivity=function(g){var h=b.url+"addActivity";var i=a.extend(true,{},g);f.log(h,i)};f.logCommentActivity=function(g){var h=a.extend(true,{appKey:b.appKey,parentCommentId:0,activityType:"",baseEntityType:"ARTICLE",objectType:"A",url:document.location.href},g);f.logActivity(h)};f.agreeComment=function(g){var h={parentCommentId:g,activityType:"Agreed"};f.logCommentActivity(h)};f.disagreeComment=function(g){var h={parentCommentId:g,activityType:"Disagreed"};
f.logCommentActivity(h)};f.recommendComment=function(g){var h={parentCommentId:g,activityType:"Reccomended"};f.logCommentActivity(h)};f.logShareCount=function(i,h){var g=b.url+"entityCount";var j={appKey:b.appKey,via:h,entityId:i};f.log(g,j)};f.getShareCount=function(h,j){var g=b.url+"sharedEntity";var i={appKey:b.appKey,msids:h};e.ajax({type:"GET",url:g,jsonpCallback:"getShareCount"+Math.random()*1000000000000000000,dataType:"jsonp",data:i,success:function(l){var k=l&&l.length>0?l[0]:null;if(k&&j){if(j){j(k)
}else{j(null)}}},error:j})};f.getNotifications=function(i){var g=b.url+"notification";var h={appKey:b.appKey,openNetworkId:"sso",size:100,lastSeenId:0,after:true};e.ajax({type:"GET",url:g,jsonpCallback:"getNotifications"+Math.random()*1000000000000000000,dataType:"jsonp",data:h,success:i,error:i})};f.followUser=function(g,h){e.getJSONP(b.url+"followuser",{userId:g,fromMyTimes:true},h)};f.unfollowUser=function(g,h){e.getJSONP(b.url+"unfollowuser",{userId:g,fromMyTimes:true},h)};f.getFollowers=function(g){e.getJSONP(b.url+"activity/myfriends",{openNetworkId:"sso",size:-1,lastSeenId:0,after:true,type:"follower"},g)
};f.getFollowee=function(g){e.getJSONP(b.url+"activity/myfriends",{openNetworkId:"sso",size:-1,lastSeenId:0,after:true,type:"followee"},g)};f.followUser=function(g,h){e.getJSONP(b.url+"followuser",{userId:g,fromMyTimes:true,medium:"WEB"},h)};f.updateUserCity=function(g,h){e.getJSONP(b.url+"/profile/update?city="+g,{openNetworkId:"sso",size:-1,lastSeenId:0,after:true},h)};return f});define("tiljs/apps/times/api",["module","../../util","../../ajax","../../cookie","../../event","../../string","../../page","../../analytics/mytimes"],function(c,h,k,b,a,i,j,f){var e={};
var g={ticket:{url:"https://jsso.indiatimes.com/sso/crossdomain/getTicket"},usersInfo:{url:"https://myt.indiatimes.com/mytimes/profile/info/v1/",params:{ssoid:""}},badges:{url:"https://rewards.indiatimes.com/bp/api/urs/mubhtry",params:{format:"json",pcode:j.getChannel(),uid:""}},rewards:{url:"https://rewards.indiatimes.com/bp/api/urs/ups",params:{format:"json",pcode:j.getChannel(),uid:""}},comments:{url:document.location.host=="test.indiatimes.com"||document.location.host=="test.happytrips.com"?"lib/getComments.php":"/json/new_cmtofart2_nit_v1.cms",type:"json",params:{msid:"",curpg:1,pcode:j.getChannel()}}};
g.comments_newest=g.comments;g.comments_oldest={url:g.comments.url,type:g.comments.type,params:{msid:"",curpg:1,ordertype:"asc",pcode:j.getChannel()}};g.comments_recommended={url:g.comments.url,type:g.comments.type,params:{msid:"",curpg:1,commenttype:"mostrecommended",pcode:j.getChannel()}};g.comments_discussed={url:g.comments.url,type:g.comments.type,params:{msid:"",curpg:1,commenttype:"mostdiscussed",pcode:j.getChannel()}};g.comments_agree={url:g.comments.url,type:g.comments.type,params:{msid:"",curpg:1,commenttype:"agree",pcode:j.getChannel()}};
g.comments_disagree={url:g.comments.url,type:g.comments.type,params:{msid:"",curpg:1,commenttype:"disagree",pcode:j.getChannel()}};g.validate_comment={url:"/validatecomment.cms",type:"html",params:{fromname:null,fromaddress:null,userid:null,location:null,imageurl:null,loggedstatus:null,message:null,roaltdetails:null,ArticleID:null,msid:null,parentid:null,rootid:null}};g.post_comment={url:"/postro.cms",type:"html",params:{fromname:null,fromaddress:null,userid:null,location:null,imageurl:null,loggedstatus:null,message:null,roaltdetails:null,ArticleID:null,msid:null,parentid:null,rootid:null}};
g.post_comment_withoutverification={url:"/postro_nover.cms",type:"html",params:{fromname:null,fromaddress:null,userid:null,location:null,imageurl:null,loggedstatus:null,message:null,roaltdetails:null,ArticleID:null,msid:null,parentid:null,rootid:null}};g.post_comment_withverification={url:"/postroemailverification.cms",type:"html",params:{fromname:null,fromaddress:null,userid:null,location:null,imageurl:null,loggedstatus:null,message:null,roaltdetails:null,ArticleID:null,msid:null,parentid:null,rootid:null}};
g.rate={url:"/rate_techreview.cms",type:"html",params:{msid:null,getuserrating:null,vote:null,criticrating:null}};g.rate_comment={url:"/ratecomment_new.cms",type:"html",params:{opinionid:null,typeid:null,rateid:null}};g.rate_comment_offensive={url:"/offensive/mark",type:"html",params:{ofusername:null,ofreason:"NONE",ofcommenteroid:null,ofcommenthostid:83,ofcommentchannelid:-2128958273,ofcommentid:null,ofuserisloggedin:null,ofuserssoid:null,ofuseremail:null}};var d=h.extend(true,{},g,c.config());e.updateConfig=function(l){d=h.extend(true,d,l)
};e.getConfig=function(l){return d};e.getTicket=function(l,m){return e.api("ticket",l,m)};e.getUsersInfo=function(l,m){return e.api("usersInfo",{ssoid:l.ssoids},m)};e.getBadges=function(l,m){return e.api("badges",l,m)};e.getRewards=function(l,m){return e.api("rewards",l,m)};e.getComments=e.getComments_newest=function(l,m){return e.api("comments",l,m)};e.getComments_oldest=function(l,m){return e.api("comments_oldest",l,m)};e.getComments_recommended=function(l,m){return e.api("comments_recommended",l,m)
};e.getComments_discussed=function(l,m){return e.api("comments_discussed",l,m)};e.getComments_agree=function(l,m){return e.api("comments_agree",l,m)};e.getComments_disagree=function(l,m){return e.api("comments_disagree",l,m)};e.validateComment=function(l,m){return e.post("validate_comment",l,m)};e.postComment=function(l,m){return e.post("post_comment",l,m)};e.postCommentWithoutVerification=function(l,m){return e.post("post_comment_withoutverification",l,m)};e.postCommentWithVerification=function(l,m){return e.post("post_comment_withverification",l,m)
};e.rate=function(n,o,m){var l={msid:n.msid,getuserrating:n.user_rating,vote:n.rating,criticrating:n.critic_rating};return e.api("rate",l,o)};e.rateComment=function(m,n,l){if(l){switch(m.typeid){case 100:f.agreeComment(m.opinionid);break;case 101:f.disagreeComment(m.opinionid);break;case 102:f.recommendComment(m.opinionid);break;case 103:e.rateCommentOffensive(m,l);break}}return e.api("rate_comment",m,n)};e.rateCommentOffensive=function(m,l,o){if(l){var n={};n.ofcommenteroid=m.opinionid;n.ofcommentid=window.msid;
n.ofuserisloggedin=1;n.ofuserssoid=n.ofuseremail=l.getEmail();n.ofusername=l.getFullName();return e.api("rate_comment_offensive",n,o)}else{a.publish("logger.error","Cannot rate comment offensive, user not available.")}};e.api=function(m,l,o){var n=d[m];return k.get(h.val(n.url,n.params),h.extend(true,{},n.params,l),function(p){if(o){try{o(p)}catch(q){a.publish("logger.error",q.stack)}}},n.type||"jsonp").error(function(){if(o){try{o()}catch(p){a.publish("logger.error",p.stack)}}})};e.post=function(m,l,o){var n=d[m];
return k.post(h.val(n.url,n.params),h.extend(true,{},n.params,l),function(p){if(o){try{o(p)}catch(q){a.publish("logger.error",q.stack)}}}).error(function(p,r,q){p.publish("comment.post.error",q)})};e.get=function(m,o){if(o){var n=d[m];var l=h.extend(true,{},n.params,o);return{url:h.val(n.url,l),params:l}}else{return d[m]}};e.init=function(){h.each(d,function(l,m){var n=i.camelCase("get "+l);e[n]=function(o,p){k.getJSONP(h.val(m.url,m.params),h.extend(true,{},m.params,o),function(q){if(p){p(q)}})}
})};return e});define("tiljs/ui",["./util","./logger","./event","jquery","./is","./timer"],function(h,i,b,f,g,c){i.log("ui loaded");var a={},d={},j,e;a.window=function(k,t){i.log("ui.window called");var o,m,r,q,n,l;o={width:300,height:300,name:"Window",mask:true,resizable:false,disableScroll:false,closeCallback:function(){i.log("Empty ui.window callback function.")}};m=h.extend(true,{},o,t);r=window.screen.width/2-m.width/2;q=window.screen.height/2-m.height/2;n=["width="+m.width,"height="+m.height,"left="+(g.defined(m.left)?m.left:r),"top="+(g.defined(m.top)?m.top:(q-20)),"scrollbars="+(g.defined(m.scrollbars)&&(m.scrollbars==1)?m.scrollbars:0),"resizable="+m.resizable];
if(m.mask===true&&g.desktop()){a.mask(null,{},false)}if(m.disableScroll===true){a.disableScroll()}l=window.open(k,m.name,n.join(","));if(l){l.focus();i.log("Popup opened: "+k);i.log(l)}try{l.reposition=function(){var u=window.screen.width/2-m.width/2,v=(window.screen.height/2-m.height/2);l.moveTo(u,v)}}catch(p){i.warn("Handled Exception in IE10.");i.error(p)}if(!l){alert("Popups are blocked. Please enable them.");i.error("Popups are blocked. Please enable them.");a.unmask();return l}(function(u,w,x){var v=window.setInterval(function(){try{i.log("Checking if popup is closed:"+w+":"+u.closed);
if(u===null||u.closed!==false){a.window.close(x.name)}}catch(y){i.warn("Handled exception while closing popup.");i.error(y.stack);window.clearInterval(v);v=null}},500);d[x.name]={opt:x,popup:u,interval:v,url:w}}(l,k,m));return l};a.window.close=function(l,m){if(!l){i.error("Window name is required to close it.");return}var k=d[l];if(m===true){h.each(d,function(n){a.window.close(n)})}else{if(k){i.log("Closing popup is closed:"+k.opt.name+":"+k.url);if(k.opt.mask===true){a.unmask()}if(k.opt.disableScroll===true){a.enableScroll()
}window.clearInterval(k.interval);k.interval=null;k.popup.close();d[k.opt.name]=null;k.opt.closeCallback(k.popup)}else{i.warn("Popup '"+l+"' not found.")}}};if(window.closeWindow){i.warn("window.closeWindow is already defined, open windows may not close properly.")}else{window.closeWindow=a.window.close}a.iframe=function(m,l){var q={width:300,height:300,name:"Window",disablePopup:true,closeCallback:function(){i.log("Empty ui.iframe callback function.")}},n=h.extend(true,{},q,l),o=f("<iframe class='loginsignupframe'></iframe>"),p,k;
o.attr("src",m);o.css({width:"100%",height:"100%",border:"4px solid #cccccc",backgroundColor:"#FFF"});p=o[0];k=a.popup(o,n);p.close=function(){o.remove();k.remove();a.unmask()};p.resizeTo=function(t,r){if(t&&r){k.width(t);k.height(r)}};p.reposition=k.reposition;return p};a.closeButton=function(l){var k=f("<span></span>");k.on("click",l);return k};a.popup=function(p,n){var q,m,l,o,k;q={width:300,height:300,name:"Window",closeCallback:function(){i.log("Empty ui.popup callback function.")},disableScroll:false};
o=h.extend(true,{},q,n);k=f("<div></div>");k.width(o.width);k.height(o.height);k.css({position:"absolute",zIndex:e.zIndex+1});k.append(p);if(o.disableScroll===true){a.disableScroll()}if(o.closeCallback){if(window.closePopup){i.warn("'window.closePopup' is already defined.")}if(window.disablePopup){i.warn("'window.disablePopup' is already defined.")}window.closePopup=window.disablePopup=function(){k.remove();a.unmask();if(o.disableScroll===true){a.enableScroll()}if(o.closeCallback){o.closeCallback()
}window.closePopup=null;window.disablePopup=null};m=a.closeButton(window.closePopup);m.addClass("popup_close_button");m.css({position:"absolute",top:"5px",right:"5px",cursor:"pointer",background:"url('/photo/25494620.cms') no-repeat scroll -160px -20px rgba(0, 0, 0, 0)",width:"18px",height:"18px"});k.append(m)}f("body").append(k);l=a.mask(k,{},false);k.reposition=function(){var u=f(window),r=u.width(),w=u.height(),t=((r/2)-(k.width()/2)),v=((w/2)-(k.height()/2));if(t<0){t=0}if(v<0){v=0}k.css({left:t,top:v+f(window).scrollTop()})
};k.reposition();k.close=function(){k.remove();a.unmask()};b.subscribe("window.resize",function(){k.reposition()});return k};a.img=function(m,k){var l=f("<img>");l.attr("src",m);h.each(k,function(o,n){l.attr(o,n)});return l};a.anchor=function(m,n,k){var l=f("<a>");l.attr("href",m);l.text(n);h.each(k,function(p,o){l.attr(p,o)});return l};a.inView=function(o,t,u){u=u||0;var q=f(window),n=f(o),l,m,r,p,k;if(n.is(":hidden")){return false}l=q.scrollTop()-u;m=l+q.height()+u;r=n.offset()?n.offset().top:0;
p=r+n.height();k=false;if(t===true){k=((p>l)&&(r<=m))}else{k=((p<=m)&&(r>=l))}return k};a.init=function(){var l=h.throttle(500,function(n){b.publish("window.scroll",n)}),k=function(n){b.publish("window.load",n)},m=h.throttle(500,function(n){b.publish("window.resize",n)});if(window.addEventListener){window.addEventListener("scroll",l,false);window.addEventListener("load",k,false);window.addEventListener("resize",m,false)}else{if(window.attachEvent){window.attachEvent("onscroll",l);window.attachEvent("onload",k);
window.attachEvent("onresize",m)}}f(function(n){b.publish("document.ready",n)})};a.getGravatar=function(k,l){if(!k||k.length===0){return null}l=l||80;return"http://www.gravatar.com/avatar/"+h.md5(k.trim().toLowerCase())+".jpg?s="+l};a.maxlength=function(l,k,o,n,m){f(n||"body").off("keyup change",l);f(n||"body").on("keyup change",l,function(){var q=f(this).val(),p=q.length;k=parseInt(k,10);o.call(this,k-p,p);if(p>k){f(this).val(q.substr(0,k));if(m){window.alert(m)}return false}})};a.getActionReferences=function(l,k){var m={current:f(l)};
m.parent=k?m.current.parents(k):m.current;m.parent.find("[data-plugin]").each(function(o,n){m[f(n).attr("data-plugin")]=f(this)});return m};j=null;e={position:"fixed",left:0,top:0,width:"100%",height:"100%",backgroundColor:"#000",opacity:0.5,zIndex:99999};a.mask=function(l,k,m){if(!j){j=f("<div></div>");j.popup=l;j.css(h.extend(e,k));if(j.popup){j.popup.show()}if(typeof m==="undefined"||m===true){j.on("click",function(){if(j.popup){j.popup.hide()}a.unmask()})}f(document).one("keyup",function(n){if(n.keyCode===27){if(j){if(j.popup){j.popup.hide()
}a.unmask()}}});f("body").append(j)}else{i.warn("Already masked. Use ui.unmask() before masking again.")}return j};a.isMasked=function(){return j?true:false};a.unmask=function(){if(j){if(j.popup){j.popup.hide()}j.remove();j=null}else{i.warn("No mask available. Use ui.mask() before unmasking.")}};a.tooltip=function(l,k){k=k||5;var m=f("<div></div>");if(k>0){c.after(function(){m.fadeOut(function(){})})}return m};a.dialog=function(l){var k=f("<div></div>");k.css({backgroundColor:"#FFF"});k.html(l.html());
return k};a.customScrollbar=function(k){if(window.$&&window.$&&window.$.fn&&window.$.fn.mCustomScrollbar){k=window.$(k);k.mCustomScrollbar("destroy");k.mCustomScrollbar({scrollButtons:{enable:true},advanced:{updateOnContentResize:true,updateOnBrowserResize:true}})}else{i.warn("mCustomScrollbar not found.")}};a.disableScroll=function(k){f("html,body").css({overflow:"hidden",height:"100%",padding:"0",margin:"0"});f(k||"#container").css({overflowY:"scroll",height:"100%"})};a.enableScroll=function(k){f("html,body").css({overflow:"",height:"",padding:"",margin:""});
f(k||"#container").css({overflowY:"",height:""})};a.init();return a});define("tiljs/load",["./event","./logger","./util","./is"],function(e,c,a,d){c.log("load loaded");var b={};b.js=function(h,l,k,j){var i=document.getElementsByTagName("head")?document.getElementsByTagName("head")[0]:null;if(i){var g=document.createElement("script");var f=false;if(k){g.id=k}if(j){g.async=j}if(!h){throw new Error("Param 'url' not defined.")}g.src=h;g.onload=g.onreadystatechange=function(){if(!g.loaded&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){g.loaded=true;
var m=new Date().getTime();var n=m-g.startTime;e.publish("load.js",["_trackTiming","js",h,n,h]);if(l){try{l()}catch(o){e.publish("logger.error",o.stack)}}g.onload=g.onreadystatechange=null}};g.startTime=new Date().getTime();i.appendChild(g);return g}else{c.info("Head Element not found. JS '"+h+"' not loaded. ");return null}};b.css=function(g,i){var h=document.getElementsByTagName("head")?document.getElementsByTagName("head")[0]:null;if(h){var f=document.createElement("link");f.setAttribute("rel","stylesheet");
f.setAttribute("type","text/css");f.setAttribute("href",g);h.appendChild(f);if(i){setTimeout(i,0)}}else{c.info("Head Element not found. CSS '"+g+"' not loaded. ")}return f};b.iframe=function(l,k,f,h){var g=document.getElementById(h)||document.body;if(g){var j=document.createElement("iframe");j.src=l;j.scrolling="no";j.frameBorder="0";j.width=k||0;j.height=f||0;g.appendChild(j);return j}else{c.info("Container with id '"+h+"' not found. iframe '"+l+"' not loaded. ")}};b.image=function(g){if(d.array(g)){a.each(ajaxLogout,function(j,h){b.image(h)
})}else{var f=new Image();f.src=g}};b._content=function(g,f){};b.isLoaded=function(f){return $('script[src="'+f+'"]').length>0||$('link[href="'+f+'"]').length>0};return b});define("tiljs/localstorage",["module","./util","json","./is","./logger"],function(a,e,g,d,h){var f={};var c={};var b=e.extend(true,{},c,a.config());var i=window.localStorage;if(!i){h.warn("'localStorage' is not available.");i={getItem:function(){},removeItem:function(){},setItem:function(){}}}f.get=function(k){var l=i.getItem(k);
if(l!=null){var j=g.parse(l);if(!j){return null}return(new Date().getTime()<j.timestamp)?j.value:null}else{return null}};f.getAll=function(){return f.get()};f.remove=function(j,l,k){if(j){i.removeItem(j)}};f.set=function(k,q,r,t,m,j){var l=new Date();var p=l.getTime()+((r||365)*24*60*60*1000);var n={value:q,timestamp:new Date().getTime()+p,path:t,domain:m};try{i.setItem(k,g.stringify(n))}catch(o){h.error("Unable to save item in localStorage:"+k)}};return f});define("tiljs/apps/times/login",["../../login","../../util","module","../../page","../../ajax","../times/api","../../is","../../cookie","../../ui","../../logger","../../event","../../load","../../localstorage"],function(r,a,d,j,q,t,k,A,v,E,x,m,l){window.newLogin=true;
var p={autoinit:false,multiuser:false,login:"",logout:"",check_user_status:"",mapping:null,renderer:false};var D=a.extend(true,{},p,d.config());try{document.domain=j.getDomain()}catch(z){E.info("Domain cannot be set:"+j.getDomain())}var w;if(navigator.userAgent.match("CriOS")){localStorage.removeItem("_ssodata");w=w||setInterval(function(){f()},1000)}var f=function(){if(localStorage.getItem("_ssodata")!=null){__sso(JSON.parse(localStorage.getItem("_ssodata")));localStorage.removeItem("_ssodata")}};
var n=function(e,F){y=v.window(e,{width:850,height:780,scrollbars:0},function(G){if(G&&G.code==="200"){b.isLoggedIn()}else{if(F){F(null,G)}}});y.moveTo(315,250)};var b=r;var h=null;var g=null;var c=function(e){o({error:{code:e,message:D.messages[e]}})};var o=function(e){g=e};var B=function(){return;if(y){y.close();y=null}g=null};window.getLoginCallback=function(){return h};window.getLoginData=function(){return g};window.getDomain=function(){return j.getDomain()};var i=function(e){if(k.iframe(y)){y.src=e
}else{y.document.location.href=e}};var C=function(F,e,G){i(F);if(e){c(e)}else{if(G){o(G)}}};var y=null;window.__sso=function(G,F){E.log("__sso called");E.log(G);E.log(y);if(G&&y){E.log(F);var e=g?g.data:null;G.site=G.site||"email";if(G.closeWindow){E.log("Close pressed, closing window / popup");y.close()}else{if(G.status=="logout"){E.log("Closing window / popup");y.close()}else{if(G.status=="signinsuccess"||G.status=="ssosigninsuccess"){E.log("Closing window / popup");y.close()}else{if((G.site=="facebook"||G.site=="googleplus")&&G.status=="MappingUpdated"){E.log("Closing window / popup");
y.close()}else{if(G.status=="ssosigninfailure"&&G.ssoerror=="E119"){C(D.base_url+"/loginview.cms?x=error&site="+G.site,"email_failure")}else{if(G.status=="ssosigninfailure"&&G.ssoerror=="E104"){C(D.base_url+"/loginview.cms?x=error&site="+G.site,"email_failure")}else{if(G.err=="E104"&&G.facebooktoken){C(D.base_url+"/loginview.cms?x=error&site="+G.site,"facebook_failure_no_email")}else{if(G.status=="signinfailure"&&G.error=="F101"){C(D.base_url+"/loginview.cms?x=error&site="+G.site,G.site+"_failure")
}else{if(G.status=="signinfailure"&&G.error=="twitter"&&G.site=="twitter"){C(D.base_url+"/loginview.cms?x=error&site=twitter","twitter_failure_unknown")}else{if(G.status=="signinfailure"&&G.error=="user_denied"&&G.site=="facebook"){C(D.base_url+"/loginview.cms?x=error&site="+G.site,"facebook_failure_user_denied")}else{if(G.error=="E104"&&G.site=="twitter"){C(D.base_url+"/socialconnect.cms?site=twitter",null,{data:G,twitter_connect:true})}else{if(G.error=="E119"&&G.site=="twitter"){C(D.base_url+"/socialconnect.cms?site=twitter","twitter_link_username_failure");
g.data=e}else{if(G.status=="signinfailure"&&G.error=="T102"&&G.site=="twitter"){C(D.base_url+"/socialconnect.cms?site="+G.site,"twitter_failure_server_error")}else{if(G.error=="E103"&&G.site=="twitter"){C(D.base_url+"/socialconnect.cms?site="+G.site,"twitter_failure_already_exist",g?g.data:null);g.data=e}else{if(G.error=="SSO_INVALID_RES_CHK_MAIL_AV"&&G.site=="twitter"){C(D.base_url+"/socialconnect.cms?site="+G.site,"twitter_failure_invalid_email");g.data=e}else{E.warn("Login case not handled");C(D.base_url+"/loginview.cms?x=error&site="+G.site,"unknown_error")
}}}}}}}}}}}}}}}}E.log("Checking user status in __sso");b.isLoggedIn(h)};b.closeWindow=window.closeLoginWindow=function(){if(y){y.close()}};b.setLoginWindowDimension=window.setLoginWindowDimension=function(F,e){if(y){y.resizeTo(F,e);if(y.reposition){y.reposition()}y.focus()}};b.login=function(I,G,F){var e,H="http:";h=function(J){x.publish("user.login",J);if(window.ga){ga("send","event","Login","Mast Head",document.location.href,{nonInteraction:1})}if(I){I(J)}};B();if(window.toiprops&&toiprops.useSSL){H="https:"
}e="https://jsso.indiatimes.com/sso/identity/login?ru="+H+"//timesofindia.indiatimes.com/sso.cms?ru="+encodeURIComponent(document.location.href)+"&channel="+j.getChannel().toLowerCase()+(G?"&action="+G:"")+(F?"&identifier="+F:"");n(e,I)};b.loginWithTwitter=function(F){h=function(G){x.publish("user.login",G);if(F){F(G)}};B();var e="https://jsso.indiatimes.com/sso/identity/login/socialLogin?channel="+j.getChannel().toLowerCase()+"&oauthsiteid=twitter";n(e,F)};b.loginWithFacebook=function(F){h=function(G){x.publish("user.login",G);
if(F){F(G)}};B();var e="https://jsso.indiatimes.com/sso/identity/login/socialLogin?channel="+j.getChannel().toLowerCase()+"&oauthsiteid=facebook";n(e,F)};b.loginWithGoogle=function(F){h=function(G){x.publish("user.login",G);if(F){F(G)}};B();var e="https://jsso.indiatimes.com/sso/identity/login/socialLogin?channel="+j.getChannel().toLowerCase()+"&oauthsiteid=googleplus";n(e,F)};b.logout=function(H){h=function(){x.publish("user.logout");if(H){H()}};B();var e="https://jsso.indiatimes.com/sso/identity/profile/logout/external?channel="+j.getChannel().toLowerCase();
var G=m.iframe(e);$(G).load(function(){$(G).remove();b.removeUser();if(window.__sso){window.__sso()}});l.remove("sso_user");var F=j.getDomain();A.remove("ssoid","/",F);A.remove("Fbsecuritykey","/",F);A.remove("fbookname","/",F);A.remove("CommLogP","/",F);A.remove("CommLogU","/",F);A.remove("FaceBookEmail","/",F);A.remove("Fbimage","/",F);A.remove("fbooklocation","/",F);A.remove("Fboauthid","/",F);A.remove("fbname","/",F);A.remove("fbLocation","/",F);A.remove("fbimage","/",F);A.remove("fbOAuthId","/",F);
A.remove("MSCSAuth","/",F);A.remove("MSCSAuthDetail","/",F);A.remove("MSCSAuthDetails","/",F);A.remove("Twimage","/",F);A.remove("TwitterUserName","/",F);A.remove("Fboauthid","/",F);A.remove("Twoauthid","/",F);A.remove("Twsecuritykey","/",F);A.remove("ssosigninsuccess","/",F);A.remove("ssoid");A.remove("MSCSAuthDetail");A.remove("articleid");A.remove("txtmsg");A.remove("tflocation");A.remove("tfemail");A.remove("setfocus");A.remove("fbookname");A.remove("CommLogP");A.remove("CommLogU");A.remove("FaceBookEmail");
A.remove("Fbimage");A.remove("fbooklocation");A.remove("Fboauthid");A.remove("Fbsecuritykey");A.remove("fbname");A.remove("fbLocation");A.remove("fbimage");A.remove("fbOAuthId");A.remove("MSCSAuth");A.remove("MSCSAuthDetail");A.remove("MSCSAuthDetails");A.remove("ssosigninsuccess");A.remove("Twimage");A.remove("TwitterUserName");A.remove("Twoauthid");A.remove("Twsecuritykey")};var u={check_user_status:function(G,I){var H=A.get("ssoid")||A.get("ssoId");var e=A.get("MSCSAuthDetails");if(!H&&e){H=e.split("=")[1]
}if(H&&H.length>0){var F=r.getUser();if(F){if(I){I(F)}}else{if(e){t.getUsersInfo({ssoids:H},function(J){if(I){I(J[0]||J)}})}else{q.getJSONP("https://jsso.indiatimes.com/sso/crossdomain/getTicket?version=v1",function(K){if(K.ticketId!=null&&K.ticketId!=undefined&&K.ticketId.length>0){var J="https://socialappsintegrator.indiatimes.com/socialsite/v1validateTicket?ticketId="+K.ticketId+"&channel="+j.getChannel().toLowerCase();q.getJSONP(J,function(L){if(location.hostname.indexOf(".indiatimes.com")>-1){t.getUsersInfo({ssoids:H},function(N){if(I){I(N[0]||N)
}})}else{var M="http://"+location.hostname+"/v1validateTicket?ticketId="+K.ticketId+"&channel="+j.getChannel().toLowerCase();q.getJSONP(M,function(N){t.getUsersInfo({ssoids:H},function(O){if(I){I(O[0]||O)}})})}})}else{if(I){I(null)}}})}}}else{if(I){I(null)}}},check_user_status1:function(F,G){var e=r.getUser();if(e){if(G){G(e)}}else{q.getJSONP("https://jsso.indiatimes.com/sso/crossdomain/getTicket?version=v1",F,function(H){var I=null;if(H&&H.ticketId){q.getJSONP("lib/validateTicket.php",{ticketId:H.ticketId,siteId:j.getSiteId(),type:"JSON"},function(J){var K=J.emailId;
if(k.string(K)){K=K.split(",")}t.getUsersInfo({ssoids:K.join(",")},function(L){t.getBadges({uid:K.join(",")},function(M){t.getRewards({uid:K.join(",")},function(N){L[0].badges=M.output&&M.output.userbadgehistory?M.output.userbadgehistory[0].userbadges.activityBadge:[];L[0].rewards=N&&N.output&&N.output.user?N.output.user:null;if(G){G(L[0])}})})})})}else{if(G){G(I)}}})}},mapping:{uid:"uid",email:"EMAIL",id:"_id",name:"FL_N",username:"D_N_U",fullName:"FL_N",firstName:"F_N",lastName:"L_N",icon:"tiny",link:"profile",CITY:"CITY",thumb:"thumb",followersCount:"F_C",FE_C:"FE_C",I_U_A:"I_U_A",I_I_L:"I_I_L",badges:"badges",rewards:"rewards",whatsonid:"W_ID",ps:"SUB_U_J"}};
b.renderPlugins=function(e){e=e||b.getUser();$(function(){if(e){$("[data-plugin='user-isloggedin']").show();$("[data-plugin='user-notloggedin']").hide();$("[data-plugin='user-name']").text(e.getFirstName());$("[data-plugin='user-icon']").attr("src",e.getIcon());$("[data-plugin='user-thumb']").attr("src",e.getThumb());t.getRewards({uid:e.getUid()},function(F){if(F&&F.output&&F.output.user&&F.output.user.levelName){$("[data-plugin='user-points']").text((F.output.user.statusPoints));$("[data-plugin='user-level']").text((F.output.user.levelName));
$("[data-plugin='user-points-wrapper']").show().addClass("points_"+F.output.user.levelName.toLowerCase())}else{$("[data-plugin='user-points-wrapper']").hide()}})}else{$("[data-plugin='user-icon']").attr("src",D.default_user_icon);$("[data-plugin='user-thumb']").attr("src",D.default_user_icon);$("[data-plugin='user-isloggedin']").hide();$("[data-plugin='user-notloggedin']").show()}$("body").toggleClass("loggedin",!!e);$("body").toggleClass("notloggedin",!e)})};b.updateConfig(u);return b});define("login",["tiljs/apps/times/login"],function(a){return a
});define("api",["tiljs/apps/times/api"],function(b){var a=b;return a});define("tiljs/plugin/plugin",["../load","../util","../event","../ui","../logger","../is"],function(g,e,b,f,i,d){var c={init:true,root:"body",dependency:function(j){this.dep_data={};if(j){j()}}};var h=function(k,j){if(!k){throw new Error("'id' param is required.")}this.id=k;this.updateConfig(j)};h.prototype.updateConfig=function(j){this.config=e.extend(true,{},c,j)};h.prototype.find=function(){return $(this.config.root).find("[data-plugin='"+this.id+"']")
};h.prototype.init=function(){b.publish(a("beforeinit"));if(d.funct(this.config.dependency)){var j=this;this.config.dependency(function(){j.render()})}else{this.render()}};h.prototype.render=function(){b.publish(a("beforerender"));var j=this;this.find().each(function(k,l){j.renderEach(l)});b.publish(a("afterrender"))};h.prototype.renderEach=function(j){};var a=function(j){return"plugin."+this.id+j};return h});define("tiljs/plugin/dynamic",["../timer","../util","../plugin/plugin"],function(d,a,c){var b=new c("dynamic-uptime");
b.uptime=function(){var e=$("[data-plugin='dynamic-uptime']");e.each(function(f,g){b.renderEach(g)})};b.renderEach=function(g){var f=$(g);var h=f.attr("data-time");var e=d.elapsedTime(h,{minute:"min",second:"sec"},true);f.html(e)};d.every(60000,function(){b.render()});b.init();return b});define("rodate",[],function(){var a={};a.uptime=function(){var b=$("[rodate]");b.each(function(c,d){a.renderEach(d)})};a.renderEach=function(e){var d=$(e);var g=d.attr("rodate");var c=g.match(/^(\d+)-(\d+)-(\d+) (\d+)\:(\d+)\:(\d+)$/);
if(!c){g=!isNaN(g)?parseInt(g):g;var f=new Date(g);if(!isNaN(f.getTime())){rod=f}else{if(g.indexOf("hrs IST")!=-1){g=g.replace(" hrs IST","");g=g.splice(-2,0,":")}g=g.replace("IST","");g=g.replace("hrs","");g=g.replace("AM"," AM");g=g.replace("PM"," PM");rod=new Date(g);if(isNaN(rod.getTime())){if(g.indexOf(":")>-1){g=g.split(" ").join("T");g=g.concat("+05:30");rod=new Date(g)}}}c=["",rod.getYear()+1900,rod.getMonth()+1,rod.getDate(),rod.getHours(),rod.getMinutes(),rod.getSeconds()]}var b=a.elapsedTime(new Date(c[1],c[2]-1,c[3],c[4],c[5],c[6]).getTime(),{minute:"min",second:"sec"},true);
d.html(b)};a.elapsedTime=function(j,d,b){if(typeof j!=="number"){return""}var n={year:"year",day:"day",hour:"hour",minute:"minute",second:"second",ago:"ago"};var h=$.extend({},n,d);var m=[{name:h.year,div:31536000000,mod:10000},{name:h.day,div:86400000,mod:365},{name:h.hour,div:3600000,mod:24},{name:h.minute,div:60000,mod:60},{name:h.second,div:1000,mod:60}];var g=0,e=m.length,f,k=[],c=new Date().getTime()-j;while(g<e){f=Math.floor(c/m[g].div)%m[g].mod;if(f&&f>=0){k.push(f+" "+m[g].name+(f>1?"s":""))
}g+=1}if(k.length===0){k.push("1 "+h.second)}if(b===true){return k[0]+" "+h.ago}else{return k.join(", ")+" "+h.ago}};return a});define("tiljs/plugin/lazy",["../event","../ui","module","../util"],function(e,g,d,b){var a={};var f={skew:1000,error_image:null};var c=b.extend(true,{},f,d.config());a.init=function(){var h=this;h.load();e.subscribe("window.scroll",function(){h.load()})};a.load=function(){var i=this;var h=$("[data-src]");h.each(function(j,k){if(g.inView(k,true,c.skew)){i.loadEach(k)}})};
a.loadEach=function(i){var h=$(i);if(c.error_image){h.error(function(){$(this).attr("src",c.error_image)})}h.attr("src",h.attr("data-src"));h.removeAttr("data-src")};a.init();return a});define("jsrender",["jquery"],function(a){if(!a.fn.render){throw new Error("Missing js: http://timesofindia.indiatimes.com/jsrender.cms")}return a.fn.render});define("localstoragec",["tiljs/cookie"],function(a){var b={};b.isEnabled=function(){return typeof(Storage)!=="undefined"};b.checkExpiry=function(c){var d=localStorage.getItem(c);
if(d&&!(d.hasOwnProperty("timestamp")&&d.hasOwnProperty("expires"))){return c}if(d&&(Number(new Date().getTime())-Number(d.timestamp)>Number(d.expires)*60*60*24*1000)){localStorage.removeItem(c);return}return c};b.set=function(f,h,c,k,g,j){try{var d={value:h,timestamp:new Date().getTime(),expires:c};localStorage.setItem(f,JSON.stringify(d))}catch(i){a.set(f,h,c,k,g,j)}};b.get=function(d){var e="";try{e=JSON.parse(localStorage.getItem(d))}catch(c){e=localStorage.getItem(d)}return(e&&e.value)?e.value:e
};b.csget=function(c){return(b.isEnabled()&&b.get(c))?b.get(c):a.get(c)};b.remove=function(c){return localStorage.removeItem(c)};return b});define("tiljs/comments",["./util","./ui","jquery","module","./is","./plugin/lazy","./event"],function(h,j,f,b,g,c,a){var e={gravatar:false,wrapper:"#comment-section",main:"#comments",comment:"[data-plugin='comment']",tmpl:"comment_tmpl",count:"[data-plugin='comments-count']",post_button:"[data-plugin='comment-post']",comment_input:"[data-plugin='comment-input']",form:"[data-plugin='comment-form']",loadonscroll:true};
var d=function(k){this.config=h.extend(true,{},k)};d.config=h.extend(true,{},e,b.config());var i=[{text:"Hello World",name:"Del Sanic",image:"http://www.gravatar.com/avatar/?d=identicon",uid:"123456",badge:[{name:"Silver"},{name:"Gold"}]},{text:"Test Comment",name:"John",image:"http://www.gravatar.com/avatar/?d=identicon",uid:"123457",badge:[{name:"Silver"},{name:"Gold"}]}];d.getConfig=function(){return this.config};d.prototype.getConfig=function(){return this.config};d.prototype.initialize=function(){var k=this;
this.comments=[];this.getData(function(m,l){k.renderCommentCount(l||(m?m.length:0));if(m&&m.length>0){k.renderNoComment(false);k.render(m)}else{k.renderNoComment(true)}});if(k.config.loadonscroll===true){(function(l){a.subscribe("window.scroll",function(){l.loadNextPg()})})(k)}};d.prototype.getData=function(k){k(i)};d.prototype.renderCommentCount=function(l,k){f("[data-plugin='comment-count']").text(l)};d.prototype.renderNoComment=function(k){if(k){f("[data-plugin='comment-none']").show()}else{f("[data-plugin='comment-none']").hide()
}};d.prototype.render=function(n,o,k){var m=this;if(n){var l=f(m.config.wrapper+" "+m.config.main);if(k==false||typeof k==="undefined"){l.empty()}h.each(n,function(q,p){l.append(m.renderEach(q,p));if(o){o(n)}});c.load()}};d.prototype.renderEach=function(k,l){if(this.config.tmpl&&f.fn.render){return this.renderUsingTemplate(k,l,this.config.tmpl)}else{a.publish("logger.error","$.fn.render not defined. Render using jquery. this.config.tmpl="+this.config.tmpl+"&$.fn.render="+f.fn.render);return this.renderUsingjQuery(k,l)
}};d.prototype.renderUsingTemplate=function(m,n,l,k){return f("#"+l).render(n)};d.prototype.renderUsingjQuery=function(l,m){var k=f("<li></li>");k.text(m.name+": "+m.text);return k};d.prototype.loadingDiv=function(k){f("[data-plugin='comment-loading']").text(k)};d.prototype.loadNextPg=function(){var k=this;if(k.isLoading===0&&j.inView(k.config.main+" .comment:last-child",true,1000)){k.loadComment(k.config.commentType,function(l){},true,++k.config.curpg)}};d.prototype.loading=function(k){this.loadingDiv("Loading...");
this.isLoading=1};d.prototype.loaded=function(){this.loadingDiv("");this.isLoading=0;a.publish("comments.loaded",this);if(this.config.loadonscroll==false){f(this.config.wrapper).find("#"+this.config.commentType).append("<div class='loadmore'>View more comments</div>")}};d.prototype.loadedAll=function(){this.loadingDiv("Loaded all comments");f(this.config.wrapper+" #"+this.config.commentType+" .loadmore").hide();if(this.comments.length==0){a.publish("comments.loaded.none",this)}else{if(this.comments.length>=0){a.publish("comments.loaded.all",this)
}}this.isLoading=2};return d});define("tiljs/social/social",["../load","../util","jquery","../event","../ui","../logger"],function(g,b,f,d,e,c){var a=function(i){this.id=i;this.config={js:null,js_id:null};this.config=function(j){this.config=b.extend(true,{},this.config,j);this.js=j.js;this.js_id=j.js_id};this.setJS=function(j,k){this.js=j;this.js_id=k};this.plugins={};this._getPluginID=function(j){return h.id+"-"+j};this.addPlugin=function(j){h.plugins[this._getPluginID(j.id)]=j;if(j.alias){for(var k=0;
k<j.alias.length;k++){var l=b.extend(true,{},j,{id:j.alias[k]});delete l.alias;this.addPlugin(l)}}};this.getPlugin=function(j){return h.plugins[this._getPluginID(j)]};var h=this;this.beforeinit=function(){};this.afterloadjs=function(){};this.beforeloadjs=function(){};this.init=function(k){if(h.beforeinit){h.beforeinit()}var j=h.find();c.log(h.id+" init:"+j.length);if(j&&j.length>0||k.parse===true){if(h.beforeloadjs){h.beforeloadjs()}if(h.js&&(h.isJSdependent(j)||k.parse===true)){g.js(h.js,function(m,l){return function(){if(h.afterloadjs){h.afterloadjs(k)
}h.initPlugins(l)}}(h,j),h.js_id)}else{h.initPlugins(j)}}};this.find=function(){return f("[data-plugin^='"+this.id+"-']")};this.isJSdependent=function(j){for(var k=0;k<j.length;k++){var l=j[k];var m=f(l).attr("data-plugin");if(h.plugins[m]&&h.plugins[m].js){return true}}return false};this.initPlugins=function(j){this.registerPluginEvents()};this.registerPluginEvents=function(){b.each(h.plugins,function(l,k){b.each(k.events,function(m,n){f("body").off(m,"[data-plugin='"+l+"']");f("body").on(m,"[data-plugin='"+l+"']",function(o){if(n){try{d.publish("social.action",{plugin:l,event:m,element:this,dom_event:o});
n.call(this,o)}catch(o){d.publish("logger.error",o.stack)}}o.stopImmediatePropagation();return false})});var j=f("body").find("[data-plugin='"+l+"']");j.each(function(n,m){if(k.init){try{k.init(m,k)}catch(o){d.publish("logger.error",o.stack)}}})})};this.preAttachPluginEvent=function(j){var k=0;b.each(h.plugins,function(n,m){var l=j.filter("[data-plugin='"+n+"']");l.each(function(p,o){k++;if(m.init){m.init(o,m);f(o).css("border","2px solid red")}})});c.log(h.id+" found plugin : "+k+"/"+j.length)};
this.renderPlugin=function(n,j,l){var k=f(n);var m=b.data(n);var p=b.extend(true,{},j,m);p.href=m.url||m.href||k.attr("href")||p.href;var o=f(l);f.each(p,function(q,r){o.attr("data-"+q,r)});k.empty();k.append(o);this.parse(n)};this.getAbsoluteUrl=function(j){var k=(j&&j.length>0&&j!=="#")?j:document.location.href;k=k.split("#")[0];if(k&&k.length>2&&k[0]==="/"&&k[1]!=="/"){k=location.protocol+"//"+location.host+k}return k};this._share=function(n,q,m,p){d.publish("social.onBeforeShare",{params:q,element:p,network:this.id});
var o=this.getAbsoluteUrl(n);var l="social_share_"+new Date().getTime();var j=f.extend({name:l,width:700,height:400},m);var k=e.window(o+"?"+f.param(q),j);if(k){k.moveTo(275,275)}}};a.onBeforeShare=function(h){d.subscribe("social.onBeforeShare",h)};return a});define("tiljs/social/facebook",["../social/social","../ui","../logger","../event","../util","module","jquery","../ajax","../is"],function(b,m,o,a,k,c,i,n,j){var g={parse:false,init:true,appid:null,js:"//connect.facebook.net/en_US/sdk.js",js_id:"facebook-jssdk",load_js:false,share_url:"http://www.facebook.com/sharer.php",oauth:false,status:false,xfbml:false,fb_version:"v2.5",share_params:function(q,t,p,r){return{"url[url]":q}
}};var e=k.extend(true,{},g,c.config());var l=new b("facebook","facebook");l.setJS(e.js,e.js_id);var d=l.isJSdependent;l.isJSdependent=function(p){return e.load_js||d(p)};l.addPlugin({id:"like",js:true,init:function(u,r){var q=i(u);var t=k.data(u);var p={href:location.href,layout:"button_count","show-faces":"false",width:"100",action:"like",share:false};var w=k.extend(true,{},p,t);w.href=t.url||t.href||q.attr("href")||w.href;var v=i("<div class='fb-like'></div>");i.each(w,function(x,y){v.attr("data-"+x,y)
});q.empty();q.append(v);l.parse(u)}});l.addPlugin({id:"comments",js:true,init:function(v,t){var r=i(v);var u=k.data(v);var q={href:location.href,colorscheme:"light",numposts:10};var w=k.extend(true,{},q,u);w.href=u.url||u.href||r.attr("href")||w.href;var p=i("<div class='fb-comments'></div>");i.each(w,function(x,y){p.attr("data-"+x,y)});r.empty();r.append(p);l.parse(r[0])}});l.addPlugin({id:"share",alias:["button"],events:{click:function(q){var p=k.data(this);var r=p.title||document.title;l.share(p.url||i(this).attr("href"),r,p.summary,p.image,this)
}}});l.share=function(q,v,p,u,r){if(false&&window.FB&&e.appid){FB.ui({method:"feed",display:"popup",link:l.getAbsoluteUrl(q),picture:l.getAbsoluteUrl(u),name:v,description:p},function(w){})}else{var t={u:l.getAbsoluteUrl(q),display:"popup",sdk:"joey"};if(!j.empty(e.appid)){t.app_id=e.appid}l._share(e.share_url,t,{name:"facebook_share_dialog",width:626,height:(j.IE())?600:436},r)}};l.addPlugin({id:"follow",events:{click:function(p){l.follow(i(this).attr("data-url")||i(this).attr("href"))}},init:function(q,p){}});
l.follow=function(q,p){var r=l.getAbsoluteUrl(q);var t=window.open(q,"_blank");t.focus()};l.addPlugin({id:"login",js:true,events:{click:function(p){l.login()}}});var h=null;l.parse=function(p){if(typeof FB!=="undefined"){FB.XFBML.parse(p)}else{o.warn("'FB' is required in parse")}};l.getGrantedPermissions=function(p){if(typeof FB!=="undefined"){l.api("/me/permissions",function(q){if(p){p(q)}})}else{o.warn("'FB' is required in login")}};l.hasPermissions=function(p,q){if(typeof FB!=="undefined"){l.api("/me/permissions",function(v){if(v&&v.data&&v.data.length>0){var t=typeof p==="string"?p.split(","):(p instanceof Array?p:[]);
for(var r=0;r<t.length;r++){var u=v.data[0];if(u.hasOwnProperty(t[r])){if(q){q(true);return null}}}}if(q){q(false,v&&v.error?v.error:null)}})}else{o.warn("'FB' is required in login")}};l.getPermissions=function(q,r){if(typeof FB!=="undefined"){var p=typeof q==="string"?q:(q instanceof Array?q.join(","):"");l.hasPermissions(q,function(t){if(t===true){if(r){r(t)}}else{l.login(q,function(){l.hasPermissions(q,function(u){if(r){r(u)}})})}})}else{o.warn("'FB' is required in login")}};l.login=function(q,r){if(typeof FB!=="undefined"){o.log(q);
var p=typeof q==="string"?q:(q instanceof Array?q.join(","):"");if(h!=p){FB.login(r,{scope:p})}}else{o.warn("'FB' is required in login")}};l.addPlugin({id:"logout",events:{click:function(p){l.logout()}}});l.logout=function(p){if(typeof FB!=="undefined"){FB.logout(p)}else{o.warn("'FB' is required in logout")}};l._createFBroot=function(){var q="fb-root";var p=i("#"+q);if(!p||p.length==0){p=i("<div></div>");p.attr("id",q);p.css("display","none");i("body").append(p)}return p};l.beforeinit=function(){if(!e.appid){o.warn("'config.appid' is Required")
}};l.beforeloadjs=function(){l._createFBroot()};l.afterloadjs=function(p){if(typeof FB!=="undefined"){o.log("FB js loaded");if(e.init===true||p.init===true){FB.init({appId:e.appid,oauth:e.oauth,status:e.status,cookie:true,xfbml:e.xfbml,version:e.fb_version})}a.publish("FB.onload",FB);FB.Event.subscribe("edge.remove",function(q){a.publish("FB.edge.remove",q)});FB.Event.subscribe("edge.create",function(q){a.publish("FB.edge.create",q)});FB.Event.subscribe("comment.create",function(q){a.publish("FB.comment.create",q)
});FB.Event.subscribe("auth.authResponseChange",function(q){a.publish("FB.auth.authResponseChange",q);if(q.status==="connected"){var t=q.authResponse.userID;var r=q.authResponse.accessToken;a.publish("FB.auth.authResponseChange.connected",q);a.publish("FB.connected",FB)}else{if(q.status==="not_authorized"){a.publish("FB.auth.authResponseChange.not_authorised",q)}else{a.publish("FB.auth.authResponseChange.failed",q)}}})}else{o.warn("'FB' is required in afterloadjs")}};var f=null;l.getUser=function(p){if(typeof FB!=="undefined"&&!f){FB.api("/me",function(q){if(p){f=q;
p(q)}})}else{if(p){p(f)}}};l.onlogin=function(p){a.subscribe("FB.auth.authResponseChange.connected",function(q){l.getUser(function(r){if(p){p(r,q)}})})};l.oncomment=function(p){a.subscribe("FB.comment.create",function(q){l.getUser(function(r){if(p){p(r,q)}})})};l.onlogout=function(p){a.subscribe(["FB.auth.authResponseChange.not_authorised","FB.auth.authResponseChange.failed"],function(q){if(p){f=null;p(q)}})};l.fql=function(p,q){if(typeof FB!=="undefined"){o.log(p);FB.api({method:"fql.query",query:p},q)
}else{o.warn("'FB' is required in fql")}};l.getLikes=function(p){if(typeof FB!=="undefined"){FB.api("/me/likes",function(q){if(p){f=q;p(q)}})}};l.getLikesByCategory=function(q,t){if(q.length>0&&j.string(q)){q=q.split(",")}var p=[];if(q.length>0){k.each(q,function(w,u){p.push("type='"+u+"'")})}var r=p.length>0?"AND ("+p.join(" OR ")+")":"";l.getUser(function(u){if(u){l.fql("select name from page where page_id in (SELECT page_id FROM page WHERE page_id IN (SELECT uid, page_id, type FROM page_fan WHERE uid=me()) "+r+")",function(v){if(t){t(v)
}})}else{o.warn("User is not logged in. Cannot run facebook.getLikesByCategory.")}})};l.paging=l.pageNext=function(p,q){if(p&&p.paging&&p.paging.next){return n.getJSONP(p.paging.next,q)}else{q(null)}};l.pagePrev=function(p,q){if(p&&p.paging&&p.paging.previous){return n.getJSONP(p.paging.previous,q)}else{q(null)}};l.getRegisteredUsersTxt=function(p){l.getRegisteredUsers(function(q){if(p){if(q.length==1){p(q[0].name+" has planned his/her trips on HappyTrips.com.",q)}else{if(q.length>1){p(q.length+" of your friends have planned their trips on HappyTrips.com",q)
}else{p("None of your friends have planned their trips on HappyTrips.com.",q)}}}})};l.getRegisteredUsers=function(p){l.fql("SELECT uid,name,pic_square_with_logo FROM user WHERE is_app_user AND uid IN (SELECT uid2 FROM friend WHERE uid1 = me())",p)};l.api=function(){var p=arguments[0];var t=typeof arguments[1]==="string"?arguments[1]:"GET";var q=typeof arguments[2]==="object"?arguments[2]:{};var r=typeof arguments[1]==="function"?arguments[1]:(typeof arguments[2]==="function"?arguments[2]:(typeof arguments[3]==="function"?arguments[3]:null));
if(typeof FB!=="undefined"){o.debug(p);FB.api(p,t,q,function(u){if(r){r(u)}})}else{o.warn("'FB' is required in api")}};l.getCheckins=function(p){l.api("/me/locations",p)};l.post=function(q,r){var p=typeof arguments[0]==="string"?{message:arguments[0]}:arguments[0];l.login("publish_stream",function(){l.api("/me/feed","POST",p,r)})};l.checkin=function(q,p,r){l.post({message:q,place:p},r)};l.init(e);return l});define("tiljs/ext/date",[],function(){!function(b,g){var f=/(["'])((?:[^\\]|\\.)*?)\1|YYYY|([MD])\3\3(\3?)|SS|([YMDHhmsW])(\5?)|[uUAZSwo]/g,a=/(\d{4})[-.\/](\d\d?)[-.\/](\d\d?)/,h=/(\d\d?)[-.\/](\d\d?)[-.\/](\d{4})/,d=/(\d\d?):(\d\d):?(\d\d)?\.?(\d{3})?(?:\s*(?:(a)|(p))\.?m\.?)?(\s*(?:Z|GMT|UTC)?(?:([-+]\d\d):?(\d\d)?)?)?/i,c=/.[a-z]+/g,e=/\\(.)/g;
b[g].format=function(i){i=b.masks[i]||i||b.masks["default"];var j=this,k="get"+(i.slice(0,4)=="UTC:"?(i=i.slice(4),"UTC"):"");return i.replace(f,function(m,l,q,p,n,r,o){q=r=="Y"?j[k+"FullYear"]()%100:m=="YYYY"?j[k+"FullYear"]():r=="M"?j[k+"Month"]()+1:p=="M"?b.monthNames[j[k+"Month"]()+(n?12:0)]:r=="D"?j[k+"Date"]():p=="D"?b.dayNames[j[k+"Day"]()+(n?7:0)]:r=="H"?j[k+"Hours"]()%12||12:r=="h"?j[k+"Hours"]():r=="m"?j[k+"Minutes"]():r=="s"?j[k+"Seconds"]():m=="S"?j[k+"Milliseconds"]():m=="SS"?(l=j[k+"Milliseconds"](),l>99?l:(l>9?"0":"00")+l):m=="u"?(j/1000)>>>0:m=="U"?+j:m=="A"?b[j[k+"Hours"]()>11?"pm":"am"]:m=="Z"?"GMT "+(-j.getTimezoneOffset()/60):m=="w"?j[k+"Day"]()||7:r=="W"?(l=new b(+j+((4-(j[k+"Day"]()||7))*86400000)),Math.ceil(((l.getTime()-l["s"+k.slice(1)+"Month"](0,1))/86400000+1)/7)):m=="o"?new b(+j+((4-(j[k+"Day"]()||7))*86400000))[k+"FullYear"]():l?q.replace(e,"$1"):m;
return o&&q<10?"0"+q:q})};b.am="AM";b.pm="PM";b.masks={"default":"DDD MMM DD YYYY hh:mm:ss",isoUtcDateTime:'UTC:YYYY-MM-DD"T"hh:mm:ss"Z"'};b.monthNames="JanFebMarAprMayJunJulAugSepOctNovDecJanuaryFebruaryMarchAprilMayJuneJulyAugustSeptemberOctoberNovemberDecember".match(c);b.dayNames="SunMonTueWedThuFriSatSundayMondayTuesdayWednesdayThursdayFridaySaturday".match(c);String[g].date=Number[g].date=function(k){var i,j,l=new b,o=+this||""+this;if(isNaN(o)){if(i=o.match(a)){l.setFullYear(i[1],i[2]-1,i[3])
}else{if(i=o.match(h)){j=b.middle_endian?1:2;l.setFullYear(i[3],i[j]-1,i[3-j])}}i=o.match(d)||[0,0,0];l.setHours(i[6]&&i[1]<12?+i[1]+12:i[5]&&i[1]==12?0:i[1],i[2],i[3]|0,i[4]|0);if(i[7]){l.setTime(l-((l.getTimezoneOffset()+(i[8]|0)*60+((i[8]<0?-1:1)*(i[9]|0)))*60000))}}else{l.setTime(o<4294967296?o*1000:o)}return k?l.format(k):l}}(Date,"prototype");return{}});define("tiljs/apps/times/comments",["module","jquery","json","jsrender","localstoragec","../times/api","../../comments","../../ajax","../../plugin/dynamic","../../util","../../login","../../event","../../ui","../../is","../../string","../../plugin/lazy","../../cookie","../../logger","../../timer","../../analytics/mytimes","../../compatibility","../../social/facebook","../../page","../../user","../../ext/date"],function(module,$,json,jsrender,localstoragec,api,comments,ajax,dynamic,util,login,event,ui,is,string,lazy,cookie,logger,timer,mytimes,compatibility,facebook,page,userClass,ext_date){var CONSTANT={RATE_TYPE:{AGREE:100,DISAGREE:101,RECOMMEND:102,OFFENSIVE:103}};
var default_config={validation:{minlength:1},loadCommentFromMytimes:false,commentType:"comments",loadonscroll:true,sendCommentLiveEmail:true,loginRequiredForRating:true,nonloggedinComment:true,disabledirectcomment:false,maxchar:3000,maxCommentWrapLength:500,maxResponseCount:3,hideResponses:false,share_url:"/share.cms",verify_comment_url:"/json/cmtverified.cms",messages:{name_required:"Please enter your name.",location_required:"Please enter your location.",captcha_required:"Please enter captcha value.",name_toolong:"Name cannot be longer than 30 chars.",name_not_string:"Name can only contain alphabets.",location_toolong:"Location cannot be longer than 30 chars.",location_not_string:"Location can only contain alphabets.",captcha_toolong:"Captcha cannot be longer than 4 chars.",captcha_number_only:"Captcha value can only be a number.",email_required:"Please enter your email address.",email_invalid:"Please enter a valid email address.",captcha_invalid:"Please enter a valid captcha value.",minlength:"You can't post this comment as the length it is too short. ",blank:"You can't post this comment as it is blank.",maxlength:"You have entered more than 3000 characters.",popup_blocked:"Popup is blocked.",has_url:"You can't post this comment as it contains URL.",duplicate:"You can't post this comment as it is identical to the previous one.",abusive:"You can't post this comment as it contains inappropriate content.",self_agree:"You can't Agree with your own comment",self_disagree:"You can't Disagree with your own comment",self_recommend:"You can't Recommend your own comment",self_offensive:"You can't mark your own comment as Offensive",already_agree:"You have already Agreed with this comment",already_disagree:"You have already Disagreed with this comment",already_recommended:"You have already Recommended this comment",already_offensive:"You have already marked this comment Offensive",cant_agree_disagree:"You can't Agree and Disagree with the same comment",cant_agree_offensive:"You can't Agree and mark the same comment Offensive",cant_disagree_recommend:"You can't Disagree and Recommend the same comment",cant_recommend_offensive:"You can't Recommend and mark the same comment Offensive",permission_facebook:"You can't post to facebook. Post permission is required.",offensive_reason:"Please select a reason.",offensive_reason_text:"Please enter a reason.",offensive_reason_text_limit:"Please enter less than 200 chars."}};
var times_comments=comments;comments.config=util.extend(true,{},comments.config,default_config,module.config());times_comments.prototype.updateConfig=function(update_config){};var commentType=comments.config.commentType;times_comments.prototype.initialize=function(){var tthis=this;this.config=util.extend(true,{},comments.config,module.config(),this.config);tthis.comments=[];tthis.commentCount=0;tthis.countPresent=false;tthis.pageCount=1;tthis.config.comment_block_count=tthis.config.comment_block_count||25;
tthis.config.commentType=tthis.config.commentType||commentType;tthis.config.attachReplyAction=tthis.config.attachReplyAction!==false;tthis.config.attachOpinionAction=tthis.config.attachOpinionAction!==false;if(tthis.config.disabledirectcomment){$(tthis.config.wrapper+' [data-plugin="comment-form"]').hide()}if(login.getUser()){$(tthis.config.wrapper+" [data-plugin='user-isloggedin']").show();$(tthis.config.wrapper+" [data-plugin='user-notloggedin']").hide()}else{$(tthis.config.wrapper+" [data-plugin='user-isloggedin']").hide();
$(tthis.config.wrapper+" [data-plugin='user-notloggedin']").show()}if(!tthis.config.nonloggedinComment&&tthis.pageCount===1){$(tthis.config.wrapper+' [data-plugin="user-notloggedin"]').remove()}tthis.config.opinions=[{name:"Agree",id:"agree"},{name:"Disagree",id:"disagree"},{name:"Recommend",id:"recommended"},{name:"Offensive",id:"offensive"}];if(tthis.config.attachOpinionAction===true){tthis.attachOpinionAction()}if(tthis.config.attachReplyAction===true){tthis.attachReplyAction()}this.getData(function(data,commentCount){tthis.renderCommentCount(commentCount||(data?data.length:0));
if(data&&data.length>0){tthis.renderNoComment(false);tthis.render(data)}else{tthis.renderNoComment(true)}tthis.verifyEmailComment()});(function(tthis){event.subscribe("window.scroll",function(){var config=tthis.getConfig();if(tthis.config.loadonscroll===true&&tthis.isLoading===0&&ui.inView(tthis.config.wrapper+" #"+tthis.config.commentType+" [data-plugin='comment']:visible:last",true,200)){tthis.loadComment(tthis.config.commentType,function(data){},true,++tthis.pageCount)}})})(tthis)};times_comments.run=function(config){this.config=util.extend(true,{},comments.config,module.config());
var msid=config&&config.msid?config.msid:window.msid;var main=config&&config.main?config.main:"#"+this.config.commentType;var wrapper=config&&config.wrapper?config.wrapper:this.config.wrapper;var toi_comment={};toi_comment[this.config.commentType]=new comments({main:main,msid:msid,wrapper:wrapper});toi_comment[this.config.commentType].initialize();$(wrapper+" #comment_sort").change(function(){var rootid=$(this).val(),id="comments"+(rootid&&rootid.length>0?"_"+rootid:""),sortLbl=rootid.length?rootid:"newest";
$(wrapper+" .comments-list").hide();$(wrapper+" #"+id).show();$(wrapper+".comment-section .noComment").hide();if(toi_comment[id]){toi_comment[id].updateAfterCommentsLoaded();toi_comment[id].attachReplyAction();toi_comment[id].attachOpinionAction();toi_comment[id].updateCachedRating()}else{toi_comment[id]=new comments({main:"#"+id,msid:msid,commentType:id,wrapper:wrapper});toi_comment[id].initialize()}event.publish("comment.sort",sortLbl);$(wrapper+" [data-plugin='comment-error-outer']").text("");
$(wrapper+" [data-plugin='comment-error']").text("");event.publish("comment_error")});toi_comment[this.config.commentType].processRating();(function(that){event.subscribe("user.status",function(){toi_comment[that.config.commentType].processRating(that)})}(this));event.subscribe("comments.loaded",function(commentObj){logger.log("comments.loaded:"+commentObj.config.commentType);commentObj.updateAfterCommentsLoaded();if(commentObj.config.hideResponses===true){commentObj.hideExtraResponses()}});event.subscribe("comments.loaded.none",function(commentObj){logger.log("comments.loaded.none:"+commentObj.config.commentType);
commentObj.updateAfterCommentsLoaded()});event.subscribe("login.error",function(err){if(err&&err.error){logger.error(err.error)}else{logger.error(err)}});return toi_comment};times_comments.prototype.processRating=function(){var user=login.getUser();if(!user){$(this.config.wrapper+" [data-plugin='comment-error-outer']").text("");$(this.config.wrapper+" [data-plugin='comment-error']").text("");event.publish("comment_error")}var commenttype="comments"+($(this.config.wrapper+" #comment_sort").length&&$(this.config.wrapper+" #comment_sort").val()!==""?"_"+$(this.config.wrapper+" #comment_sort").val():"");
if(user&&this&&this.config&&this.config.withrating){var savedComment=this.getSavedComment();var usr_data={};usr_data.userId=user.getId();usr_data.baseEntityId=0;usr_data.uniqueAppKey=this.config.withrating;usr_data.appKey=page.getChannel();$.getJSON("https://myt.indiatimes.com/mytimes/alreadyRated?callback=?",usr_data,function(data){event.publish("comments.user_has_rated",data);if(window.msid==this.config.msid&&this.getSavedComment()){data=(data&&data!="")?data:" ";savedComment.urs=data;this.saveComment(savedComment);
this.loadSavedComment()}})}this.markFollowingAll()};times_comments.prototype.attachUserToComment=function(commentObj,user){logger.log("Attaching user to comment");commentObj.user={id:user.getId(),uid:user.getId()?user.getUid():"",name:user.getFullName(),username:user.getUsername(),location:user.getCITY(),image:user.getThumb(),email:user.getEmail()}};times_comments.prototype.hideExtraResponses=function(){var ttthis=this;$($(this.config.wrapper+" #"+this.config.commentType+" .comment-box.level1").get().reverse()).each(function(i,v){var tc=$(this);
var tc_level=tc.data("level");var tc_next=tc.next();if(is.numberOnly(tc_next.data("level"))){var response_cnt=0;while((tc_next.data("level")!=tc_level)&&(tc_next.is(":hidden"))&&(i<ttthis.config.comment_block_count)){if(response_cnt==ttthis.config.maxResponseCount){tc_next.before('<div class="show_all_responses comment-box level'+(tc_level+1)+'" data-level="'+tc_level+'" data-action="all_responses"> Show all responses </div>');break}else{tc_next.slideDown();tc_next=tc_next.next();if(!is.numberOnly(tc_next.data("level"))){break
}}response_cnt++}}})};times_comments.prototype.updateAfterCommentsLoaded=function(){var commentObj=this;if(this.pageCount===1){if(commentObj.config.commentType===this.config.commentType){if(commentObj.comments.length>0){logger.log("updateAfterCommentsLoaded : comments.loaded:"+commentObj.config.commentType);$(commentObj.config.wrapper+".comment-section .sortby").show()}else{logger.log("updateAfterCommentsLoaded : comments.loaded.none:"+commentObj.config.commentType);$(commentObj.config.wrapper+".comment-section .sortby").hide();
$(commentObj.config.wrapper+".comment-section .noComment").text("Be the first one to review.").show()}}if(commentObj.countPresent!==true){logger.log("updateAfterCommentsLoaded : countPresent:false:"+commentObj.config.commentType);if(commentObj.comments.length===0){$(commentObj.config.wrapper+".comment-section .noComment").text("Be the first one to review.").show()}else{if(commentObj.config.commentType==="comments_discussed"){$(commentObj.config.wrapper+".comment-section .noComment").text("None of the comments have been discussed.").show()
}else{if(commentObj.config.commentType==="comments_agree"){}else{if(commentObj.config.commentType==="comments_disagree"){$(commentObj.config.wrapper+".comment-section .noComment").text("None of the comments have been down voted.").show()}}}}}}};times_comments.prototype.renderCommentCount=function(count){var tthis=this;function displayCount(type,cnt){$(tthis.config.wrapper+" [data-plugin='comment-count"+(type?"-"+type:"")+"']").text(cnt?cnt:"0");event.publish("comment.count",(cnt?cnt:"0"))}if(is.object(count)){displayCount("",count.newest);
displayCount("oldest",count.oldest);displayCount("recommended",count.recommended);displayCount("discussed",count.discussed);displayCount("agree",count.agree);displayCount("disagree",count.disagree)}else{displayCount("",count)}};times_comments.prototype.loadComment=function(commentType,callback,append,curpg){var tthis=this;if(tthis.config.loadCommentFromMytimes==true){tthis._loadCommentMytimes(commentType,function(data){tthis.render(data,callback,append)},curpg)}else{tthis._loadComment(commentType,function(data){tthis.render(data,callback,append)
},curpg)}};times_comments.prototype.getData=function(callback){var tthis=this;if(tthis.config.loadCommentFromMytimes==true){this._loadCommentMytimes(this.config.commentType,callback)}else{this._loadComment(this.config.commentType,callback)}};times_comments.prototype._loadComment=function(commentType,callback,curpg){var tthis=this;var config=tthis.config;tthis.loading();logger.log("loading comments: "+config.msid);api.api(commentType,{msid:config.msid,curpg:curpg||1},function(comments_data){logger.log("loaded comments: "+config.msid);
var commentsD=comments_data.articlecomment||comments_data.new_cmtofart2_nit||comments_data.new_cmtofart2_nit_v1||comments_data.articleshow_othcmtofart||comments_data.new_cmtofart2_nit_sub_dev||(comments_data.mytuserdata?comments_data:null);var userData=commentsD.mytuserdata&&commentsD.mytuserdata.array?(is.array(commentsD.mytuserdata.array)?commentsD.mytuserdata.array:[commentsD.mytuserdata.array]):null;var commentsData=commentsD.rothrd&&commentsD.rothrd.op?(is.array(commentsD.rothrd.op)?commentsD.rothrd.op:[commentsD.rothrd.op]):null;
if(!commentsData||commentsData.length==0){tthis.loadedAll();callback([]);return null}tthis.flagData=commentsData[0];var commentCount={total:commentsD.rothrd.opctr,newest:commentsD.rothrd.opctr,oldest:commentsD.rothrd.opctr,recommended:commentsD.rothrd.recommendcount,discussed:commentsD.rothrd.opctrtopcnt,disagree:commentsD.rothrd.disagreecount,agree:commentsD.rothrd.agreecount};var commentPageCount={comments:Math.ceil(commentsD.rothrd.opctrtopcnt/config.comment_block_count),comments_oldest:Math.ceil(commentsD.rothrd.opctrtopcnt/config.comment_block_count),comments_recommended:Math.ceil(commentsD.rothrd.recommendcount/config.comment_block_count),comments_discussed:Math.ceil(commentsD.rothrd.opctrtopcnt/config.comment_block_count),comments_disagree:Math.ceil(commentsD.rothrd.disagreecount/config.comment_block_count),comments_agree:Math.ceil(commentsD.rothrd.agreecount/config.comment_block_count)};
var users=[];var i=0;if(userData){for(i=0;i<userData.length;i++){users.push(userData[i].sso)}}var commentsResult=[];for(var c=0;c<commentsData.length;c++){var cmt=commentsData[c];var user=userData?userData[users.indexOf(cmt.roaltdetails.fromaddress)]:null;var comment={index:++tthis.commentCount,id:cmt.messageid,comment:is.string(cmt.optext)?$("<div/>").text(cmt.optext).html():"",level:cmt.level,childcount:cmt.CHILD?cmt.CHILD.length:0,parentuid:cmt.parentuid,parentusername:cmt.parentusername,time:cmt.rodate?util.getDate(cmt.rodate).getTime():"",abstime:cmt.rodate,opinion:(function(cmt){var opinions=[];
if(tthis.config.opinions){for(var o=0;o<tthis.config.opinions.length;o++){opinions.push({name:tthis.config.opinions[o].name,id:tthis.config.opinions[o].id,count:cmt[tthis.config.opinions[o].id]})}}return opinions.length>0?opinions:null}(cmt)),user:{id:user&&user._id?user._id:cmt.roaltdetails.fromname,username:user?user.D_N_U:null,name:cmt.roaltdetails.fromname||(user&&user.FL_N?user.FL_N:""),location:user&&user.CITY&&!is.object(user.CITY)&&!is.empty(user.CITY)?user.CITY:(!is.empty(cmt.roaltdetails.location)&&!is.object(cmt.roaltdetails.location)?cmt.roaltdetails.location:null),image:user&&user.thumb?user.thumb:cmt.roaltdetails.imageurl,email:user?user.sso:"",rate:cmt.roaltdetails.urs,followers:user?user.F_C:0,follower_text:(user?user.F_C:0)>1?("("+user.F_C+" followers)"):((user?user.F_C:"")>0?"("+user.F_C+" follower)":""),points:user&&user.reward&&user.reward.user&&user.reward.user.statusPoints?user.reward.user.statusPoints:null,pointslevel:user&&user.reward&&user.reward.user&&user.reward.user.levelName?user.reward.user.levelName:null,pointsNeeded:(function(user){var points_needed="";
var user_points=user&&user.reward&&user.reward.user&&user.reward.user.statusPoints?user.reward.user.statusPoints:null;if(user_points==null||user_points<250){points_needed=250-user_points}else{if(user_points>249&&user_points<5000){points_needed=5000-user_points}else{if(user_points>4999&&user_points<25000){points_needed=25000-user_points}else{if(user_points>24999&&user_points<250000){points_needed=250000-user_points}}}}return points_needed}(user)),badge:(function(user){var badges=[];if(user&&user.rewardpoint&&user.rewardpoint.userbadges&&user.rewardpoint.userbadges.activityBadge){var activityBadge=user.rewardpoint.userbadges.activityBadge;
if(!is.array(activityBadge)){activityBadge=[activityBadge]}for(var d=0;d<activityBadge.length;d++){var badge=activityBadge[d].currentBadge;badges.push({name:badge.bname,count:badge.level,image:badge.bimg,desc:badge.desc,levelDesc:util.decodeHTML(badge.levelDesc)})}}return badges.length>0?badges:null}(user))}};commentsResult.push(comment);logger.log("Parsed comment "+c)}tthis.comments=tthis.comments.concat(commentsResult);logger.log("rendering  "+commentsResult.length+" comments");callback(commentsResult,commentCount);
logger.log("rendered "+commentsResult.length+" comments");tthis.loaded();var curpgn=curpg||1;if(tthis.config.loadonscroll==false&&!commentsResult||!(curpgn<commentPageCount[tthis.config.commentType])){tthis.loadedAll()}else{if(tthis.config.loadonscroll==true&&!commentsResult||commentsResult.length==0){tthis.loadedAll()}}});return null};times_comments.prototype.parseComment=function(cmt,commentsResult,level){var ttthis=this;var user=cmt.user_detail||{FL_N:cmt.A_D_N||cmt.F_NAME,CITY:cmt.CITY};user.reward={user:cmt.user_reward};
user.rewardpoint={userbadges:cmt.user_reward_point_info};user.rate=cmt&&cmt.U_R?cmt.U_R:"";var tthis=this;level=level||1;var comment={index:++tthis.commentCount,id:cmt.A_U_I,comment:is.string(cmt.C_T)?$("<div/>").html(cmt.C_T).text():"",trimcom:(function(cmt){var t_c=is.string(cmt.C_T)?$("<div/>").html(cmt.C_T).text():"";return util.trimText(t_c,ttthis.config.maxCommentWrapLength)}(cmt)),authrid:(cmt.C_A_ID?cmt.C_A_ID:""),level:level,parentuid:cmt.O_ID,childcount:cmt.CHILD?cmt.CHILD.length:0,parentusername:cmt.O_D_N||cmt.F_NAME,time:(cmt.A_DT?util.getDate(parseInt(cmt.A_DT,10)).getTime():""),abstime:cmt.A_DT?util.getDate(parseInt(cmt.A_DT,10)).format("DD MMM, YYYY HH:mm A"):"",opinion:(function(cmt){var opinions=[];
opinions.push({name:"Agree",id:"AC_A_C",count:(cmt.AC_A_C)?cmt.AC_A_C:0});opinions.push({name:"Disagree",id:"AC_D_C",count:(cmt.AC_D_C)?cmt.AC_D_C:0});opinions.push({name:"Recommend",id:"AC_R_C",count:(cmt.AC_R_C)?cmt.AC_R_C:0});opinions.push({name:"Offensive",id:"AC_O_C",count:(cmt.AC_O_C)?cmt.AC_O_C:0});return opinions.length>0?opinions:null}(cmt)),user:{id:user&&user._id?user._id:null,username:user&&user.D_N_U?user.D_N_U:null,name:user&&user.FL_N?user.FL_N:"",location:user&&user.CITY&&!is.object(user.CITY)&&!is.empty(user.CITY)&&(user.CITY!="Unknown")?user.CITY:null,image:user&&user.thumb?user.thumb:"",email:user&&user.sso?user.sso:"",rate:user&&user.rate?user.rate:"",followers:user&&user.F_C?user.F_C:0,follower_text:(user?user.F_C:0)>1?("("+user.F_C+" followers)"):((user?user.F_C:"")>0?"("+user.F_C+" follower)":""),points:user&&user.reward&&user.reward.user&&user.reward.user.statusPoints?user.reward.user.statusPoints:null,pointslevel:user&&user.reward&&user.reward.user&&user.reward.user.levelName?user.reward.user.levelName:null,pointsNeeded:(function(user){var points_needed="";
var user_points=user&&user.reward&&user.reward.user&&user.reward.user.statusPoints?user.reward.user.statusPoints:null;if(user_points==null||user_points<250){points_needed=250-user_points}else{if(user_points>249&&user_points<5000){points_needed=5000-user_points}else{if(user_points>4999&&user_points<25000){points_needed=25000-user_points}else{if(user_points>24999&&user_points<250000){points_needed=250000-user_points}}}}return points_needed}(user)),badge:(function(user){var badges=[];if(user&&user.rewardpoint&&user.rewardpoint.userbadges&&user.rewardpoint.userbadges.activityBadge){var activityBadge=user.rewardpoint.userbadges.activityBadge;
if(!is.array(activityBadge)){activityBadge=[activityBadge]}for(var d=0;d<activityBadge.length;d++){var badge=activityBadge[d].currentBadge;badges.push({name:badge.bname,count:badge.level,image:badge.bimg,desc:badge.desc,levelDesc:util.decodeHTML(badge.levelDesc)})}}return badges.length>0?badges:null}(user))}};commentsResult.push(comment);if(cmt.CHILD){for(var cmtChild in cmt.CHILD){tthis.parseComment(cmt.CHILD[cmtChild],commentsResult,level+1)}}};times_comments.prototype._loadCommentMytimes=function(commentType,callback,curpg){var tthis=this;
var config=tthis.config;tthis.loading();logger.log("loading comments: "+config.msid);api.api(commentType,{msid:config.msid,pagenum:curpg||1},function(comments_data){logger.log("loaded comments: "+config.msid);var commentsData=comments_data;if(!commentsData||commentsData.length==0){tthis.loadedAll();callback([]);return null}tthis.flagData=commentsData[0];var commentCount={total:commentsData[0].totalcount,newest:commentsData[0].totalcount,oldest:commentsData[0].totalcount,recommended:commentsData[0].totalcount,discussed:commentsData[0].totalcount,disagree:commentsData[0].totalcount,agree:commentsData[0].totalcount};
var commentPageCount={comments:Math.ceil(commentCount.newest/config.comment_block_count),comments_oldest:Math.ceil(commentCount.oldest/config.comment_block_count),comments_recommended:Math.ceil(commentCount.recommended/config.comment_block_count),comments_discussed:Math.ceil(commentCount.discussed/config.comment_block_count),comments_disagree:Math.ceil(commentCount.disagree/config.comment_block_count),comments_agree:Math.ceil(commentCount.agree/config.comment_block_count)};var commentsResult=[];for(var c=1;
c<commentsData.length;c++){var cmt=commentsData[c];var reason=null;if(cmt.DLT==1){reason="DLT fail"}else{if(is.empty(cmt.C_T)){reason="Blank fail"}}if(reason){logger.log("Not Parsed "+reason+" comment "+c)}else{tthis.parseComment(cmt,commentsResult);logger.log("Parsed comment "+c)}}tthis.countPresent=commentsData[0].countPresent||false;tthis.comments=tthis.comments.concat(commentsResult);logger.log("rendering  "+commentsResult.length+" comments");callback(commentsResult,commentCount);logger.log("rendered "+commentsResult.length+" comments");
tthis.loaded();var curpgn=curpg||1;if(tthis.config.loadonscroll==false&&!commentsResult||!(curpgn<commentPageCount[tthis.config.commentType])){tthis.loadedAll()}else{if(tthis.config.loadonscroll==true&&!commentsResult||commentsResult.length==0){tthis.loadedAll()}}});return null};function replaceAll(find,replace,str){return str.replace(new RegExp(find,"g"),replace)}var domain="http://jcmsdev.indiatimes.com";var getUsers=function(data){var ssoids={};for(var i=0;i<data.length;i++){ssoids[(data[i].roaltdetails.fromaddress)]={}
}return ssoids};times_comments.prototype.postToSocial=function(message,sites,closeCallback){var tthis=this;var domainOnly=util.getDomainOnly();var user=login.getUser();window.newShare=true;window.newShareData={sites:sites,message:message,link:window.facebooklink||page.getMeta("og:url"),title:window.facebookktitle||page.getMeta("og:title"),domain:window.location.host,picture:window.fb_Img||page.getMeta("og:image"),desc:window.facebooksyn||page.getMeta("og:description"),facebook:user?user.facebook:null,twitter:user?user.twitter:null};
if(-1!=window.newShareData.sites.indexOf("facebook")){if(typeof FB=="undefined"){require(["tiljs/social/facebook","tiljs/event"],function(facebook,event){facebook.init({init:true,parse:true});event.subscribe("FB.onload",function(data){tthis.postToFB(window.newShareData)})})}else{tthis.postToFB(window.newShareData)}sites=sites.replace(/facebook,|facebook/g,"");window.newShareData.sites=sites}if(!sites.length){return true}var url=tthis.config.share_url+"?sites="+sites;var socialPost=ui.window(url,{width:600,height:230,name:"socialPost",closeCallback:closeCallback});
if(socialPost){try{socialPost.moveTo(250,240)}catch(e){logger.log("Handled IE Exception.");logger.error(e)}}else{logger.error("Popups are blocked. Please enable them.")}};times_comments.prototype.postToFB=function(data){FB.ui({method:"feed",message:data.message,name:data.title,link:data.link,picture:data.picture,caption:data.domain,description:data.desc})};times_comments.prototype.postToTwitter=function(message,closeCallback){var domainOnly=util.getDomainOnly();if(message.length>100){message=message.substring(0,99)+"..."
}window.log=window.log||function(){};window.popupblocked=0;cookie.remove("fbcheck","/",domainOnly);cookie.remove("twtcheck","/",domainOnly);cookie.set("twtcheck","1",1,"/",domainOnly);cookie.set("usercomt",message,1,"/",domainOnly);var url="/stgredirectpagetest.cms";var twitterPost=ui.window(url,{width:600,height:230,name:"twitterPost",closeCallback:closeCallback});if(twitterPost){twitterPost.moveTo(250,240)}else{window.popupblocked=1;if(is.desktop()){twitterPost=ui.iframe(url,{width:575,height:314,name:"twitterPost",closeCallback:closeCallback})
}else{alert("Popups are blocked. Please enable them.")}}};times_comments.prototype.postToFacebook=function(message,closeCallback){var domainOnly=util.getDomainOnly();var tthis=this;if(window.localStorage){localStorage.setItem("usercomt",message)}window.log=window.log||function(){};window.popupblocked=0;cookie.remove("fbcheck","/",domainOnly);cookie.remove("twtcheck","/",domainOnly);cookie.set("fbcheck","1",1,"/",domainOnly);cookie.set("usercomt",message,1,"/",domainOnly);var url="/stgredirectpagetest.cms";
var facebookPost=ui.window(url,{width:600,height:230,name:"facebookPost",closeCallback:closeCallback});if(facebookPost){facebookPost.moveTo(250,240)}else{window.popupblocked=1;if(is.desktop()){facebookPost=ui.iframe(url,{width:575,height:314,name:"facebookPost",closeCallback:closeCallback})}else{alert("Popups are blocked. Please enable them.")}}};times_comments.prototype.attachOpinionAction=function(){logger.log("Attaching Opinion Action");var tthis=this;var opinions=this.config.opinions;for(var o=0;
o<opinions.length;o++){var opinion=opinions[o];(function(opinion){$(tthis.config.wrapper).off("click","[data-action='comment-"+opinion.id+"']");$(tthis.config.wrapper).on("click","[data-action='comment-"+opinion.id+"']",function(){var ref=ui.getActionReferences(this,tthis.config.comment);var parent=ref.parent;var opinionid=parent.attr("data-id");(function(tthis,parent,opinion,ref){tthis["rate"+opinion.name](opinionid,function(errMsg){if(errMsg){tthis.error(errMsg,ref["comment-error-outer"])}else{tthis.error("",ref["comment-error-outer"]);
var count_ele=parent.find("[data-plugin='comment-"+opinion.id+"-count']");var currentCount=parseInt(count_ele.text(),10);$(count_ele).text(++currentCount)}},ref)}(tthis,parent,opinion,ref));event.publish("comment.opinion",opinion.id);return false})}(opinion))}$(tthis.config.wrapper).off("focus",'[data-plugin="comment-input"]');$(tthis.config.wrapper).on("focus",'[data-plugin="comment-input"]',function(){var ref=ui.getActionReferences(this,tthis.config.comment);if(ref["comment-form"]&&!ref["comment-form"].hasClass("full")){ref["comment-form"].addClass("full")
}else{if(ref["comment-reply"]&&!ref["comment-reply"].hasClass("full")){ref["comment-reply"].addClass("full")}}setcaptcha(ref)});$(tthis.config.wrapper).off("focus","[data-plugin='get-user-name']");$(tthis.config.wrapper).on("focus","[data-plugin='get-user-name']",function(){var ref=ui.getActionReferences(this,tthis.config.comment);if(ref["comment-form-login"]){ref["comment-form-login"].removeClass("noreg");setcaptcha(ref)}});$(tthis.config.wrapper).on("mouseover",".badges .more-btn",function(event){var elemTop=$(event.target).closest(".comment-box").position().top+$(event.target).closest(".comment-box").closest(".comment-box").height(),elemH=$(event.target).find(".popup_badge").height(),wH=$(window).height(),commentScrollPos=0;
$(event.target).find(".popup_badge").removeClass("popup_above");if(((elemTop-commentScrollPos)+elemH)>wH){$(event.target).find(".popup_badge").addClass("popup_above")}$(event.target).find(".popup_badge").show()});$(tthis.config.wrapper).on("mouseout",".badges .more-btn",function(event){$(event.target).find(".popup_badge").hide()});function setcaptcha(ref){var $set_user_captcha=ref["set-user-captcha"];if($set_user_captcha.text().length==0){$set_user_captcha.text(Math.floor((Math.random()*10))+"+"+Math.floor((Math.random()*10))+"=")
}}$(tthis.config.wrapper).off("click","[data-action='offensive_popup_submit']");$(tthis.config.wrapper).on("click","[data-action='offensive_popup_submit']",function(){var ref=ui.getActionReferences(this,tthis.config.comment);var opinionid=ref.parent.attr("data-id");var reason=null;reason=ref.offensive_popup.find("input:checked").val();if(!reason){tthis.error(tthis.config.messages.offensive_reason,ref["comment-offensive-error"])}else{if(reason=="Others"){var reasonVal=ref.offensive_popup_reason.val().trim();
if(!reasonVal||reasonVal==""){tthis.error(tthis.config.messages.offensive_reason_text,ref["comment-offensive-error"]);reason=null}else{if(reasonVal.length>200){tthis.error(tthis.config.messages.offensive_reason_text_limit,ref["comment-offensive-error"]);reason=null}else{reason="Others: "+reasonVal}}}}if(reason){tthis.rate(opinionid,CONSTANT.RATE_TYPE.OFFENSIVE,0,function(error,resp){if(error){tthis.error(error,ref["comment-offensive-error"])}else{if(!error&&ref.parent){ref.offensive_popup.addClass("submitted")
}}},ref,reason)}});$(tthis.config.wrapper).off("click","[data-action='offensive_popup_close']");$(tthis.config.wrapper).on("click","[data-action='offensive_popup_close']",function(){var ref=ui.getActionReferences(this,tthis.config.comment);if(ref.offensive_popup&&ref.offensive_popup.hasClass("submitted")){ref.parent.find("[data-action='comment-offensive-already']").show();ref.parent.find("[data-action='comment-offensive']").hide()}ref.offensive_popup.hide();return false})};times_comments.prototype.attachReplyAction=function(){logger.log("Attaching Reply Action");
var tthis=this;$(tthis.config.wrapper).off("click","[data-action='all_responses']");$(tthis.config.wrapper).on("click","[data-action='all_responses']",function(){var tc_level=$(this).data("level"),tc_next=$(this).next();while(tc_next.data("level")!=tc_level){tc_next.slideDown();tc_next=tc_next.next();if(!is.numberOnly(tc_next.data("level"))){break}}$(this).remove()});$(tthis.config.wrapper).off("click","[data-action='more-response-length']");$(tthis.config.wrapper).on("click","[data-action='more-response-length']",function(){$(this).parent().hide();
$(this).parent().next().show();event.publish("comment.readmore")});$(tthis.config.wrapper).off("click","[data-action='comment-reply']");$(tthis.config.wrapper).on("click","[data-action='comment-reply']",function(){var ref=ui.getActionReferences(this,tthis.config.comment);var parent=ref.parent;if(ref["comment-reply"]){ref["comment-reply"].show();if(is.defined(tthis.config.rating)&&tthis.config.rating){if(userInfo.userRating!=null&&userInfo.userRating!=undefined&&userInfo.userRating!=""){$(tthis.config.wrapper+" [data-plugin='comment-rating']").val($(tthis.config.wrapper+" [data-plugin='rating-list'] [data-plugin='rating-vaue'][val="+userInfo.userRating+"]").html())
}}}else{var commentForm=$(tthis.config.wrapper+" [data-plugin='comment-form']");var commentFormHTML=$("<div>"+commentForm.html()+"</div>");commentFormHTML.find("[data-clear='true']").remove();var tmpl=$.templates("<div class='"+commentForm.attr("class")+" reply' data-plugin='comment-reply'>"+commentFormHTML.html()+"</div>");parent.append(tmpl.render([{}]));if(is.defined(tthis.config.rating)&&tthis.config.rating){if(userInfo.userRating!=null&&userInfo.userRating!=undefined&&userInfo.userRating!=""){$(tthis.config.wrapper+" [data-plugin='comment-rating']").val($(tthis.config.wrapper+" [data-plugin='rating-list'] [data-plugin='rating-vaue'][val="+userInfo.userRating+"]").html())
}}}ref=ui.getActionReferences(this,tthis.config.comment);tthis.error("",ref["comment-error"]);$("[placeholder]").blur();return false});$(tthis.config.wrapper).off("click","[data-action='toggle_replies']");$(tthis.config.wrapper).on("click","[data-action='toggle_replies']",function(){var t=$(this);var tc=t.closest(".comment-box");var tc_level=tc.data("level");var tc_next=tc.next();var tstatus=t.attr("data-togglereplies");if(is.numberOnly(tc_next.data("level"))&&tstatus=="show"){event.publish("comment.togglereplies","Show");
t.attr("data-togglereplies","hide");var response_cnt=0;while(tc_next.data("level")!=tc_level){if(response_cnt==3){tc_next.before('<div class="show_all_responses comment-box level'+(tc_level+1)+'" data-level='+tc_level+' data-action="all_responses"> Show all responses </div>');break}else{tc_next.slideDown();tc_next=tc_next.next();if(!is.numberOnly(tc_next.data("level"))){break}}response_cnt++}}else{event.publish("comment.togglereplies","Hide");t.attr("data-togglereplies","show");$(".show_all_responses").remove();
while(tc_next.data("level")!=tc_level){tc_next.slideUp();tc_next=tc_next.next();if(!is.numberOnly(tc_next.data("level"))){break}}}});$(tthis.config.wrapper).off("click",".loadmore");$(tthis.config.wrapper).on("click",".loadmore",function(){$(this).remove();if(tthis.config.loadonscroll==false){tthis.loadComment(tthis.config.commentType,function(data){},true,++tthis.pageCount)}});$(tthis.config.wrapper).off("keyup","[data-plugin='comment-input']");$(tthis.config.wrapper).on("keyup","[data-plugin='comment-input']",function(e){if(e.keyCode===27){var ref=ui.getActionReferences(this,tthis.config.comment);
ref["comment-input"].val("");ref["comment-reply"].hide()}});ui.maxlength("[data-plugin='comment-input']",tthis.config.maxchar,function(remainingChar,messageLength){var ref=ui.getActionReferences(this,tthis.config.comment);var parent=ref.parent;var charsrem=ref["comment-input-remaining"];charsrem.text(remainingChar>=0?remainingChar:0);if(tthis.config.messages.maxlength&&messageLength>tthis.config.maxchar){tthis.error(tthis.config.messages.maxlength,ref["comment-error"])}else{tthis.error("",ref["comment-error"])
}},tthis.config.wrapper);$(tthis.config.wrapper).off("click","[data-action='comment-close']");$(tthis.config.wrapper).on("click","[data-action='comment-close']",function(){var ref=ui.getActionReferences(this,tthis.config.comment);var reply=ref["comment-reply"];var input=ref["comment-input"];input.val("");reply.hide();tthis.error("",ref["comment-error"]);return false});tthis.onLoaded(function(tthis){tthis.updateCachedRating();if(tthis.followee){tthis.markFollowingAll()}else{mytimes.getFollowee(function(data){tthis.followee=data;
tthis.markFollowingAll()})}lazy.load();dynamic.uptime()});$(tthis.config.wrapper).off("click","[data-plugin='comment-user-follow']");$(tthis.config.wrapper).on("click","[data-plugin='comment-user-follow']",function(){var currentEle=$(this);var currentUser=login.getUser();var ref=ui.getActionReferences(this,tthis.config.comment);var userId=ref.parent.attr("data-userid");var userName=ref.parent.attr("data-user");if(currentUser&&currentUser.getId()!=userId){(function(userId,userName){mytimes.followUser(userId,function(dataa){tthis.followee=tthis.followee||[];
var currFollowee={_id:userId,F_N:userName};tthis.followee.push(currFollowee);tthis.markFollowingId(currFollowee)})}(userId,userName))}else{logger.warn("Cannot follow self.")}});$(tthis.config.wrapper).off("click","[data-plugin='comment-post'],[data-plugin='comment-facebook-post'],[data-plugin='comment-twitter-post'],[data-plugin='comment-google-post'],[data-plugin='comment-email-post']");$(tthis.config.wrapper).on("click","[data-plugin='comment-post'],[data-plugin='comment-facebook-post'],[data-plugin='comment-twitter-post'],[data-plugin='comment-google-post'],[data-plugin='comment-email-post']",function(){event.publish("comment.post.start");
var ref=ui.getActionReferences(this,tthis.config.comment);var parent=ref.parent;var reply=ref["comment-reply"];var errorElement=ref["comment-error"];var reply_input=ref["comment-input"];var parentid=parent.attr("data-id");var parentlevel=parent.attr("data-level");var rootid=parent.attr("data-id");var rootlevel=parent.attr("data-level");var preventInfinite=10;var prevParent=parent;while(rootlevel>1&&--preventInfinite>0){prevParent=prevParent.prev();if(prevParent.attr("data-plugin")==="comment"){rootid=prevParent.attr("data-id");
rootlevel=prevParent.attr("data-level")}else{break}}tthis.error("",errorElement);var val=(reply_input.val()===reply_input.attr("placeholder"))?"":reply_input.val().trim();if(val){tthis.add(val,parentid,rootid,rootlevel,function(commentObj,errMsg){tthis.renderComment(commentObj,errMsg);event.publish("comment.post.end")},false,this)}else{event.publish("comment_error",tthis.config.messages.blank);$(tthis.config.wrapper+" [data-plugin='comment-error']").text(tthis.config.messages.blank)}return false})
};times_comments.prototype.markFollowingAll=function(){var tthis=this;var followees=tthis.followee;var comments=$(tthis.config.wrapper);var user=login.getUser();if(user){logger.info("Showing follow links");comments.find("[data-plugin='comment-user-follow_wrapper']").show();comments.find("[data-plugin='comment'][data-userid ='"+user.getId()+"'] [data-plugin='comment-user-follow_wrapper']").hide();util.each(followees,function(i,followee){tthis.markFollowingId(followee)})}else{comments.find("[data-plugin='comment-user-follow_wrapper']").hide();
logger.info("Follow links : Not logged in.")}};times_comments.prototype.markFollowingId=function(followee){var tthis=this;var user=login.getUser();var comments=$(tthis.config.wrapper);if(user){var foloweeEle=comments.find("[data-userid='"+followee._id+"'] .follow");if(foloweeEle&&foloweeEle.length>0){logger.info("Mark Following : "+user.getFullName()+"("+user.getId()+") >> "+followee.F_N+"("+followee._id+")");tthis.markFollowing(foloweeEle)}else{logger.info("Mark Following : "+user.getFullName()+"("+user.getId()+") >> "+followee.F_N+"("+followee._id+")  - NA")
}}else{logger.info("Follow link : Not logged in.")}};times_comments.prototype.markFollowing=function(currentEle){if(currentEle&&currentEle.length>0){currentEle.html("<span class='divider'></span><i class='icon-follow'></i>Following");currentEle.removeClass("follow");currentEle.addClass("following");currentEle.removeAttr("data-plugin");currentEle.attr("title",currentEle.attr("title").replace("Follow","Following"))}};times_comments.prototype.onLoaded=function(callback){event.subscribe("comments.loaded",callback)
};var savedComment=null;times_comments.prototype.saveComment=function(comment){savedComment=comment;cookie.set("comment"+window.msid,json.stringify(comment),1,document.location.pathname)};times_comments.prototype.getSavedComment=function(){var commentCookie=cookie.get("comment"+window.msid);if(is.defined(commentCookie)){return json.parse(commentCookie)}else{if(savedComment){return savedComment}else{return null}}};times_comments.prototype.removeSavedComment=function(){savedComment=null;return cookie.remove("comment"+window.msid,document.location.pathname)
};times_comments.prototype.loadSavedComment=function(){var tthis=this;var user=login.getUser();var savedComment=tthis.getSavedComment();if(savedComment){if(user){if(!tthis.config.rating||savedComment.urs!=""){savedComment.urs=tthis.config.rating?$.trim(savedComment.urs):"";logger.log("Has saved comment and user is logged in.");logger.log(savedComment);tthis.attachUserToComment(savedComment,user);tthis.removeSavedComment();tthis.post(savedComment,function(savedComment,errMsg){tthis.renderComment(savedComment,errMsg)
})}}else{logger.log("Saved comment but user not logged in")}}else{logger.log("No Saved comment.")}};times_comments.prototype.verifyEmailComment=function(){var url_params=util.getParam();var tthis=this;tthis.verify(function(commentObj,errMsg){if(is.object(commentObj)){tthis.renderComment(commentObj,errMsg,true);$(tthis.config.wrapper+" [data-plugin='comment-verified-msg']").show();tthis.removeSavedComment()}})};times_comments.prototype.saveRatingValidation=function(opinionid,typeid,rateid,val,ref){logger.log("Save Rating: "+this.config.commentType+":"+opinionid);
var user=login.getUser();var userId=user?user.getId():0;var rating=["rateV",opinionid,typeid,rateid];localstoragec.set(rating.join(":"),val||"1",1,"/")};times_comments.prototype.getSavedRatingValidation=function(opinionid,typeid,rateid,ref){var user=login.getUser();var userId=user?user.getId():0;var rating=["rateV",opinionid,typeid,rateid];var commentCookie=localstoragec.csget(rating.join(":"));if(is.defined(commentCookie)){return commentCookie}else{return null}};times_comments.prototype.updateCachedRating=function(){var tthis=this;
var cookies=cookie.getAll();var comments=$(tthis.config.wrapper+" #"+this.config.commentType);util.each(cookies,function(key,value){if(key.indexOf("rateV")===0){logger.log("Updating Rating from cookie: "+key);var keyArr=key.split(":");var rating={opinionid:parseInt(keyArr[1],10),typeid:parseInt(keyArr[2],10),rateid:parseInt(keyArr[3],10),commentType:tthis.config.commentType};var eleType="";switch(rating.typeid){case CONSTANT.RATE_TYPE.AGREE:eleType="comment-agree-count";break;case CONSTANT.RATE_TYPE.DISAGREE:eleType="comment-disagree-count";
break}if(eleType!=""){var commentRateCount=comments.find("[data-id='"+rating.opinionid+"']  [data-plugin='"+eleType+"']");var val=parseInt(commentRateCount.text(),10);var cookieVal=parseInt(cookie.get(key),10);if(cookieVal>val){commentRateCount.text(cookieVal);logger.log("Updated Rating from cookie: "+key+" : "+val+" updated to "+cookieVal)}else{logger.log(key+" Already Updated")}}}})};times_comments.prototype.validateRating=function(opinionid,typeid,rateid,ref,callback){logger.log("Validate Rating: "+opinionid);
var config=this.config;var user=login.getUser();var savedRating=this.getSavedRatingValidation(opinionid,typeid,rateid,ref);if(ref){if(user&&ref.parent&&ref.parent.attr("data-userid")==user.getId()){switch(typeid){case CONSTANT.RATE_TYPE.AGREE:callback(config.messages.self_agree);break;case CONSTANT.RATE_TYPE.DISAGREE:callback(config.messages.self_disagree);break;case CONSTANT.RATE_TYPE.RECOMMEND:callback(config.messages.self_recommend);break;case CONSTANT.RATE_TYPE.OFFENSIVE:callback(config.messages.self_offensive);
break}}else{if(savedRating&&savedRating>0){switch(typeid){case CONSTANT.RATE_TYPE.AGREE:callback(config.messages.already_agree);break;case CONSTANT.RATE_TYPE.DISAGREE:callback(config.messages.already_disagree);break;case CONSTANT.RATE_TYPE.RECOMMEND:callback(config.messages.already_recommended);break;case CONSTANT.RATE_TYPE.OFFENSIVE:callback(config.messages.already_offensive);break}}else{if(this.getSavedRatingValidation(opinionid,CONSTANT.RATE_TYPE.AGREE,rateid,ref)&&typeid==CONSTANT.RATE_TYPE.DISAGREE){callback(config.messages.cant_agree_disagree)
}else{if(this.getSavedRatingValidation(opinionid,CONSTANT.RATE_TYPE.DISAGREE,rateid,ref)&&typeid==CONSTANT.RATE_TYPE.AGREE){callback(config.messages.cant_agree_disagree)}else{if(this.getSavedRatingValidation(opinionid,CONSTANT.RATE_TYPE.AGREE,rateid,ref)&&typeid==CONSTANT.RATE_TYPE.OFFENSIVE){callback(config.messages.cant_agree_offensive)}else{if(this.getSavedRatingValidation(opinionid,CONSTANT.RATE_TYPE.OFFENSIVE,rateid,ref)&&typeid==CONSTANT.RATE_TYPE.AGREE){callback(config.messages.cant_agree_offensive)
}else{if(this.getSavedRatingValidation(opinionid,CONSTANT.RATE_TYPE.DISAGREE,rateid,ref)&&typeid==CONSTANT.RATE_TYPE.RECOMMEND){callback(config.messages.cant_disagree_recommend)}else{if(this.getSavedRatingValidation(opinionid,CONSTANT.RATE_TYPE.RECOMMEND,rateid,ref)&&typeid==CONSTANT.RATE_TYPE.DISAGREE){callback(config.messages.cant_disagree_recommend)}else{if(this.getSavedRatingValidation(opinionid,CONSTANT.RATE_TYPE.OFFENSIVE,rateid,ref)&&typeid==CONSTANT.RATE_TYPE.RECOMMEND){callback(config.messages.cant_recommend_offensive)
}else{if(this.getSavedRatingValidation(opinionid,CONSTANT.RATE_TYPE.RECOMMEND,rateid,ref)&&typeid==CONSTANT.RATE_TYPE.OFFENSIVE){callback(config.messages.cant_recommend_offensive)}else{callback()}}}}}}}}}}}else{logger.error("Cannot validate rating. 'ref' is undefined.")}};times_comments.prototype.validateComment=function(commentObj,callback,ref){event.publish("comment.post.validating");var comment=commentObj.comment;var config=this.config;logger.info("Validating Comment: "+comment);commentObj.urs=(commentObj.urs==="")?undefined:commentObj.urs;
if(is.empty(comment)){callback(config.messages.blank)}else{if(is.url(comment)){callback(config.messages.has_url)}else{if(comment.length<config.validation.minlength){callback(config.messages.minlength)}else{if(is.defined(this.config.rating)&&this.config.rating&&(!is.defined(commentObj.urs))){callback(config.messages.ratemendate)}else{var msgObj=this.commentObjToMsgObj(commentObj);msgObj.message=msgObj.message.toLowerCase();api.validateComment(msgObj,function(response){if(response==="duplicatecontent"){event.publish("comment.post.validation.failed",response);
callback(config.messages.duplicate)}else{if(response==="abusivecontent"){event.publish("comment.post.validation.failed",response);callback(config.messages.abusive)}else{event.publish("comment.post.validated");callback()}}})}}}}};times_comments.prototype.add=function(msg,parentId,rootId,level,callback,cnsl,currentEle){logger.info("Adding Comment: "+msg);var tthis=this;$(tthis.config.wrapper+" [data-plugin='comment-verified-msg']").hide();var config=this.getConfig();var user=login.getUser();var ref=ui.getActionReferences(currentEle,tthis.config.comment);
var commentObj={index:-1,id:-1,comment:msg.trim(),level:level||1,parentId:parentId||0,rootId:rootId||0,parentuid:ref.parent?ref.parent.attr("data-id"):null,parentusername:ref.parent?ref.parent.attr("data-user"):null,type:currentEle?$(currentEle).attr("data-plugin"):"comment-post",time:new Date().getTime(),configid:"41083278",url:window.location.href.split("?")[0].split("#")[0],rotype:typeof tthis.config.rotype=="undefined"?0:tthis.config.rotype,urs:typeof userInfo==="object"?userInfo.userRating:""};
var facebookCheckbox=ref["comment-facebook"];var twitterCheckbox=ref["comment-twitter"];commentObj.social=[];if(facebookCheckbox&&facebookCheckbox.is(":checked")){commentObj.social.push("facebook")}if(twitterCheckbox&&twitterCheckbox.is(":checked")){commentObj.social.push("twitter")}if(!user){var cmtUser=(commentObj.type=="comment-post"?this.getCommentUser(ref):null);if(is.object(cmtUser)){user=cmtUser}else{if(cmtUser){return}}}if(user){tthis.attachUserToComment(commentObj,user);if(cnsl===true){if(callback){callback(commentObj)
}}else{tthis.post(commentObj,callback)}}else{switch(commentObj.type){case"comment-facebook-post":tthis.commentOnFacebook(commentObj,ref);break;case"comment-google-post":tthis.commentOnGoogle(commentObj,ref);break;case"comment-twitter-post":tthis.commentOnTwitter(commentObj,ref);break;case"comment-email-post":tthis.commentUsingEmail(commentObj,ref);break;default:tthis.commentWithoutLogin(commentObj,ref);break}}};times_comments.prototype.getCommentUser=function(ref){var config=this.config;var $get_user_name=ref["get-user-name"];
var $get_user_email=ref["get-user-email"];var $get_user_location=ref["get-user-location"];var $set_user_captcha=ref["set-user-captcha"];var $get_user_captcha=ref["get-user-captcha"];if($get_user_name&&$get_user_email&&$get_user_name.length>0&&$get_user_email.length>0){var user={};user.name=$get_user_name.val().trim();user.email=$get_user_email.val().trim();if($get_user_location&&$get_user_location.length>0){user.location=$get_user_location.val().trim()}if(user.name.length==0||user.name==$get_user_name.attr("placeholder")){this.error(config.messages.name_required,ref["comment-error"]);
return true}if(user.name.length>30){this.error(config.messages.name_toolong,ref["comment-error"]);return true}if(!is.alphaOnly(user.name)){this.error(config.messages.name_not_string,ref["comment-error"]);return true}if(user.email.trim().length==0||user.email==$get_user_email.attr("placeholder")){this.error(config.messages.email_required,ref["comment-error"]);return true}if(!is.email(user.email.trim())){this.error(config.messages.email_invalid,ref["comment-error"]);return true}if($get_user_location&&$get_user_location.length>0){if(user.location.length==0||user.location==$get_user_location.attr("placeholder")){this.error(config.messages.location_required,ref["comment-error"]);
return true}if(user.location.length>30){this.error(config.messages.location_toolong,ref["comment-error"]);return true}if(!is.alphaOnly(user.location)){this.error(config.messages.location_not_string,ref["comment-error"]);return true}}if($get_user_captcha&&$get_user_captcha.val().trim().length==0){this.error(config.messages.captcha_required,ref["comment-error"]);return true}if($get_user_captcha&&$get_user_captcha.val().trim().length>4){this.error(config.messages.captcha_toolong,ref["comment-error"]);
return true}if($get_user_captcha&&!is.numberOnly($get_user_captcha.val().trim())){this.error(config.messages.captcha_number_only,ref["comment-error"]);return true}if($set_user_captcha&&$get_user_captcha&&!eval($set_user_captcha.text()+"="+$get_user_captcha.val())){this.error(config.messages.captcha_invalid,ref["comment-error"]);return true}return userClass.getNewUser(user,{id:"id",username:"username",thumb:"thumb",email:"email",name:"name",fullName:"name",CITY:"location"})}};times_comments.prototype.commentOnFacebook=function(commentObj,ref){var tthis=this;
var domainOnly=util.getDomainOnly();tthis.saveComment(commentObj);cookie.set("clickkepfbtart","1",1,"/",domainOnly);cookie.set("clickkepfbtart"+window.msid,window.msid,1,"/",domainOnly);login.loginWithFacebook(function(){tthis.loadSavedComment()})};times_comments.prototype.commentOnGoogle=function(commentObj,ref){var tthis=this;tthis.saveComment(commentObj);login.loginWithGoogle(function(){tthis.loadSavedComment()})};times_comments.prototype.commentOnTwitter=function(commentObj,ref){var tthis=this;
var domainOnly=util.getDomainOnly();tthis.saveComment(commentObj);cookie.set("clickkeptwtart","1",1,"/",domainOnly);cookie.set("clickkeptwtart"+window.msid,window.msid,1,"/",domainOnly);login.loginWithTwitter(function(){tthis.loadSavedComment()})};times_comments.prototype.commentUsingEmail=function(commentObj,ref){var tthis=this;var domainOnly=util.getDomainOnly();tthis.saveComment(commentObj);cookie.set("clickkepssoart","1",1,"/",domainOnly);cookie.set("clickkepssoart"+window.msid,window.msid,1,"/",domainOnly);
login.login(function(){tthis.loadSavedComment()})};times_comments.prototype.commentWithoutLogin=function(commentObj,ref){var tthis=this;var domainOnly=util.getDomainOnly();tthis.saveComment(commentObj);cookie.set("clickkepssoart","1",1,"/",domainOnly);cookie.set("clickkepssoart"+window.msid,window.msid,1,"/",domainOnly);login.login(function(){if(!(tthis.config.rating)){tthis.loadSavedComment()}})};times_comments.prototype.verify=function(callback,ref){var tthis=this;var url=tthis.config.verify_comment_url;
var msgObj={msid:window.msid,cmtid:null,r:null};var url_params=util.getParam();if(window.messageid&&window.param_r){msgObj.cmtid=window.messageid;msgObj.r=window.param_r}else{msgObj.cmtid=url_params.messageid;msgObj.r=url_params.r}if(msgObj.msid&&msgObj.cmtid&&msgObj.r){logger.info("Verifying Comment.");ajax.get(url,msgObj,function(response){if(response.cmtverified.commentbyid&&response.cmtverified.commentbyid.roaltdetails){var cmt=response.cmtverified.commentbyid;cmt.roaltdetails=cmt.roaltdetails.roaltdetails;
var commentObj={index:-1,id:-1,comment:is.string(cmt.message)?$("<div/>").text(cmt.message).html():"",level:1,parentuid:cmt.parentuid,parentusername:cmt.parentusername,abstime:msgObj.r?util.getDate(msgObj.r).getTime():"",time:msgObj.r,type:"comment-post",user:{name:cmt.roaltdetails.fromname,location:cmt.roaltdetails.location}};if(callback){callback(commentObj)}}else{if(callback){callback(null,{})}}})}if(url_params.register==="1"){logger.info("Display register window.");if(!login.getUser()){login.login()
}}};times_comments.prototype.post=function(commentObj,callback,ref){var tthis=this;if(!is.empty(commentObj.social)){if(is.defined(tthis.config.rating)&&tthis.config.rating){if(is.defined(tthis.config.moviename)&&tthis.config.moviename){var socialtext="Movie: "+tthis.config.moviename+", My Rating "+(commentObj.urs/2)+"/5. "+commentObj.comment;tthis.postToSocial(socialtext,commentObj.social.join(","))}else{if(is.defined(tthis.config.techprdtname)&&tthis.config.techprdtname){var socialtext=tthis.config.techprdtname+" : My Rating "+(commentObj.urs/2)+"/5, "+commentObj.comment;
tthis.postToSocial(socialtext,commentObj.social.join(","))}}}else{tthis.postToSocial(commentObj.comment,commentObj.social.join(","))}}tthis.validateComment(commentObj,function(error){if(!is.empty(error)){if(callback){callback(commentObj,error)}return}event.publish("comment.post.posting");logger.info("Posting Comment:"+commentObj.comment);var msgObj=tthis.commentObjToMsgObj(commentObj);msgObj.pcode=page.getChannel();if(tthis.config.sendCommentLiveEmail===false){msgObj.verifyuser=1;api.postCommentWithoutVerification(msgObj,function(response){event.publish("comment.post.posted");
if(callback){callback(commentObj)}})}else{if(tthis.config.enableparam&&msgObj.rotype!=0){msgObj.url=msgObj.url+"?"+window.location.search.replace("?","").split("&")[0]+"&";msgObj.configid="46516605"}else{if(msgObj.rotype!=0){msgObj.url=msgObj.url+"?"}}api.postComment(msgObj,function(response){event.publish("comment.post.posted");if(callback){callback(commentObj)}})}},ref)};times_comments.prototype.commentObjToMsgObj=function(commentObj){var config=this.config;var msgObj={fromname:commentObj.user?commentObj.user.name:null,fromaddress:commentObj.user?commentObj.user.email:null,userid:commentObj.user?(commentObj.user.id?commentObj.user.uid:"qrst"):"qrst",location:commentObj.user?commentObj.user.location:null,imageurl:commentObj.user?commentObj.user.image:null,loggedstatus:commentObj.user&&commentObj.user.id?1:0,message:commentObj.comment,roaltdetails:1,ArticleID:config.msid,msid:config.msid,parentid:commentObj.parentId,rootid:commentObj.rootId,url:commentObj.url,configid:commentObj.configid,urs:commentObj.urs?commentObj.urs:null,rotype:commentObj.rotype};
if(!commentObj.user.id){msgObj.verifyuser=1}return msgObj};times_comments.prototype.error=function(errMsg,wrapper){if(is.visible(wrapper)){wrapper.text(errMsg)}else{if(!is.empty(errMsg)){alert(errMsg)}}event.publish("comment_error",errMsg)};times_comments.prototype.rateAgree=times_comments.prototype.rateUpVote=function(opinionid,callback,ref){logger.log("Agree Comment: "+opinionid);this.rate(opinionid,CONSTANT.RATE_TYPE.AGREE,0,callback,ref)};times_comments.prototype.rateDisagree=times_comments.prototype.rateDownVote=function(opinionid,callback,ref){logger.log("Disagree Comment: "+opinionid);
this.rate(opinionid,CONSTANT.RATE_TYPE.DISAGREE,0,callback,ref)};times_comments.prototype.rateRecommend=function(opinionid,callback,ref){logger.log("Recommend Comment: "+opinionid);this.rate(opinionid,CONSTANT.RATE_TYPE.RECOMMEND,0,callback,ref)};times_comments.prototype.flag=times_comments.prototype.rateOffensive=function(opinionid,callback,ref,reason){var tthis=this;logger.log("Flag/Offensive Comment: "+opinionid);$(ref.offensive_popup).off("click");$(ref.offensive_popup).on("click",function(){var ref=ui.getActionReferences(this,tthis.config.comment);
var valReason=ref.offensive_popup.find("input:checked").val();if(valReason&&valReason.length>0&&valReason=="Others"){ref.offensive_popup_reason.show()}else{ref.offensive_popup_reason.hide()}tthis.error("",ref["comment-offensive-error"])});event.publish("comment.flag.show",ref.offensive_popup);var elemTop=$(ref.offensive_popup).closest(".comment-box").position().top+$(ref.offensive_popup).closest(".comment-box").closest(".comment-box").height(),elemH=$(ref.offensive_popup).height(),wH=$(window).height(),commentScrollPos=0;
$(ref.offensive_popup).removeClass("popup_above");if(((elemTop-commentScrollPos)+elemH)>wH){$(ref.offensive_popup).addClass("popup_above")}ref.offensive_popup.show();return};times_comments.prototype.showRateOffensiveBox=function(opinionid,callback,ref){};times_comments.prototype.rate=function(opinionid,typeid,rateid,callback,ref,reason){logger.log("Rate Comment: "+opinionid+":"+typeid);var tthis=this;var rating={opinionid:opinionid,typeid:typeid,rateid:rateid||0};if(reason){rating.ofreason=reason
}var user=login.getUser();if(user){logger.log("Rate Comment user is logged in");this.validateRating(opinionid,typeid,rateid,ref,function(error){if(!is.empty(error)){if(callback){callback(error)}return}var val=parseInt(ref["comment-agree-count"].text(),10);tthis.saveRatingValidation(opinionid,typeid,rateid,val+1,ref);api.rateComment(rating,function(resp){if(callback){callback(null,resp)}},user)})}else{logger.log("Rate Comment user is NOT logged in, login prompted.");(function(rating,callback,ref){if(tthis.config.loginRequiredForRating===true){login.login(function(){logger.log("Rate Comment user logged in, continue rating.");
tthis.rate(rating.opinionid,rating.typeid,rating.rateid,callback,ref,rating.reason)},true)}else{logger.log("Rate Comment user NOT logged in, continue rating.");tthis.validateRating(rating.opinionid,rating.typeid,rating.rateid,ref,function(error){if(!is.empty(error)){if(callback){callback(error)}return}var val=parseInt(ref["comment-agree-count"].text(),10);tthis.saveRatingValidation(rating.opinionid,rating.typeid,rating.rateid,val+1,ref);api.rateComment(rating,function(resp){if(callback){callback(null,resp)
}})})}}(rating,callback,ref))}};times_comments.prototype.renderComment=function(commentObj,errMsg,verified){var tthis=this;if(commentObj){var ref=ui.getActionReferences(tthis.config.wrapper+" [data-id='"+commentObj.parentId+"']");var parent=ref.parent;var input=ref["comment-input"];var facebookCheckbox=ref["comment-facebook"];var twitterCheckbox=ref["comment-twitter"];if(errMsg){event.publish("comment.post.error",errMsg);this.error(errMsg,ref["comment-error"])}else{event.publish("comment.post.rendering");
commentObj.comment=$("<div/>").text(commentObj.comment).html();commentObj.user.rate=commentObj.urs;if($(tthis.config.wrapper+" .comment-verification-msg").length){$(tthis.config.wrapper+" .comment-verification-msg").remove()}if(this.isReply(commentObj)){var reply=ref["comment-reply"];if(!is.number(commentObj.level)){commentObj.level=parseInt(commentObj.level,10)}++commentObj.level;if((commentObj&&commentObj.user&&commentObj.user.id)||!ref["set-user-captcha"]){parent.after(this.renderEach(-1,commentObj,true));
reply.hide()}else{parent.after("<div class='comment-box highlight comment-verification-msg'>"+$(tthis.config.wrapper+" [data-plugin='comment-verification-msg']").html()+"</div>");reply.hide()}}else{if((commentObj&&commentObj.user&&commentObj.user.id)||verified==true||!ref["set-user-captcha"]){$(tthis.config.wrapper+" "+this.config.main).prepend(this.renderEach(-1,commentObj,true))}else{$(tthis.config.wrapper+" "+this.config.main).prepend("<div class='comment-box highlight comment-verification-msg'>"+$(tthis.config.wrapper+" [data-plugin='comment-verification-msg']").html()+"</div>")
}}if(input){input.val("");input.keyup();input.focus();if(facebookCheckbox){facebookCheckbox.prop("checked",false)}if(twitterCheckbox){twitterCheckbox.prop("checked",false)}var $get_user_captcha=ref["get-user-captcha"];var $set_user_captcha=ref["set-user-captcha"];if($get_user_captcha){$get_user_captcha.val("")}if($set_user_captcha){$set_user_captcha.text(Math.floor((Math.random()*10))+"+"+Math.floor((Math.random()*10))+"=")}}this.error("",ref["comment-error"])}lazy.load()}else{this.error(errMsg)}};
times_comments.prototype.renderUsingTemplate=function(index,dataOne,tmpl,prepend){return $("#"+tmpl).render(dataOne,{formatNumber:function(val){return util.formatNumber(val)},timeToDate:function(time){return new Date(time)},parseDate:function(time){if(jsonDate!=null){var date=new Date(time);var newDate=$.fullCalendar.formatDate(date,"MMM dd, yyyy");return newDate}}})};times_comments.prototype.isReply=function(cmt){return cmt.parentuid&&cmt.parentusername};times_comments.prototype.loadingDiv=function(text){var tthis=this;
if(text==="Loading..."){$(tthis.config.wrapper+" [data-plugin='comment-loading']").show()}else{$(tthis.config.wrapper+" [data-plugin='comment-loading']").hide()}};return times_comments});define("comments",["tiljs/apps/times/comments","tiljs/login","tiljs/logger","tiljs/event","jquery","tiljs/util","module","tiljs/cookie","tiljs/ui","jsrender"],function(h,k,l,a,f,g,c,b,j,i){var d=h;var e={validation:{minlength:1},messages:{name_required:"Please enter your name.",name_toolong:"Name cannot be longer than 30 chars.",email_required:"Please enter your email address.",email_invalid:"Please enter a valid email address.",minlength:"Whoops! Your review is too short. Please write a review which is at least 140 characters long so that it is helpful for others as well :)",maxlength:"You have entered more than 3000 characters.",blank:"You can't post this review as it is blank.",popup_blocked:"Popup is blocked.",has_url:"You can't post this review as it contains URL.",duplicate:"You can't post this review as it is identical to the previous one.",abusive:"You can't post this review as it contains inappropriate content.",self_agree:"You can't Agree with your own review",self_disagree:"You can't Disagree with your own review",self_recommend:"You can't Recommend your own review",self_offensive:"You can't mark your own review as Offensive",already_agree:"You have already Agreed with this review",already_disagree:"You have already Disagreed with this review",already_recommended:"You have already Recommended this review",already_offensive:"You have already marked this review Offensive",cant_agree_disagree:"You can't Agree and Disagree with the same review",cant_agree_offensive:"You can't Agree and mark the same review Offensive",cant_disagree_recommend:"You can't Disagree and Recommend the same review",cant_recommend_offensive:"You can't Recommend and mark the same review Offensive",permission_facebook:"You can't post to facebook. Post permission is required."}};
d.config=g.extend(true,{},h.config,e,c.config());return d});define("homepage",["tiljs/cookie","tiljs/load"],function(a,b){var c={};c.init=function(){};return c});define("crwdcnctrl",["tiljs/cookie","tiljs/event"],function(b,d){var e={};var a=function(j){var i=new Date(),g=new Date(j),h=i.getFullYear()-g.getFullYear();var f=i.getMonth()-g.getMonth();if(f<0||(f===0&&i.getDate()<g.getDate())){h--}return h};var c=function(){var f=b.get("MSCSAuthDetail");var g={};g.act=(typeof f!="undefined")?"TOI":"";
if(typeof f!="undefined"){g.dob=(f.match("DOB=(.*) ")!=null)?f.match("DOB=(.*) ")[1]:"";g.gender=(f.match("Gender=(.*)~Country")!=null)?f.match("Gender=(.*)~Country")[1]:""}g.age=(g.dob!="")?a(g.dob):"";return g};e.init=function(){var f=c();if(f.gender!=""||f.age!=""){if(typeof _cc2801!="undefined"){_cc2801.add("act",f.act);_cc2801.add("dem","toi.web:gender="+f.gender);_cc2801.add("dem","toi.web:age="+f.age);if(typeof _cc2801.bcp!="undefined"){_cc2801.bcp()}}}};e.init();d.subscribe(["user.login"],function(f){if(typeof e.init=="function"){e.init()
}})});define("tiljs/social/twitter",["../social/social","../ui","../logger","../event","../util","jquery","module"],function(b,k,l,a,i,h,c){var j=new b("twitter","twitter");var f={parse:false,js:"//platform.twitter.com/widgets.js",js_id:"twitter-wjs",share_url:"https://twitter.com/share",via:null,format:"{{:title}}",sharePageTitle:true};var d=i.extend(true,{},f,c.config());j.setJS(d.js,d.js_id);j.addPlugin({id:"button",js:true,init:function(r,p){var o=h(r);var q=i.data(r);var m={count:"vertical",url:location.href};
var t=i.extend(true,{},m,q);t.url=q.url||q.href||o.attr("href")||t.href;var n=h("<a class='twitter-share-button'></a>");h.each(t,function(u,v){n.attr("data-"+u,v)});o.empty();o.append(n);j.parse(r)}});j.addPlugin({id:"frame",js:true,init:function(q,o){var n=h(q);var p=i.data(q);var m={twtid:"",theme:"light"};var r=i.extend(true,{},m,p);var t="twt-"+r.twtid;if(window.twttr){twttr.widgets.createTweet(r.twtid,document.getElementById(t),{theme:r.theme})}}});j.addPlugin({id:"share",alias:["tweet"],events:{click:function(n){var m=i.data(this);
j.tweet(m.url||h(this).attr("href"),i.format(m.format||d.format,m),m.via||d.via,this)}},init:function(n,m){}});j.tweet=j.share=function(n,q,m,p){q=(typeof q=="string")?q.trim():q;var o={url:j.getAbsoluteUrl(n),text:q||(d.sharePageTitle===true?document.title.split("|")[0]:"")};if(m){o.via=m}j._share(d.share_url,o,{name:"twitter_tweet_dialog",width:500,height:400},p)};j.addPlugin({id:"follow",events:{click:function(m){j.follow(h(this).attr("data-url")||h(this).attr("href"))}},init:function(n,m){}});
j.follow=function(n,m){var o=j.getAbsoluteUrl(n);var p=window.open(n,"_blank");p.focus()};j.addPlugin({id:"login",init:function(n,m){}});var g=null;j.login=function(m,n){};j.addPlugin({id:"logout",init:function(n,m){}});j.parse=function(m){if(typeof twttr!=="undefined"){twttr.widgets.load(m)}else{l.warn("'twttr' is required in parse")}};j.logout=function(m){};j.beforeinit=function(){};j.beforeloadjs=function(){};j.afterloadjs=function(){if(typeof twttr!=="undefined"){l.log("twttr js loaded");var m=["click","tweet","retweet","follow","favorite"];
i.each(m,function(n,o){if(m.hasOwnProperty(o)){twttr.events.bind(o,function(p){return function(q){a.publish("twttr."+p,{intent_event:q})}}(o))}})}else{l.warn("'twttr' is required in afterloadjs")}};var e=null;j.getUser=function(m){};j.onlogin=function(m){};j.onlogout=function(m){};j.init(d);return j});define("tiljs/social/pinterest",["../social/social","../ui","../logger","../event","../util","../load","jquery","module"],function(b,i,k,a,g,j,f,c){var h=new b("pinterest","pinterest");var e={parse:false,js:"//assets.pinterest.com/js/pinit.js",js_id:"pinterest-js",share_url:"//www.pinterest.com/pin/create/button/"};
var d=g.extend(true,{},e,c.config());h.setJS(d.js,d.js_id);h.addPlugin({id:"button",init:function(q,o){var n=f(q);var p=g.data(q);var m={"pin-do":"buttonPin","pin-config":"above"};var t=g.extend(true,{},m,p);t.href=p.url||p.href||n.attr("href")||t.href;var r=f("<a></a>");var l={url:h.getAbsoluteUrl(t.href),media:h.getAbsoluteUrl(t.image),description:t.summary};r.attr("href","http://www.pinterest.com/pin/create/button/?"+f.param(l));f.each(t,function(u,v){r.attr("data-"+u,v)});n.empty();n.append(r);
h.parse(q)}});h.addPlugin({id:"share",alias:["pin"],events:{click:function(m){var l=g.data(this);h.share(l.url||f(this).attr("href"),l.title,l.summary,l.image,this)}},init:function(m,l){}});h.pin=h.share=function(m,p,l,o,n){h._share(d.share_url,{url:h.getAbsoluteUrl(m),description:p,summary:l,media:h.getAbsoluteUrl(o)},{name:"pinterest_pin_dialog",width:700,height:400},n)};h.addPlugin({id:"follow",events:{click:function(l){h.follow(f(this).attr("data-url")||f(this).attr("href"))}},init:function(m,l){}});
h.follow=function(m,l){var n=h.getAbsoluteUrl(m);var o=window.open(m,"_blank");o.focus()};h.parse=function(m){var l=f("#"+d.js_id);l.remove();j.js(d.js,null,d.js_id)};h.init(d);return h});define("tiljs/social/linkedin",["../social/social","../ui","../logger","../event","../util","jquery","module"],function(b,h,j,a,g,f,c){var i=new b("linkedin","linkedin");var e={parse:false,js:"//platform.linkedin.com/in.js",js_id:"linkedin-js",share_url:"http://www.linkedin.com/shareArticle"};var d=g.extend(true,{},e,c.config());
i.setJS(d.js,d.js_id);i.addPlugin({id:"button",js:true,init:function(o,m){var l=f(o);var n=g.data(o);var k={url:location.href,counter:"top"};var q=g.extend(true,{},k,n);q.url=n.url||n.href||l.attr("href")||q.href;var p=f("<script type='IN/Share'><\/script>");f.each(q,function(r,t){p.attr("data-"+r,t)});l.empty();l.append(p);i.parse(o)}});i.addPlugin({id:"share",events:{click:function(l){var k=g.data(this);i.share(k.url||f(this).attr("href"),k.title,k.summary,k.image,this)}},init:function(l,k){}});
i.share=function(l,o,k,n,m){i._share(d.share_url,{url:i.getAbsoluteUrl(l),title:o,summary:k},{name:"linkedin_share_dialog",width:500,height:570},m)};i.parse=function(k){if(typeof IN!=="undefined"){IN.parse(k)}else{j.warn("'IN' is required in parse")}};i.init(d);return i});define("tiljs/social/googleplus",["../social/social","../ui","../logger","module","../event","../util","jquery"],function(b,i,j,c,a,h,f){var e={parse:false,js:"https://apis.google.com/js/plusone.js?onload=attachgoogleevent",js_id:"googleplus-js",share_url:"https://plus.google.com/share"};
var d=h.extend(true,{},e,c.config());var g=new b("googleplus","googleplus");g.setJS(d.js,d.js_id);g.addPlugin({id:"button",js:true,init:function(o,m){var l=f(o);var n=h.data(o);var k={href:location.href,size:"tall",annotation:"bubble",width:null};var q=h.extend(true,{},k,n);q.href=n.url||n.href||l.attr("href")||q.href;var p=f("<div class='g-plusone'></div>");f.each(q,function(r,t){p.attr("data-"+r,t)});l.empty();l.append(p);g.parse(l[0])}});g.addPlugin({id:"share",events:{click:function(l){var k=h.data(this);
g.share(k.url||f(this).attr("href"),k.title,k.summary,k.image,this)}},config:{shareUrl:""},init:function(l,k){}});g.share=function(l,o,k,n,m){g._share(d.share_url,{url:g.getAbsoluteUrl(l)},{name:"googleplus_share_dialog",width:500,height:400,scrollbars:1},m)};g.addPlugin({id:"follow",events:{click:function(k){g.follow(f(this).attr("data-url")||f(this).attr("href"))}},init:function(l,k){}});g.follow=function(l,k){var m=g.getAbsoluteUrl(l);var n=window.open(l,"_blank");n.focus()};g.parse=function(k){if(typeof gapi!=="undefined"){gapi.plusone.go()
}else{j.warn("'gapi' is required in parse")}};g.init(d);return g});define("tiljs/plugin/pre_event",["../event","module","../util","../is"],function(e,c,a,d){var g={};var f={};var b=a.extend(true,{},f,c.config());g.init=function(){if(window.__times){g.process(window.__times)}else{window.__times=[]}window.__times.push=function(h){g.processOne(h);return Array.prototype.push.apply(this,arguments)}};g.process=function(h){a.each(h,function(j,i){g.processOne(i)})};g.processOne=function(h){try{if(d.funct(h)){h()
}else{if(d.array(h)){var i=h[0],l=h[1],k=h.splice(2);require(i)[l].apply(this,k)}else{e.publish("logger.warn","Invali params in __times")}}}catch(j){e.publish("logger.error",j)}};g.init();return g});define("pgtrack",[],function(){var a={};a.evtCap=function(b){try{if(window.event&&window.event.srcElement){var e=3,d=window.event.srcElement;while(e>0&&d!=document.querySelector("body")){if(d.getAttribute("pg")!=null){a.track(a.addUrl(d));break}e--;d=d.parentNode}}else{if(b&&b.stopPropagation&&!window.opera){if(b.target.getAttribute("pg")!=null){a.track(a.addUrl(b.target))
}}}}catch(c){}};a.addUrl=function(b){var c=b.getAttribute("pg");if(c&&c.indexOf("geturl")>-1){if(b.nodeName=="IMG"||b.nodeName=="SPAN"){b=b.parentElement}c=c.replace("geturl",b.getAttribute("href"))}return c};a.track=function(c){if(c!=null){var b=c.split("#");var e=null;if(c!=null){var d=c.indexOf("~"),g="action";if(d>-1){g=c.substr(d+1);c=c.substr(0,d)}var b=c.split("#"),f=b[0];if(toiprops._AB_version&&f!=="WEB-TOIFooter"){f=toiprops._AB_version}var e=null;if(b.length==1){e=ga("send","event",f,g)
}else{if(b.length==2||(b.length==3&&b[2]=="")){e=ga("send","event",f,g,b[1])}else{e=ga("send","event",f,g,b[1],b[2])}}}}};$(document).click(a.evtCap);return a});define("breakingnews",["jquery","tiljs/ajax","tiljs/load"],function(d,c,b){var a={};a.reloadtime=2000;a.breakingnews=function(){var e="https://toibnews.timesofindia.indiatimes.com/TOIBNews/breakingnews.html";if(document.location.host=="toidev.indiatimes.com"||document.location.host=="jcmsdev.indiatimes.com"){e="/home1_articlecount_test.cms"
}if(window.homeObj&&window.homeObj.breakingNewsPause==0){c.get(e,function(g){g=g.replace(/[\r\n]/g,"");if(!d.trim(g)){myMethod();a.reloadtime=180000;return true}var f=g.split(/[|]/g);d(".breaking-news .wrapper").html("");d(".breaking-news .wrapper").html("<ul id='js-news'/>");var j=0;var i=0,h=0;d.each(f,function(k,m){m='<li class="news-item">'+m+"</li>";d("#js-news").append(m);var l=d("#js-news li").eq(k).text().length;h+=l;if(l.length>90){i+=(l.length-90);j++}});myMethod(f.length,h,j,i)})}else{setTimeout(function(){a.breakingnews()
},a.reloadtime)}myMethod=function(h,i,g,f){if(h&&i){d(".breaking-news").show();if(d("#adsdivLyr").height()>0){d("#adsdivLyr").css("margin-top","10px")}if(d("#js-news").ticker()){d("#js-news").show()}if(h<2){d(".ticker-controls").hide()}if(!i){return true}a.reloadtime=h>1?h:2;i=h>1?i:i*2;var j=f*155;a.reloadtime=(h*6000)+a.reloadtime+j+(h*2500);a.reloadtime=a.reloadtime*5}else{d(".breaking-news").hide()}setTimeout(function(){a.breakingnews()},a.reloadtime)}};setTimeout(function(){if(d("#js-news").length>0){a.breakingnews()
}},8000);return a});define("global",[],function(){var a={};var b={};b.global=a;b.set=function(c,d){a[c]=d};b.get=function(c){return a[c]};return b});define("navsearchbox",["jquery"],function(b){if(b("#pageType").val()&&b("#pageType").val().indexOf("video")!=-1){return}var a={};a.toTitleCase=function(c){return c.replace(/\w\S*/g,function(d){return d.charAt(0).toUpperCase()+d.substr(1).toLowerCase()})};a.trimToWords=function(c,d){return c.split(" ").splice(0,d).join(" ").substring(0,120)};a.validateForm=function(){if(b("#query").val()==""){alert("Please enter text to search");
return false}else{var g=document.frmsearch1.query.value;var f=-1;f=document.frmsearch1.search1.value;var h=null;if(g==""){alert("Please enter text to search");document.frmsearch1.query.focus();return false}switch(f){case"0":var e=a.trimToWords(a.toTitleCase(g),10);h="https://timesofindia.indiatimes.com/topic/"+e.replace(/\s+/g,"-");break;case"1":h="http://search.indiatimes.com/websearch.cms";document.frmsearch1.type.value=1;break;case"2":h="http://search.indiatimes.com/websearch.cms";document.frmsearch1.type.value=0;
break;case"3":var e=a.toTitleCase(g);h="https://timesofindia.indiatimes.com/topic/"+e.replace(/\s+/g,"-")+"/videos";break;case"4":var e=a.toTitleCase(g);h="http://photogallery.indiatimes.com/resultsearch.cms?source=toisearch&q="+e.replace(/\s+/g,"-");document.frmsearch1.target="_blank";break;default:break}ga("send","event","WEB-HPV2","Nav-Bar-Search","Search_initiate-"+document.frmsearch1.query.value);window.location.href=h;return false}};b("[data-plugin='navsearchboxvalidate']").on("submit",a.validateForm);
(function(){window.navsearch={};var g,e,d,f,c;window.navsearch.handleAutoSearchResult=function(n){b("#nav_autosuggest_result").html("");if(n&&b.type(n)=="array"){var j=n[1].length;for(var k=0;k<j;k++){var m=n[1][k][0].replace(/\b[a-z]/g,function(i){return i.toUpperCase()});var o="",l="https://timesofindia.indiatimes.com/topic/"+m.replace(/\s+/g,"-");o='<li><a href="'+l+'" target="_blank">'+m+"</li>";b("#nav_autosuggest_result").append(o)}e=b("#nav_autosuggest_result li")}};var h=null;b("[data-plugin='navsearchboxvalidate'] #query").on("keyup","",function(j){g=j.keyCode;
var i=b(this).val().trim(),k=b("#nav_autosuggest_result");if(i&&!(g==40||g==38||g==27&&b("#nav_autosuggest_result").is(":visible"))){var m="https://suggestqueries.google.com/complete/search?client=youtube&jsonp=navsearch.handleAutoSearchResult&q="+i;if(h){h.abort()}h=b.ajax({type:"GET",dataType:"jsonp",url:m,success:function(n){}})}else{if(i){if(g==27){!(b("#main-nav").length)&&b("#nav_autosuggest_result").closest(".search-form").removeClass("hover")}else{if(g==40){!(b("#main-nav").length)&&b("#nav_autosuggest_result").closest(".search-form").addClass("hover");
if(!e.hasClass("selected")){e.first().addClass("selected");b("#query").val(e.first().find("a").text())}else{d=e.filter(".selected");var l;if(!d.length||d.is(":last-child")){l=e.eq(0)}else{l=d.next()}d.removeClass("selected");l.addClass("selected");b("#query").val(l.find("a").text())}}else{if(g==38){!(b("#main-nav").length)&&b("#nav_autosuggest_result").closest(".search-form").addClass("hover");if(!e.hasClass("selected")){e.first().addClass("selected");b("#query").val(e.first().find("a").text())}else{d=e.filter(".selected");
var l;if(!d.length||d.is(":first-child")){l=e.last()}else{l=d.prev()}d.removeClass("selected");l.addClass("selected");b("#query").val(l.find("a").text())}}}}}else{b("#nav_autosuggest_result").html("")}}})})();return a});define("navigation",["jquery","tiljs/ajax","global","tiljs/plugin/lazy","tiljs/is","tiljs/cookie","navsearchbox"],function(h,o,b,g,l,c,i){var q={func:{},getelem:{},ajax:{}};b.set("nav",q);(function(){var r=c.get("geolocation");var t=(window.getCityJSON&&getCityJSON[r]&&getCityJSON[r]["lang"])?getCityJSON[r]["lang"]:"hindi";
if(h("#nav-tv.category").length){o.get("/tvlistingdrop.cms?languagename="+t+"&type=default",function(u){h("#rnav45449811, #rnav41505232").remove();h("body").append(u)})}})();jQuery(document).ready(function(t){var u=c.get("cnt");function r(w){if(w=="UK"){var v="";if(t("#nav-amazon").length>0){v="/amazonuk.cms"}else{v="/amazon_drop.cms?geoid=5"}t.get(v,function(x){t("#nav-amazon").replaceWith(x);t("#amzn_domain").show();t("li[drop='amazon']").html(x)})}else{t("#amzn_domain").show()}}});function d(r){var t=h(r).closest("li").find(".list7 li:first").attr("id");
h("#rnav"+t).show()}function a(r){if(h(r).parent().attr("class").match(/current/)||h(r).parent().attr("class").match(/category/)){return true}q.id=h(r).parent().attr("id");q.extfile="";q.extfile=h(r).attr("data-external");q.name=q.id.substring(4);h(r).parent().find("li:first").addClass("active");d(r);if(q.id=="nav-home"&&h("#rnav-2128932452")){h(".rnavclass").hide();h("#rnav-2128932452").show();if(!q.ajax[q.id]&&h(r).hasClass("lnavdata")){h(".level-one .loader").show()}}if(!q.ajax[q.id]&&h(r).hasClass("lnavdata")){var t=function(y){var x=y;
if(typeof s!=="undefined"&&s==1){x=x+"&s="+s}if(x=="entertainment-tv"||x=="tv"){var w=c.get("geolocation");var v=(window.getCityJSON&&getCityJSON[w]&&getCityJSON[w]["lang"])?getCityJSON[w]["lang"]:"hindi";o.get("/tvlistingdrop.cms?languagename="+v,function(z){h("#rhsnav"+y).append(z)})}if(x.match(/movie-reviews/g)){o.get("/nav_moviereview.cms?mvlang="+x,function(z){h("#rhsnav"+y).html(z)})}q.ajax["nav-"+y]=1;var u=(q.extfile)?q.extfile:"/homeajax.cms?nav="+x;h.ajax({url:u}).done(function(A){h("#rhsnav"+y).append(A);
var z=h("#rhsnav"+y).siblings(".left-column").find(".list7 li:first").attr("id");z=z&&z.indexOf("lnav")>-1?z.replace("lnav",""):z;h("#rnav"+z).show();h(".level-one .loader").hide();q.ajax["nav-"+y]=1;h("#rnavtravel").html();h("#rnavtravel").html(h("#rnav22806450").html());h("#rnav22806450").hide();if(q.id=="nav-home"&&h("#rnav-2128932452")){h(".rnavclass").hide();h("#rnav-2128932452").show()}g.load()}).fail(function(){q.ajax["nav-"+y]=0})};t(q.name)}if(!q.getelem[q.id]&&h("#rnav"+q.name).length){var t=function(u){$span=h("#rnav"+u).clone();
h("#rnav"+u).remove();h("#nav-"+u+" #rhsnav"+u).append($span);h("#rnav"+u).show()};t(q.name);q.getelem[q.id]=1}if(!q.timeoutId){q.timeoutId=window.setTimeout(function(){q.timeoutId=null;h(".level-one .hover").removeClass("hover");h("#rnav"+q.name).show();h("#"+q.id).addClass("hover");h("#rnav22806450").hide();g.load()},300)}}function k(){if(q.timeoutId){window.clearTimeout(q.timeoutId);q.timeoutId=null}else{h(".dropdown, .all-sections").mouseleave(function(){h(".level-one .hover").removeClass("hover");
h(".list7 li.active").removeClass("active");h(".rnavclass").hide()})}}h("#header, #trending, #content, .article-content-wrapper, .breaking-news").hover(function(){h(".level-one .hover").removeClass("hover");h(".search-form.hover").removeClass("hover");h(".rnavclass").hide()});h(".search-form").hover(function(){h(".level-one li").removeClass("hover")});h("#navigation").on("mouseenter",".navquery",function(){a(this)}).on("mouseleave",".navquery",function(){k(this)});h(".navquery").on("click",function(t){if(l.touch()){var r=window.curNav;
window.curNav=h(this).attr("pg");if(typeof r==="undefined"||r!==window.curNav){a(this);return false}}return true});h(document).on("click"),function(){if(l.touch()&&window.curNav!==null){window.curNav=null;k(this)}};function f(r){var u=h(r).attr("id");u=u.replace(/lnav/g,"");if(q.ajax[h(r).parents(".hover").attr("id")]!=1||h("#rnav"+u).length==0){q.activeTab=r;h(r).parents(".two-column-layout").find(".loader").show();h(".rnavclass").hide();return false}h(r).parents(".two-column-layout").find(".loader").hide();
h(".rnavclass").hide();h(".level-one .active").removeClass("active");h(r).addClass("active");var t=h(r).parents("ul.level-one li");if(t.length==0){t=h(r).parents(".two-column-layout")}t.find("#rnav"+u).show();h("#rnav22806450").hide();g.load()}h(".lnavclass").mouseover(function(){f(this)});h(".lnavclass a").click(function(){if(l.touch()){var r=window.curNav2;window.curNav2=h(this).attr("pg");if(typeof r==="undefined"||r!==window.curNav2){f(this);return false}}return true});h(".latestwidget").click(function(){q.id=h(this).attr("id");
url="";loop=0;if(q.id=="latest"&&!q[q.id]){url="/mostread_blockibeat.cms?tabname=mostread"}else{if(q.id=="mostcommented"&&!q[q.id]){url="/mostcommented_block.cms?tabname=mostcomm"}else{if(q.id=="mostshared"&&!q[q.id]){url="/mostshared_blocknew.cms?tabname=mostshared&top=5&tabname=mostshared";loop++}}}if(url!=""){p(url,loop)}h(".latestwidget").removeClass("active");h(this).addClass("active");h(".tabcontent").hide();h("."+q.id).show()});h(document).ready(function(){if(h(".mostshared ol li").length<=3){h("#mostshared").trigger("click")
}});function p(t,r){r++;if(r>1){t=t+"&version=1"}o.get(t,function(u){if(h(u).find("ul li").length<=3&&r<2){p(t,r)}else{h("."+q.id+" ol").html(u);q[q.id]=1;h("span.number").show()}})}h(".shopWidget").click(function(){q.id=h(this).attr("id");h(".shopWidget").removeClass("active");h(this).addClass("active");h(".tabcontent").hide();h("."+q.id).show();g.load()});setTimeout(function(){h("span.number").show()},500);var m=0,n="upwards";if(typeof(disabledStickyNav)==="undefined"){q.stickyTop=h("#navigation").offset()?h("#navigation").offset().top:0;
h(window).scroll(function(){q.windowTop=h(window).scrollTop();if(q.windowTop>q.stickyTop){h("#navigation").addClass("sticky")}else{h("#navigation").removeClass("sticky")}var r=h(this).scrollTop();if(r>m){n="downwards";h("body").removeClass("scroll-up").addClass("scroll-down")}else{n="upwards";h("body").addClass("scroll-up").removeClass("scroll-down")}m=r})}function e(){var r=null;return function(){if(h(window).width()<=999){if(!h("#navigation ul.level-one").hasClass("ipadflow")){h("#navigation ul.level-one").addClass("ipadflow");
if(h("#navigation ul.level-one li.nav-ipad .drpdwn-nav-ipad li").length<1){var t=h('#navigation .level-one>li:visible:gt(8):not(".nav-home"):not(".nav-amazon"):not(".nav-ipad")').clone();r=h('#navigation .level-one>li:visible:gt(8):not(".nav-home"):not(".nav-amazon"):not(".nav-ipad")');h("#navigation ul.level-one li.nav-ipad").append('<ul class="drpdwn-nav-ipad"></ul>');t.find("div.dropdown").remove();h("#navigation ul.level-one li.nav-ipad .drpdwn-nav-ipad").append(t);h("#navigation ul.level-one li.nav-ipad .drpdwn-nav-ipad").css("background",h("#navigation").css("background-color"));
h("#navigation ul.level-one").addClass("nooverflow")}r.hide()}}else{if(r!=null){r.show();h("#navigation ul.level-one").removeClass("ipadflow")}}}}var j=e();h(window).resize(function(){j()});h(document).ready(function(){if(!h("#pageType").val()||(h("#pageType").val()&&h("#pageType").val().indexOf("video")==-1)){h(".search-form").click(function(){h(".hover").removeClass("hover");h(this).addClass("hover");h("#nav_autosuggest_result").html("");h("#query").removeAttr("disabled");h("#query").focus()})}j()
});return{}});define("compatibility_toi",[],function(){return{}});define("ajax",["tiljs/ajax"],function(a){return a});define("event",["tiljs/event"],function(a){return a});define("localstorage",["tiljs/localstorage"],function(a){return a});define("preload",[],function(){});define("util",["tiljs/util"],function(a){return a});define("is",["tiljs/is"],function(a){return a});define("ui",["tiljs/ui"],function(a){return a});define("cookie",["tiljs/cookie"],function(a){return a});define("event",["tiljs/event"],function(a){return a
});define("plugin/lazy",["tiljs/plugin/lazy"],function(a){return a});define("load",["tiljs/load"],function(a){return a});define("toicommonjs/rodate",["rodate"],function(a){return a});define("logger",["tiljs/logger"],function(a){return a});define("page",["tiljs/page"],function(a){return a});define("user",["tiljs/user"],function(a){return a});define("times/comments",["comments"],function(a){return a});define("authorcomments",["tiljs/apps/times/authorcomments"],function(a){return a});define("tiljs/apps/times/authorcomments",["jquery","event","plugin/lazy"],function(d,c,b){var a={};
a.run=function(){c.subscribe("comments.loaded",function(k){var e=d(k.config.main);if(!d("#"+d(e).attr("id")+' [id="authComment"]').length){var f=k.flagData?k.flagData.authorsComment:null;if(f){var h=[];for(var g=0;g<f.length;g++){k.parseComment(f[g],h)}var j;j="<div id='authComment' style='border:1px solid #ccc;margin-bottom:10px;'><div class='authorTxt'>Author's Comment</div>";for(var g=0;g<h.length;g++){j=j+k.renderEach(g,h[g])}j=j+"</div>";e.prepend(j);b.load();d("#authComment .authorTxt:not(:first-child)").remove()
}}})};return a});define("nlwidget",[],function(){var a={};a.run=function(){if($('[data-id="newsletterWidgetDisplay"]').length){$.ajax({url:"/newnlwidget.cms?ver=1",cache:true,dataType:"html",success:function(b){$('[data-id="newsletterWidgetDisplay"]').html(b);var c=document.createElement("script");c.setAttribute("type","text/javascript");c.setAttribute("src","/newsletterwidget_js/version-21,minify-1.cms");document.getElementsByTagName("head")[0].appendChild(c)},error:function(b,d,c){if(window.console&&console.log){console.log(c)
}}})}};return a});define("toinotification",["tiljs/cookie"],function(e){var b={},d=5,f=(location.host==="timesofindia.indiatimes.com")?"https://timesofindianotifications.indiatimes.com/toinotification/gcm.htm":"https://testnotification.indiatimes.com/sites/toi/testgcm.htm",c=["toierrorfound.cms"],g='<div class="ntfc_overlay"></div><div class="ntfc_popup"> <div class="ntfc_logo"> <img src="/photo/54312174.cms" /> </div> <div class="ntfc_content"> <h4>The latest news and updates...</h4> <p>Get instant notifications as they happen</p> <span class="ntfc_buttongroup"> <a href="#" class="ntfc_dactive" data-plugin="ntfc-close">Not Now</a> <a href="#" class="ntfc_active" data-plugin="ntfc-enable">Enable</a> </span> <p class="tnc">You can manage them anytime using browser settings</p> </div> </div>';
b.isChrome=function(){return/Chrome/i.test(navigator.userAgent)&&!/OPR/i.test(navigator.userAgent)};b.isMozilla=function(){return/firefox/i.test(navigator.userAgent)};b.isSafari=function(){return(/^((?!chrome|android).)*safari/i.test(navigator.userAgent))};b.close=function(){$(".ntfc_overlay").remove();$(".ntfc_popup").remove();e.set("_tointfcskip","true",d,"/",".indiatimes.com",false)};b.allow=function(){$(".ntfc_overlay").remove();$(".ntfc_popup").remove();e.set("_tointfcproceed","true",d,"/",".indiatimes.com",false)
};b.triggerGAEvent=function(i,j,h){if(typeof ga!="undefined"){ga("send","event",i,j,h)}};b.getBrowser=function(){if(b.isChrome()){return"chrome"}else{if(b.isMozilla()){return"mozilla"}else{if(b.isSafari()){return"safari"}}}return""};b.events=function(){$(".ntfc_popup").on("click",'[data-plugin="ntfc-close"]',function(){b.triggerGAEvent("Browser Notification","Not_Now_Web",b.getBrowser());b.close();return false});$(".ntfc_popup").on("click",'[data-plugin="ntfc-enable"]',function(){b.triggerGAEvent("Browser Notification","Enable_Web",b.getBrowser());
b.allow();setTimeout(function(){window.location.href=f},200);return false})};b.init=function(){$("body").append(g);b.events()};b.isBlocked=function(){for(idx=0;idx<c.length;idx++){if(window.location.href.indexOf(c[idx])!=-1){return true}}return false};b.valid=function(){if((b.isChrome()||b.isMozilla()||b.isSafari())&&!e.get("_tointfcproceed")&&!e.get("_tointfcskip")&&!e.get("_tointfcblock")&&!e.get("_tointfcallow")){return true}return false};if(b.isChrome()){var a=window.RequestFileSystem||window.webkitRequestFileSystem;
if(!!a){a(window.TEMPORARY,100,function(h){if(b.valid()&&!b.isBlocked()&&("serviceWorker" in navigator)){b.init()}},function(h){})}}else{if(b.isMozilla()&&b.valid()&&!b.isBlocked()&&("serviceWorker" in navigator)){b.init()}else{if(b.isSafari()&&b.valid()&&!b.isBlocked()&&("safari" in window)&&("pushNotification" in window.safari)&&localStorage.length){b.init()}}}});define("tpwidget",["event","tiljs/cookie"],function(c,a){var b={};b.init=function(){b.subscribeLoggedInStatus();b.bindEvents()},b.data={widgettypes:["widget-head","widget-two"],"widget-head":"tpwidget-one","widget-two":"tpwidget-two",widgetsArray:[],isUserLoggedIn:false,isInitialised:false,userInfo:[],uemail:"",url:escape(document.location.href),pcode:"TOI",scode:"News",oid:"",uid:"",aname:"",txnId:"",firsttime:true},b.handlePostLoginActivity=function(f,e){var d="?uid="+b.data.uid;
d+="&pcode="+b.data.pcode;d+="&scode="+b.data.scode;d+="&aname="+f;d+="&pfm=WEB";d+="&txnId="+e;b.sendActivityRequest(d)},b.sendActivityRequest=function(d){$.get("https://tpapi.timespoints.com/v1/activity/logact"+d,function(f,e){if(f.status=='"FAILURE"'){console.log(f.message)}else{console.log("TPActivity Post Login Activity URL -https://tpapi.timespoints.com/v1/activity/logact"+d)}})},b.bindEvents=function(){$(document).on("VOD_EVENTS",function(f,g,e){var d=g.id?g.id:Math.round((new Date()).getTime());
if(typeof e!="undefined"&&e.toUpperCase()=="VIDEOVIEW"){b.fireActivity("watch_video",d)}});$(document).on("article_read",function(e,f,d){b.fireActivity("read",f.msid)});$(document).on("view_photo",function(e,f,d){b.fireActivity("view_photo",f.msid)});$(document).on("social.onBeforeShare",function(d){if(!b.data.isUserLoggedIn){TPWidget.addPreLoginActivity("sh_tw")}})},b.fireActivity=function(d,e){if(!b.data.isUserLoggedIn){console.log("TPActivity Activity- "+d+", Transcation ID-"+e);TPWidget.addPreLoginActivity(d)
}else{b.handlePostLoginActivity(d,e)}},b.initialisewidget=function(e){if(typeof TPWidget!="undefined"&&typeof TPWidget.init=="function"){var d=[];$.each(b.data.widgettypes,function(f,g){if($("#"+g).length){d.push({ele:g,widgetType:b.data[g]})}});if(e!=null&&typeof(e)!="undefined"){TPWidget.init({widgets:d,userLoginInfo:{host:b.data.pcode,channel:b.data.scode,URL:escape(document.location.href),userId:b.data.uid,oid:"",email:b.data.email}})}else{TPWidget.init({widgets:d})}}c.publish("tpinitated")},b.PostLoginActions=function(){TPWidget.PostLoginActions({host:"TOI",channel:"News",URL:escape(document.location.href),userId:b.data.uid,oid:"",email:b.data.email})
},b.subscribeLoggedInStatus=function(){c.subscribe("user.status",function(d){b.data.isUserLoggedIn=typeof d!=="undefined"&&d!==null?true:false;if(!b.data.isInitialised){b.updateUserDetails();b.initialisewidget(d);b.data.isInitialised=true;if(toiprops&&toiprops._Tmpl_pg&&toiprops._Tmpl_pg.toLowerCase()=="default"){b.fireActivity("visit",Math.round((new Date()).getTime()));b.fireActivity("register",Math.round((new Date()).getTime()))}}b.data.firsttime=false});c.subscribe("user.login",function(d){if(d){b.data.isUserLoggedIn=true;
b.updateUserDetails(d.getEmail());b.PostLoginActions();typeof ga=="function"&&ga("send","event","TPRedeem","login_success",window.location.href)}});c.subscribe("user.logout",function(d){b.data.isUserLoggedIn=false;if(!b.data.firsttime){if(typeof TPWidget!="undefined"&&typeof TPWidget.logoutAction=="function"){TPWidget.logoutAction()}}b.data.isUserLoggedIn=false})},b.updateUserDetails=function(d){b.data.email=d?d:a&&a.get("MSCSAuthDetails")&&a.get("MSCSAuthDetails").split("=")[1];b.data.uid=a&&a.get("ssoid")
};return b});var TimesApps=window.TimesApps||{};TimesApps.VideoGalleryApp=(function(){var a,e,d,f,c,b;f={videoBoxMap:{},videoCount:0};b={PLAYING:"PLAYING",PAUSED:"PAUSED",AUTOPLAY_LOCALSTORAGE_KEY:"autoplay_userInitiated"};c=function(){var g=f;$(document).on("videodash.invokeVideo",function(h,i){e._playNext.call(null,[h,i,g])});$(document).on("videodash.userAction LIVE_TV_EVENTS",function(i,j,h){e._playCurrentAndPauseOthers.call(null,[i,j,h])});$(document).on("MINI_TV_EVENTS VOD_EVENTS",function(i,j,h){require(["tiljs/event"],function(k){k.publish("VOD_EVENTS",[i,j,h])
});e._playCurrentAndPauseOthers.call(null,[i,j,h]);if(h.toUpperCase()=="VIDEOIFRAMEREMOVED"){TimesApps.playingSubsequentVideo=false}});$(document).on("GAANA_PLAYER_LOADED VOD_LOADED",function(k,j,h,i){f.pageName=f.pageName?f.pageName:($("body").data("page-name")||"");if(h=="VOD_LOADED"&&j.source=="MG_0"){return}e._processSystemInitiatedEvents.call(null,[k,j,h,i])});$(document).on("PLAYER_LOADED",function(k,j,h,i){e._processSystemInitiatedEvents.call(null,[k,j,h,i])});$(document).on("GAANA_PLAYER_EVENTS",function(i,j,h){e._playCurrentAndPauseOthers.call(null,[i,j,h])
});$(document).on("videodash.videoEvents LIVE_TV_EVENTS MINI_TV_LOADED",function(k,j,h,i){e._processSystemInitiatedEvents.call(null,[k,j,h,i])});require(["event"],function(h){h.subscribe("MINI_TV_EVENTS",function(l){var k={};var j=l[0];var i=l[1];e._playCurrentAndPauseOthers.call(null,[k,j,i])})});$(document).on("videodash.switchOffAutoPlay",function(i,h){e._toggleAutoPlay.call(null,[i,h])});$(".jMediaGalleryWidget").on("MG_EVENTS",function(k,j,h,i){e._processSystemInitiatedEvents.call(null,[k,j,h,i])
})};a={_createVideoObjForOtherTypePlayer:function(k,j,h,i,g){return new TimesApps.OtherVideoBox(k,j,h,i,g)}};e={_init:function(){c()},_playCurrentAndPauseOthers:function(o){var h=o[0];var p=o[1];var k=o[2].toUpperCase();var n=p.source.toUpperCase();if(f.videoBoxMap[n]){var l=f.videoBoxMap[n];l.setStatus(b.PLAYING);if(TimesApps.isDevMode){console.log("VOD_STATUS_playing__"+n+"__videoMap-",f.videoBoxMap)}e._pauseVideosNotInFocus.call(null,[h,p,k])}if(h.type=="VOD_EVENTS"&&k=="VIDEOREADY"){var n=p.source.toUpperCase();
if(f.videoBoxMap[n]){var j=f.videoBoxMap[n];if(j.markPlaying){j.markPlaying(p.id)}if(j.findNext){var g=j.findNext(j.domEle.find(".playing"));var i=j.domEle.find("iframe")[0].contentWindow;var m=g.attr("data-msid")||"";if(i.TimesApps&&i.TimesApps.Vod_Player&&i.TimesApps.Vod_Player.addNextVideoToList){i.TimesApps.Vod_Player.addNextVideoToList(m)}}}}},_processSystemInitiatedEvents:function(g){var k=g[0];var j=g[1];var h=g[2].toUpperCase();var m=j.source.toUpperCase();if(h=="VIDEOREADY"){e._pauseVideosNotInFocus.call(null,[k,j,h]);
if(e._checkIfVideoShouldPause(m)){e._pauseVideo(m)}}else{if(h=="LIVE_TV_LOADED"||h=="MG_LOADED"||h=="MINI_TV_LOADED"||h=="GAANA_PLAYER_LOADED"||h=="VOD_LOADED"||h=="PLAYER_LOADED"){var n=j.domSelector;var i=g[3];if(h=="LIVE_TV_LOADED"||h=="MINI_TV_LOADED"||h=="GAANA_PLAYER_LOADED"||h=="VOD_LOADED"||h=="PLAYER_LOADED"){e._turnOffAutoPlayForAll()}if(h=="MINI_TV_LOADED"){TimesApps.overlayModule&&TimesApps.overlayModule.close()}var l=(j.userInitiated==true)?false:true;e._registerOtherTypePlayers(m,n,i,l,j.msid)
}}},_checkIfVideoShouldPause:function(h){var g=f.videoBoxMap[h];if(g.getStatus()==b.PAUSED){return true}return false},_pauseVideo:function(h){var g=f.videoBoxMap[h];if(g&&typeof g.pauseVideo=="function"){g.pauseVideo()}},_pauseVideosNotInFocus:function(o){var g=o[0];var p=o[1];var j=o[2].toUpperCase();var n=p.source.toUpperCase();if(j=="PLAYING"||j=="VIDEOREADY"||j=="START"){if(f.videoBoxMap[n]){var k=f.videoBoxMap[n]}var l=Object.keys(f.videoBoxMap);for(var m=0;m<l.length;m++){var n=l[m].toUpperCase();
var h=f.videoBoxMap[n];if(n!=k.getId()){h.setStatus(b.PAUSED);e._pauseVideo(n)}}}},_playNext:function(g){var h=g[0];var j=g[1];var k=g[2];var l=j.source.toUpperCase();if(k.videoBoxMap[l]){var i=k.videoBoxMap[l];if(i&&typeof i.playNext=="function"){i.playNext()}}},_toggleAutoPlay:function(g){var i=g[0];var h=g[1];localStorage.setItem(b.AUTOPLAY_LOCALSTORAGE_KEY,h.stxt)},_addNewVideo:function(h,g){var j=h.id;var i=new TimesApps.VideoBox(h,g);f.videoBoxMap[j]=i;f.videoCount++},_addOtherTypeVideo:function(k,l,i,j,g){var h=a._createVideoObjForOtherTypePlayer(k,l,i,j,g);
f.videoBoxMap[k]=h;f.videoCount++},_turnOffAutoPlayForAll:function(){var k=Object.keys(f.videoBoxMap);for(var g=0;g<k.length;g++){var j=k[g].toUpperCase();var h=f.videoBoxMap[j];if(typeof h.setAutoPlay=="function"){h.setAutoPlay(false)}}},_registerOtherTypePlayers:function(j,k,h,i,g){j=j.toUpperCase();e._addOtherTypeVideo(j,k,h,i,g)}};d={init:function(){return e._init()},addNewVideo:function(h,g){return e._addNewVideo(h,g)},getVideoCount:function(){return f.videoCount},getVideoList:function(){return f.videoBoxMap
},pauseVideo:function(g){return e._pauseVideo(g)}};e._init();return d}());TimesApps.OtherVideoBox=function(f,e,c,d,b){this.id=f;this.domEle=$(e).eq(0);this.status="PLAYING";this.pauseVideoCallBack=c;this.msid=b;this.config={autoplay:d||false};var a=this;this.domEle.on("click",function(g){a.setStatus("PLAYING")})};TimesApps.OtherVideoBox.prototype.getStatus=function(){return this.status};TimesApps.OtherVideoBox.prototype.setStatus=function(a){this.status=a};TimesApps.OtherVideoBox.prototype.getId=function(){return this.id
};TimesApps.OtherVideoBox.prototype.pauseVideo=function(){if(typeof this.pauseVideoCallBack=="function"){this.pauseVideoCallBack()}else{if(typeof this.domEle.prop("contentDocument")=="undefined"){return}var a=this.domEle.prop("contentDocument").embeds.myMovie;if(typeof a=="undefined"){return}this.setStatus("PAUSED");a.pauseVideo()}};TimesApps.overlayModule=(function(e){var c,b,d,f,a,g;a={defaultHtml:'<div id="vcw" class="jOverlay video-overlay-wrapper"><div class="inner"><div class="buttonContainer"><span class="jToggleOverlay expand"></span><button type="button" class="closebtn"></button></div><div class="video-content"></div></div></div>'};
f={html:"",videosection:"toi",source:"toi",pg:"toi",isFullscreen:false,allowDock:false};d={isOverlayOpen:false};g=function(){e("#vcw .closebtn").off("click").on("click",c._close);e("#vcw .jToggleOverlay").off("click").on("click",c._toggleOverlayAndDock)};c={_init:function(){e(document).on("keyup",function(h){if(h.keyCode==27){c._close()}})},_create:function(h){d=e.extend({},f,h);c._render(d.html);g()},_render:function(h){if(!e("#vcw").length){var i=(e(".sidebar").length?e(".sidebar"):e(".sidebar2")).eq(0);
var j=i.closest(".wrapper").length?i.closest(".wrapper"):e(".wrapper");j.append(a.defaultHtml)}if(d.isFullscreen){e(".jOverlay").addClass("fullscreen");e("body").addClass("overflowHidden")}else{e(".jOverlay").removeClass("fullscreen")}e("#vcw .video-content").html(h);e("#vcw").fadeIn(500);d.isOverlayOpen=true;if(!d.allowDock){e(".jToggleOverlay").addClass("hidden")}},_close:function(){e("body").removeClass("overflowHidden");e("#vcw").fadeOut(500,function(){e("#vcw").remove()});e("body").css("overflow","auto");
d.isOverlayOpen=false;require(["tiljs/event"],function(h){h.publish("overlayClosed",{id:d.id})})},_isOverlayOpen:function(){return d.isOverlayOpen},_getSidebarDimenions:function(){var h={leftOffset:0,width:0};var i=(e(".sidebar").length?e(".sidebar"):e(".sidebar2")).eq(0);if(!i.length){return h}h.width=i.width()+"px";var j=0;var k=i.closest(".wrapper").length?i.closest(".wrapper"):e(".wrapper");if(k.length){j=k.offset().left+parseInt(k.css("padding-left"));j=Math.abs(j)}h.leftOffset=(i.offset().left-j)+"px";
return h},_positionDock:function(){var h=e(".jOverlay");var i=c._getSidebarDimenions();h.css({"margin-left":i.leftOffset,width:i.width}).addClass("belowHeader");e("#gaanaplayer").addClass("shifttoleft")},_toggleOverlayAndDock:function(i){if(!d.allowDock){return}var h=e(".jOverlay");h.toggleClass("video-overlay-wrapper fullscreen dockedVideo fixed animateDock dockedVideoSize").removeClass("belowHeader").css({"margin-left":"",width:""});e("body").toggleClass("overflowHidden");if(d.isOverlayOpen){d.isOverlayOpen=false;
c._positionDock();require(["tiljs/event"],function(j){j.publish("overlayClosed",{id:d.id});j.publish("onOverlayDock",{id:d.id})})}else{d.isOverlayOpen=true;require(["tiljs/event"],function(j){j.publish("overlayOpen",{id:d.id})})}}};b={init:function(){c._init()},create:function(h){c._create(h)},close:function(){c._close()},isOverlayOpen:function(){return c._isOverlayOpen()},getSidebarPosition:function(){return c._getSidebarDimenions()}};return b}(jQuery));TimesApps.overlayModule.init();TimesApps.VideoListPlayer=(function(){var d,c,a,b,e;
b={iframeHtml:'<iframe allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" id="videosrc"></iframe>'};a={videoList:$(".jVideoList")};e={currentVideo:undefined,pageUrl:undefined,playerType:"",isOverlayOpen:false,isDocked:false,vidSource:""};bindEvents=function(){if($("#container.articleshow").length){$("body").on("click",".jVideoList [data-plugin='vidPlay']",d._handleClick);$("body").on("click",".jVideoList [data-plugin='vidOverlay']",d._handleClick)}else{$(".jVideoList").on("click","[data-plugin='vidPlay']",d._handleClick);
$(".jVideoList").on("click","[data-plugin='vidOverlay']",d._handleClick)}$(document).on("VOD_EVENTS",d._handlePlayerEvents);require(["tiljs/event"],function(f){f.subscribe("overlayClosed",d._onOverlayClose);f.subscribe("overlayOpen",d._onOverlayOpen);f.subscribe("onOverlayDock",d._onOverlayDock)});require(["tiljs/event"],function(f){f.subscribe("onVideoOverlayOpen",d._updatePageUrl);f.subscribe("onVideoOverlayOpen",d._triggerAnalyticsForDockOverlayEvents);f.subscribe("onVideoOverlayUpdate",d._triggerAnalyticsForDockOverlayEvents);
f.subscribe("onVideoDock",d._triggerAnalyticsForDockOverlayEvents);f.subscribe("onVideoOverlayUpdate",d._updatePageUrl);f.subscribe("onVideoOverlayUpdate",d._triggerAnalytics);f.subscribe("onVideoOverlayUpdate",d._markPlaying)})};d={_triggerAnalyticsForDockOverlayEvents:function(h){if(!h.vidSource){return}var i=window.ga;var j;if(TimesApps.dockVideo.getStatus("isDocked")||e.isDocked){j="Video-Dock_Player"}else{if(TimesApps.dockVideo.getStatus("isOverlayOpen")||h.isOverlay){j="Video-Overlay_Player"
}}if(!(i&&j)){return}var g=toiprops.seoLocation||"";g+="-"+h.vidSource||"";var f="Parent-"+(e.pageUrl||"");f+="-Child-";if(h.vidUrl){f+=h.vidUrl}else{f+=h.msid}i("send",{hitType:"event",eventCategory:j,eventAction:g,eventLabel:f})},_savePageUrl:function(){e.pageUrl=window.location.pathname},_triggerAnalytics:function(g){var h=g.title;var f=g.url;if(typeof ga!="undefined"){ga("send",{hitType:"pageview",page:f,title:h,location:location.protocol+"//"+location.hostname+f})}if(typeof(fireComscore)=="function"){fireComscore()
}if(typeof(pSUPERFLY)!="undefined"&&typeof(pSUPERFLY.virtualPage)=="function"){pSUPERFLY.virtualPage(f,h)}},_updatePageUrl:function(f){if(!e.isOverlayOpen){return}if(!(f&&f.url)){return}history.pushState(null,null,f.url)},_updateTitle:function(){},_getVideoSrc:function(k,m){var j=$(k);e.currentVideo=k;var i=j.data("msid");var g=d._getNextVideo(k);var h=g.data("msid")||"";var f=j.closest("[data-secid]").data("secid");if(!f){f=j.closest(".video-category").find("[data-secid]").data("secid")||""}e.vidSource=j.closest("[data-ga-source]").data("ga-source")||"";
var l="/vod_player.cms?msid=";l+=i;l+="&videosection="+(j.closest("[data-slike-sec]").data("slike-sec")||"");l+="&source="+e.vidSource;l+="&nextid="+h;l+="&audio=80";l+="&secId="+f;l+="&autoplay=1";l+="&type=vidOverlay";l+="&utm_source=DesktopHome&utm_medium=LatestNews&utm_campaign=VideoPlug&pg=toihp";l+="&version=2";if(m&&m!="false"){l+="&userInitiated=1"}else{l+="&userInitiated=0"}return l},_loadVideoInOverlay:function(h,q){var p=$(h);var n=$(p).data("msid");var g=d._getVideoSrc(h,q);var j=document.createElement("div");
$(j).html(b.iframeHtml);$(j).find("iframe").attr("src",g);var o=p.find(".w_tle a").text();var m=$("<p>").addClass("jTitle title").text(o);$(j).append(m);var k=false;var l=require("tiljs/is").desktop();if(l&&d._getPlayerType()=="VIDOVERLAY"){k=true}TimesApps.overlayModule.create({id:n,html:j.innerHTML,isFullscreen:true,allowDock:k});e.isOverlayOpen=true;var o=p.find("a").attr("title");var i=p.find("a").attr("href");d._savePageUrl();var f={title:o,url:i,vidSource:e.vidSource,vidUrl:i,msid:n,isOverlay:true};
require("tiljs/event").publish("onVideoOverlayOpen",f)},_fetchPlaylist:function(h,k,j,g,i){var f="/wdt_videolist.cms?v=1954&msid="+g+"&config.perpage=10&tmpl=videoshow&img=200&tag=videopllist&pg=AS_RHS_Overlay~Videos!TopVideo&classname=vidOverlay";$.ajax({url:f,contentType:"text/html",dataType:"html",type:"GET"}).done(function(u){if(!(u&&u.length)){return}var n=$("<div>").addClass("slideshowbox");n.append("<div>").addClass("jPlaylist playlist").attr("data-plugin","videos_section_slider").html(u);
if(!n.find("ul li").length){return}if(!n.find("ul [data-msid='"+j+"']").length){var o=n.find("ul li").eq(0).clone();var m=o.data("msid");var q=new RegExp(m,"g");var t=o.find("img").attr("data-src").replace(q,j);var r=k.find(".w_tle a").eq(0).text();o.attr("data-msid",j).find("img").attr("data-src",t);o.find(".w_tle a").eq(0).text(r);n.find("ul").prepend(o)}else{var p=n.find("ul [data-msid='"+j+"']");var l=p.clone();p.remove();n.find("ul").prepend(l)}n.find("[data-msid='"+j+"']").addClass("active");
if(typeof i=="function"){i(n)}})},_addPlaylist:function(i){var g=$(".video-content");var h=function(m){if(d._getPlayerType()=="VIDOVERLAY"){g.find(".jPlaylist").remove();g.append(m)}else{if(d._getPlayerType()=="VIDPLAY"){g.find(".jPlaylist").remove();g.append(m)}}var l=g.find(".jPlaylist");l.off().on("click","[data-plugin='vidOverlay']",d._changeVideo);videos_section_slider.init(l);setTimeout(function(){require("tiljs/plugin/lazy").load()},1000)};var k=$(i.target).closest("[data-plugin='vidOverlay']");
var j=k.data("msid");var f=k.closest(".video-category").find("[data-secid]").data("secid")||"";if(!f){f=k.closest("[data-secid]").data("secid")||""}d._fetchPlaylist(i,k,j,f,h)},_changeVideo:function(h){h.preventDefault();var g=this;e.currentVideo=g;var j=d._getVideoSrc(g,true);$(".jOverlay").find("iframe").attr("src",j);var i=$(g).find("a").attr("title");var f=$(g).find("a").attr("href");require("tiljs/event").publish("onVideoOverlayOpen",{title:i,url:f})},_onOverlayClose:function(f){d._updatePageUrl({url:e.pageUrl});
e.isOverlayOpen=false},_onOverlayOpen:function(i){var h=$(e.currentVideo);var j=$(h).find("a").attr("title");var g=$(h).find("a").attr("href");e.isOverlayOpen=true;e.isDocked=false;var f={title:j,url:g,isOverlay:true,vidSource:e.vidSource};require("tiljs/event").publish("onVideoOverlayOpen",f)},_onOverlayDock:function(){var i=$(e.currentVideo);var h=$(i).data("msid");var g=$(i).find("a").attr("href");e.isOverlayOpen=false;e.isDocked=true;var f={vidSource:e.vidSource,vidUrl:g,msid:h,isDocked:true};
require("tiljs/event").publish("onVideoDock",f)},_handleClick:function(i){i.preventDefault();var h=$(".jOverlay");h.find(".jToggleOverlay").trigger("click");TimesApps.dockVideo&&TimesApps.dockVideo.close();var f=this;var g=$(this).data("plugin")||"";e.playerType=g.toUpperCase();d._loadVideoInOverlay(f,true);if(d._getPlayerType()=="VIDOVERLAY"||d._getPlayerType()=="VIDPLAY"){d._addPlaylist(i)}},_handlePlayerEvents:function(g,h,f){g.preventDefault();var i=h.source||"";i=i.toUpperCase();switch(f.toUpperCase()){case"ONNEXTVIDEOPLAY":if(d._getPlayerType()=="VIDPLAY"){d._playNext(h.userInitiated)
}break;case"VIDEOREADY":if(d._getPlayerType()=="VIDOVERLAY"){d._updateUi(h)}break;case"PLAYING":if(i=="ABOVEARTICLE"&&!TimesApps.dockVideo.getStatus("isOverlayOpen")){TimesApps.dockVideo.setStatus("overlayClosedByUser",false)}}},_getNextVideo:function(g){var g=$(g);var f=g.next();if(f.length==0){f=g.siblings().eq(0)}return f},_playNext:function(h){if(!e.currentVideo){return}var g=$(e.currentVideo);e.currentVideo=g;var f=d._getNextVideo(g);d._updatePageUrl({url:$(f).find("a").attr("href")});d._loadVideoInOverlay(f,h)
},_updateUi:function(f){var j=$(".jOverlay").find(".jPlaylist");var i=$("ul [data-msid='"+f.id+"']").eq(0);e.currentVideo=i;var k=i.find(".w_tle a").eq(0).text()||"";var h=$(".jOverlay");h.find(".jTitle").text(k);var g=i.find("a").attr("href")||"";require("tiljs/event").publish("onVideoOverlayUpdate",{url:g,obj:f,playlistDom:j,title:k})},_markPlaying:function(g){if(!(g&&g.playlistDom&&g.obj)){return}var i=g.playlistDom;var h=g.obj;var f;if(h&&h.id){f=h.id}else{if(g.currentVideo){f=g.currentVideo.attr("msid")
}}i.find("li").removeClass("active");i.find("ul [data-msid='"+f+"']").addClass("active")},_getPlayerType:function(){return(e.playerType||"").toUpperCase()},_init:function(){if(!(a.videoList.find("[data-plugin='vidPlay']").length||a.videoList.find("[data-plugin='vidOverlay']").length)){return}bindEvents();d._savePageUrl()}};c={init:function(){return d._init()},savePageUrl:function(){d._savePageUrl()},getVideoSrc:function(f,g){return d._getVideoSrc(f,g)},fetchPlaylist:function(g,j,i,f,h){return d._fetchPlaylist(g,j,i,f,h)
}};d._init();return c})();TimesApps.dockVideo=(function(e){var c,b,a,d,f;d={isDocked:false,isDragged:false,isOverlayOpen:false,overlayClosedByUser:false,msid:undefined,vidContainer:undefined,vidSource:undefined};data={vidUrl:""};f=function(){require(["tiljs/event"],function(g){g.subscribe("VOD_EVENTS",function(i){if(!i instanceof Array){return}var k=i[1]||{};var j=(k.source||"").toUpperCase();var h=i[2]?i[2].toUpperCase():"";if(j.indexOf("ABOVEARTICLE")>-1&&h=="VIDEOREADY"){if(!d.vidContainer){d.vidSource=j;
d.vidContainer=e(".articlevideo[data-msid='"+k.id+"']").find(".vidContainer");d.vidScrollContainer=d.vidContainer.closest(".articlevideo");require("tiljs/event").subscribe("window.scroll",c._handleVideoPosition)}else{if(d.vidSource!=j){c._close(true);d.vidSource=j;d.vidContainer=e(".articlevideo[data-msid='"+k.id+"']").find(".vidContainer");d.vidScrollContainer=d.vidContainer.closest(".articlevideo")}else{if(!c._getStatus("isOverlayOpen")){d.overlayClosedByUser=false;d.vidContainer=e(".articlevideo[data-msid='"+k.id+"']").find(".vidContainer")
}}}if(c._getStatus("isOverlayOpen")){c._updateOverlay(k)}d.vidContainer.off().on("click",".jToggleOverlay",c._expandCollapseOverlay);d.vidContainer.on("click",".jClose",c._close)}else{if(j.indexOf("ABOVEARTICLE")>-1&&h=="PLAYING"){d.overlayClosedByUser=false}}e(document).on("keyup",function(l){if(l.keyCode==27){c._close()}})})})};c={_makePlayerDraggable:function(){},_handleVideoPosition:function(){if(d.isOverlayOpen){return}var h=d.vidScrollContainer;var g=e("#skew").val()||50;var j=require("tiljs/ui").inView(e("#header .sub-header"),true,100);
var i=require("tiljs/ui").inView(h,true,-280);if(i&&d.isDocked){c._closeDock();d.isDragged=false}else{if(!i&&!d.isDragged&&!d.isDocked&&!j){c._dockPlayer()}}},_dockPlayer:function(k){var i=d.vidContainer;if(!d.isDocked&&!d.overlayClosedByUser){if(!i.find(".buttonContainer").length){var h='<div class="buttonContainer jDockButton"><span class="jToggleOverlay expand"></span>';h+='<span class="jClose close"></span></div>';i.prepend(h)}else{i.find(".buttonContainer").removeClass("hidden")}d.isDocked=true;
d.msid=i.find("iframe").data("videomsid");var m=i.closest("#container.articleshow #content").find(".title_section .heading1").text();var n=TimesApps.overlayModule.getSidebarPosition();if(!i.find(".jTitle").length){var j=e("<p>").addClass("jTitle title").text(m);i.addClass("dockedVideo fixed animateDock dockedVideoSize belowHeader").css({"margin-left":n.leftOffset,width:n.width}).append(j)}else{i.addClass("dockedVideo fixed animateDock dockedVideoSize belowHeader").css({"margin-left":n.leftOffset,width:n.width}).find(".jTitle").text(m).removeClass("hidden")
}e("#gaanaplayer").addClass("shifttoleft");TimesApps.overlayModule.close();i.one("animationend webkitTransitionEnd transitionend webkitAnimationEnd oAnimationEnd MSAnimationEnd",function(p){p.stopPropagation();p.stopImmediatePropagation();i.addClass("animationEnd")});i.removeClass("animationEnd");var l=e(".articlevideo").attr("data-msid")||window.msid;var o="/photo/"+l+".cms";e(".vidbox").css("background-image","url("+o+")");var g={vidSource:d.vidSource,vidUrl:data.vidUrl,msid:d.msid,isDocked:true};
require("tiljs/event").publish("onVideoDock",g)}},_expandToOverlay:function(){d.isOverlayOpen=true;d.isDocked=false;var h=e(".vidContainer");h.addClass("expand-overlay").removeClass("dockedVideo fixed animateDock dockedVideoSize belowHeader").css({"margin-left":"",width:""}).off("mousedown");if(h.parent().find(".expand-overlay-box").length){e("<div>").addClass("expand-overlay-box").insertBefore(h)}e("body").addClass("overflowHidden");TimesApps.VideoListPlayer.savePageUrl();var g={vidSource:d.vidSource,vidUrl:data.vidUrl,msid:d.msid,isOverlay:true};
require("tiljs/event").publish("onVideoOverlayOpen",g)},_collapseToDock:function(){d.isOverlayOpen=false;d.isDocked=true;var h=e(".vidContainer");e("body").removeClass("overflowHidden");var i=TimesApps.overlayModule.getSidebarPosition();h.removeClass("expand-overlay").addClass("dockedVideo fixed animateDock dockedVideoSize belowHeader").css({"margin-left":i.leftOffset,width:i.width}).off("mousedown");var g={vidSource:d.vidSource,vidUrl:data.vidUrl,msid:d.msid,isDocked:true};require("tiljs/event").publish("onVideoDock",g)
},_expandCollapseOverlay:function(i){if(d.isDocked){d.isDocked=false;c._expandToOverlay();var h=function(m){var l=e(".vidContainer");l.find(".jPlaylist").remove();l.append(m);l.find(".jPlaylist").off().on("click","[data-plugin='vidOverlay']",c._changeVideoInOverlay);videos_section_slider.init(e(".jPlaylist"));setTimeout(require("tiljs/plugin/lazy").load(),1000)};var k=d.vidScrollContainer;var j=d.vidScrollContainer.find("iframe").contents().find("#msid").val()||"";var g=d.vidScrollContainer.find("iframe").contents().find("#sectionId").val()||"";
TimesApps.VideoListPlayer.fetchPlaylist(i,k,j,g,h)}else{c._collapseToDock()}},_changeVideoInOverlay:function(j){j.preventDefault();var i=e(this);var l=TimesApps.VideoListPlayer.getVideoSrc(i,true);d.vidContainer.find("iframe").attr("src",l);var k=i.find("a").attr("title");var h=i.find("a").attr("href");d.vidContainer.find(".jPlaylist li").removeClass("active");i.addClass("active");d.vidContainer.find(".jTitle").text(k);data.vidUrl=h;var g={url:h,obj:undefined,playlistDom:d.vidContainer,title:k,vidSource:d.vidSource,vidUrl:data.vidUrl,isOverlay:true};
require("tiljs/event").publish("onVideoOverlayUpdate",g)},_removePlaylist:function(){e(".jPlaylist").remove()},_closeDock:function(){e(".vidbox").css("background-image","").css("background-color","black");e(".vidContainer").removeClass("dockedVideo animateDock dockedVideoSize fixed belowHeader").css({"margin-left":"",width:""}).find(".jTitle").addClass("hidden");d.isDocked=false;c._removeButtons()},_closeOverlay:function(){d.isOverlayOpen=false;c._removePlaylist();e(".vidContainer").removeClass("expand-overlay").find(".jTitle").addClass("hidden");
e("expand-overlay-box").addClass("hidden");c._removeButtons();e("body").removeClass("overflowHidden");require(["tiljs/event"],function(g){g.publish("overlayClosed",{})})},_close:function(h){if(!d.vidScrollContainer){return}if(h===true){d.overlayClosedByUser=false}else{d.overlayClosedByUser=true}if(d.isDocked){c._closeDock()}else{c._closeOverlay()}var g=d.vidScrollContainer.find("iframe");if(g&&g[0]&&g[0].contentWindow&&g[0].contentWindow.TimesApps.VideoPlayer2.getPlayer("VOD")&&g[0].contentWindow.TimesApps.VideoPlayer2.getPlayer("VOD").pause){g[0].contentWindow.TimesApps.VideoPlayer2.getPlayer("VOD").pause()
}},_removeButtons:function(){e(".vidContainer").find(".buttonContainer").addClass("hidden")},_getStatus:function(g){return d[g]},_setStatus:function(g,h){d[g]=h},_isVideoDocked:function(){var g={status:false,id:undefined};if(d.isDocked){g={status:true,id:d.msid}}return g},_updateOverlay:function(j){var l=j.title||"";d.vidContainer.find(".jTitle").text(l);var k=d.vidContainer.find(".jPlaylist");var h=d.vidContainer.find(".jPlaylist ul [data-msid="+j.id+"]");if(!(h&&h.length)){return}var g=h.eq(0).find("a").attr("href")||"";
var i={url:g,obj:j,playlistDom:k,title:l,isOverlay:true};require("tiljs/event").publish("onVideoOverlayUpdate",i)},_init:function(){f()}};b={getStatus:function(g){return c._getStatus(g)},setStatus:function(g,h){c._setStatus(g,h)},isVideoDocked:function(){return c._isVideoDocked()},close:function(g){return c._close()}};c._init();return b}(jQuery));define("gaanaplayer",["jquery","tiljs/logger","tiljs/is"],function(e,c,d){var b={};var a=false;b.api={init:function(){b.fn._init()}};b.utils={checkIfIE:function(){var g=window.navigator.userAgent;
var f=g.indexOf("MSIE ");if(f>0||!!navigator.userAgent.match(/Trident.*rv\:11\./)){return true}else{return false}}};b.fn={_bindEvents:function(){e("#gaanaplayer .box_head").on("click",function(f){f.preventDefault();f.stopImmediatePropagation();if(e(this).closest("#gaanaplayer").hasClass("active")){b.fn._analyticsFire("Gaana widget","Minimize",window.location.href);b.fn._removeCloseBtn();e("#gaanaplayer").removeClass("active")}else{b.fn._analyticsFire("Gaana widget","Open",window.location.href);e("#gaanaplayer").addClass("active");
b.fn._addCloseBtn();b.fn._setIframeLink()}});e(document).on("videodash.userAction videodash.videoEvents LIVE_TV_EVENTS MINI_TV_EVENTS",function(g,h,f){b.fn._handleVideodashEvents(g,h,f)});e(window).on("beforeunload",function(f){a=true;if(document.getElementById("gaanatvplayer")&&document.getElementById("gaanatvplayer").contentWindow){var g=document.getElementById("gaanatvplayer");g.contentWindow.postMessage("close_browser","*")}});e(window).unload(function(){if(!a){var f=document.getElementById("gaanatvplayer");
f.contentWindow.postMessage("close_browser","*")}});e(".gaanaplayer_box .box_head").on("click",".close_gaanaplayer",function(f){f.preventDefault();var g=document.getElementById("gaanatvplayer");g.contentWindow.postMessage("close_gaanawidget","*");b.fn._analyticsFire("Gaana widget","Close",window.location.href);b.fn._closeGaanaplayer()});window.addEventListener("message",b.fn._messageHandler,false)},_createUI:function(){var h=e('<div class="gaanaplayer_box" id ="gaanaplayer_box"></div>');var f=e('<div class="box_head"><span class="gaanaplayer_title"><img src="/photo/58243404.cms" alt="gaana icon" /> of the Day</span></div>');
var g=e('<iframe frameborder="0" width="100%" height="310px" id="gaanatvplayer" class="jLivePlayer"></iframe>');h.append(f).append(g);e("#gaanaplayer").append(h)},_analyticsFire:function(g,h,f){if(window.ga){ga("send","event",g,h,f,{nonInteraction:1})}else{setTimeout(function(){ga("send","event",g,h,f,{nonInteraction:1})},5000)}return true},_init:function(){e("#gaanatvplayer").attr("src","");if(typeof d.IE=="function"&&d.IE()){e("#gaanaplayer").hide()}else{if(e("#minitv #streaming_box")&&e("#minitv #streaming_box").is(":visible")){e("#gaanaplayer").addClass("shifttoleft")
}b.fn._createUI();e("#gaanaplayer").show();b.fn._bindEvents()}},_addCloseBtn:function(){var f=e('<a class="close_gaanaplayer"></a>');e(".gaanaplayer_box .box_head").append(f)},_removeCloseBtn:function(){e(".gaanaplayer_box .box_head .close_gaanaplayer").remove()},_messageHandler:function(h){var g="https://gaana.com";if(h.origin==g){var f=h.data.status.replace(/\s/g,"").toLowerCase();if(f=="play"){b.fn._analyticsFire("Gaana widget","Play",h.data.title);b.fn._gaanaplayed()}else{if(f=="pause"){b.fn._analyticsFire("Gaana widget","Pause",h.data.title);
b.fn._gaanapaused()}else{if(f=="languagedropdownopen"){b.fn._analyticsFire("Gaana widget","Drop down open",window.location.href)}else{if(f=="languagechange"){b.fn._analyticsFire("Gaana widget","Language",h.data.value)}else{if(f=="loading"){b.fn._analyticsFire("Gaana widget","Loading",h.data.title);b.fn._gaanaplayed()}else{if(f=="seekbackward"){b.fn._analyticsFire("Gaana widget","Seek backward",h.data.title)}else{if(f=="seekforward"){b.fn._analyticsFire("Gaana widget","Seek forward",h.data.title)}}}}}}}}},_pauseGaanaplayer:function(){document.getElementById("gaanatvplayer").contentWindow&&document.getElementById("gaanatvplayer").contentWindow.postMessage("pause","*")
},_closeGaanaplayer:function(){e("#gaanaplayer").remove()},_pauseAndMinimizePlayer:function(){b.fn._pauseGaanaplayer();e("#gaanaplayer").removeClass("active");b.fn._removeCloseBtn()},_gaanaplayed:function(){e(document).trigger("GAANA_PLAYER_EVENTS",[{source:"GAANA_PLAYER"},"playing"])},_gaanapaused:function(){e(document).trigger("GAANA_PLAYER_EVENTS",[{source:"GAANA_PLAYER"},"paused"])},_triggerPlayerLoaded:function(){e(document).trigger("GAANA_PLAYER_LOADED",[{source:"GAANA_PLAYER"},"GAANA_PLAYER_LOADED",b.fn._pauseAndMinimizePlayer])
},_playGaanaplayer:function(){document.getElementById("gaanatvplayer").contentWindow&&document.getElementById("gaanatvplayer").contentWindow.postMessage("play","*")},_setIframeLink:function(){if(!e("#gaanatvplayer").attr("isloadedfirsttime")){b.fn._triggerPlayerLoaded();var f=b.data.iframeurl;e("#gaanatvplayer").attr("src",f).attr("isloadedfirsttime","true");e("#gaanatvplayer").on("load",function(){document.getElementById("gaanatvplayer").contentWindow&&document.getElementById("gaanatvplayer").contentWindow.postMessage("open_gaanawidget","*")
})}},_handleVideodashEvents:function(i,h,f,g){if(f.toUpperCase()=="START"){b.fn._pauseGaanaplayer()}}};b.data={iframeurl:e("#gaanatvplayer").attr("data_src")||"https://gaana.com/gaanawidget-v7"};return b.api});define("index",["./preload","./config","tiljs/compatibility","login","./api","tiljs/plugin/dynamic","./rodate","tiljs/plugin/lazy","tiljs/event","tiljs/util","./comments","./homepage","./crwdcnctrl","tiljs/social/facebook","tiljs/social/twitter","tiljs/social/pinterest","tiljs/social/linkedin","tiljs/social/googleplus","tiljs/plugin/pre_event","pgtrack","breakingnews","navigation","localstoragec","global","tiljs/load","jquery","./compatibility_toi","tiljs/apps/times/authorcomments","./nlwidget","toinotification","./tpwidget"],function(r,H,b,u,v,i,o,A,C,c,k,B,y,f,l,E,I,x,q,a,h,d,t,z,n,j,D,G,g,w,m){setTimeout(function(){u.init()
},1000);window.toicommonjs=true;C.subscribe(["user.login","user.logout"],function(e){c.reloadIframe("#fbk");document.cookie="ssolt=null; domain=.indiatimes.com; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT"});try{j(document).on("click",'[data-action="login"]',function(){u.login();return false})}catch(F){}j(document).off("contextmenu").on("contextmenu","img",function(J){return false});require(["ajax","cookie","event","tiljs/social/facebook","tiljs/social/twitter","tiljs/social/pinterest","tiljs/social/linkedin","tiljs/social/googleplus","./nlwidget"],function(Q,L,J,O,M,K,e,N,P){j("blockquote").each(function(){if(typeof FB=="undefined"&&/facebook/.test(j(this).attr("cite"))){O.init({init:true,parse:true})
}if(typeof twttr=="undefined"&&/twitter/.test(j(this).attr("class"))){M.init({parse:true})}});j(window).load(function(){P.run();if(j(".g-ytsubscribe").length){n.js("https://apis.google.com/js/platform.js",function(){})}if(j("#gaanaplayer").length){require(["gaanaplayer"],function(R){R.init()})}});J.subscribe("user.status",function(S){var T=L.get("ssoid");var R=L.get("ssolt");if((R===undefined&&T!==undefined)||(R&&T&&R!=T)){Q.ajax({url:"https://jsso.indiatimes.com/sso/crossdomain/getTicket?channel=toi&platform=web&version=v1",dataType:"jsonp",success:function(V){if(V&&V.ticketId){var U="https://socialappsintegrator.indiatimes.com/socialsite/v1validateTicket?ticketId="+V.ticketId+"&channel=toi";
Q.getJSONP(U,function(W){if(W&&W.code==200){now=new Date();then=new Date(new Date().setHours(24,0,0,0));L.set("ssolt",T,(then.getTime()-now.getTime())/(1000*60*60*24),"/",".indiatimes.com","")}})}}})}});n.js("https://image.timespoints.iimg.in/tpwidgets/static/dist/js/main.js");j(document.body).on("tpwidget-ready",function(){require(["./tpwidget"],function(R){R.init()})})});var p=window.TimesApps||{};p.thirdPartyAnalytics=(function(){var J,K,e;e={loadingScripts:false};H={urls:["//cdn.mouseflow.com/projects/343b6336-6580-4038-bacc-8315a8b99d5e.js","https://s3.amazonaws.com/static.chartbeat.com/js/chartbeat_video.js"]};
K={_loadScripts:function(){for(var L=0;L<H.urls.length;L++){require(["tiljs/load"],function(M){M.js(H.urls[this.i],"","","async")}.bind({i:L}))}e.loadingScripts=true},_loadMouseflow:function(){window._mfq=window._mfq||[]},_isLoadingScripts:function(){return e.loadingScripts},_init:function(){K._loadMouseflow();K._loadScripts()}};v={init:function(){K._init()},isLoadingScripts:function(){return K._isLoadingScripts()}};return v})();j(document).ready(function(){setTimeout(function(){var e=p.thirdPartyAnalytics.isLoadingScripts();
if(!e){p.thirdPartyAnalytics.init()}},100)});j(window).on("load",function(){var e=p.thirdPartyAnalytics.isLoadingScripts();if(!e){p.thirdPartyAnalytics.init()}});p.SignIn=function(){require(["tiljs/login"],function(e){e.login()})};p.comscoreTrackingConfig={comscoreCustomerId:"6036484",stationTitle:"TOI-Desktop",publisherName:"The Times of India",contentGenre:"News",c3:"10"};(function(ac,M,O){var ad=O(M),ak={configSelectors:{},urls:{},cssClasses:{hover:"active",twoColumn:"two-column",rightColumn:"right-column",leftColumn:"left-column",loader:"nav-loading",dropdown:"dropdown"}},ae={domSelectors:{navigation:"#main-nav",navItem:"li[data-menu-type]",preloadData:"[data-preload]",leftColumnItem:"li[data-id]",visibleLinks:"#main-nav .visible-links",hiddenLinks:"#main-nav .hidden-links",moreBtn:"#main-nav .cyclicnav",cyclicClass:".cyclicnav",preloaded:"[data-preloaded]"}},al={},aj={processing:false},P,J=false,T={},S=[],e={};
function ap(){var aq={};return O.extend(true,ae,aq)}function N(aq){al.$navigation=O(P.domSelectors.navigation);al.$navItems=al.$navigation.find(P.domSelectors.navItem);al.$header=O("#header");al.$subNav=al.$header.find("#sub-nav");al.$bottomArea=al.$header.find(".bottom-area");al.$allMenu=O("#allmenu");al.$menuMore=O("[data-more-nav]");al.$allMenuContent=O("#allmenu-content")}function U(aw,ar){var aq=O("#main-nav").find('li[data-id="'+aw+'"]'),av=aq.text(),at=aq.find("a").attr("href"),au={title:av,link:at};
if(ar===ak.cssClasses.twoColumn){aq.closest("."+ak.cssClasses.dropdown).find("."+ak.cssClasses.rightColumn).html("").addClass(ak.cssClasses.loader)}else{aq.find("."+ak.cssClasses.dropdown).html("").addClass(ak.cssClasses.loader)}}function W(ar){var aq=ar;if(typeof ar==="string"){aq=aq.replace(/\s\s+/g," ");while(aq.indexOf("<!--")>-1){aq=aq.substr(0,aq.indexOf("<!--"))+aq.substr(aq.indexOf("-->")+3,aq.length)}try{aq=JSON.parse(aq)}catch(at){aq=null}}return aq}function Z(aq,av){var ar,aw=aq.data("id"),au=aq.data("params"),at=aq.data("external");
if(at){ar=at}else{ar="/navjson/nav-"+aw+".cms";if(av&&au&&aw){ar+="?"+au}}return ar}function Y(aq,at,ar){O.ajax({url:Z(aq,ar)}).then(function(au){if(typeof at==="function"){at(au)}}).fail(function(au){U(id)})}function am(au,ar){var ax,az=false,aA=false,av=au,aw,ay,at=ar.data("menu-type"),aq=ar.find("."+ak.cssClasses.dropdown);switch(at){case"top-stories":(au.stories&&au.stories.length&&(az=true))||(aA=true);break;case"multi-list":(au.lists&&au.lists.length&&(az=true))||(aA=true);break;case"simple-list":(au.items&&au.items.length&&(az=true))||(aA=true);
break;case"two-column":(au.items&&au.items.length&&(az=true))||(aA=true);break}if(aA){U(ar.data("id"))}else{if(az){ax=O.templates("#"+at+"-menu-tmpl");if(at==="two-column"){aw=aq.find("."+ak.cssClasses.leftColumn+" "+ae.domSelectors.leftColumnItem);ay=aw.filter("."+ak.cssClasses.hover);aq=aq.find("."+ak.cssClasses.rightColumn)}av=ax.render(au)}}aq.html(av);aq.removeClass(ak.cssClasses.loader);if(au.items&&au.items.length){ag(au)}if(ay&&ay.length){ab.call(ay.get(0))}require(["tiljs/plugin/lazy"],function(aB){aB.load()
})}function ao(aq){aq.data("loading",true);Y(aq,function(ar){var at=ar;if(aq.data("menu-type")!=="external-html"){at=W(ar)}if(!at){return}aq.data("loaded",true);aq.data("loading",false);am(at,aq)})}function L(aq){var ar=aq.find("."+ak.cssClasses.leftColumn),at=ar.find("li").get(0);ab.call(at)}function X(at){var aq=O(this),ar=aq.find(P.domSelectors.leftColumnItem+"."+ak.cssClasses.hover);if(!aq.data("loaded")&&!aq.data("loading")){ao(aq)}if(!ar.length){L(aq)}}function aa(ar){var aq=O(this);O("#main-nav .active").removeClass("active")
}function ag(aq){O.each(aq.items,function(){T[this.catkey]={stories:this.stories,className:(this.className?this.className:null),domain:(this.domain?this.domain:null),catkey:this.catkey}})}function V(){}function af(at){var av=new Date().getTime();try{var aq=JSON.parse(localStorage.getItem(at));var ar=aq.timestamp+(aq.expires*24*60*60*1000);if(ar>av){return aq.value}return false}catch(au){R()}}function R(){var ar=new Date().getTime();var at=new RegExp("taffy_");for(_x in localStorage){try{var aq=JSON.parse(localStorage[_x]);
if(!aq.timestamp){continue}ed=(aq.expires)?aq.expires:1;ed=aq.timestamp+(ed*24*60*60*1000);if(ar>ed){localStorage.removeItem(_x)}}catch(au){}}}function ah(){function aq(ar){var at=O(P.domSelectors.navItem+P.domSelectors.preloadData).length?O(P.domSelectors.navItem+P.domSelectors.preloadData):O(P.domSelectors.preloadData);O(at).each(function(){var av=O(this),aw=av.data("id"),au=af(aw);if(au&&nl===undefined){am(au,av)}else{if(ar==1){Y(av,function(ax){var az=ax,ay=av.data("menu-type");if(ay!=="external-html"){az=W(ax);
if(ay==="top-stories"){av.data("loaded",true)}}if(!az){return}am(az,av);if(aw){localStorage.setItem(aw,JSON.stringify(az))}},true)}}})}setTimeout(function(){aq(1)},"3000")}function ai(){al.$navigation.on("mouseover",P.domSelectors.navItem,X);al.$menuMore.on("mouseover",function(){O(this).toggleClass(ak.cssClasses.hover);al.$allMenuContent.addClass(ak.cssClasses.hover);if(!al.$allMenuContent.data("loaded")){al.$allMenuContent.addClass(ak.cssClasses.loader);O.ajax({url:"/allmenu.cms"}).then(function(aq){al.$allMenuContent.html(aq);
al.$allMenuContent.removeClass(ak.cssClasses.loader);al.$allMenuContent.data("loaded",true)}).fail(function(){})}});O(document).on("mouseover",function(aq){if(O(aq.target).hasClass("all-sections")){return}if(!(al.$allMenu.hasClass(ak.cssClasses.hover))&&!O(aq.target).closest(al.$allMenuContent).length){al.$allMenuContent.removeClass(ak.cssClasses.hover)}});O(document).on("click",function(aw){if(!O(aw.target).closest(al.$navigation).length){return}var av=require("is");var at=!O(aw.target).closest(".no-hover").length;
var aq=O(aw.target);if(aq.closest(".left-column").length){var ar=true;O(".left-column .active").removeClass("active")}else{if(aq.closest(".jDropdownOpen").length){var au=true}}aj.tapTrack=aj.tapTrack||{};aj.tapTrack.latesttap=aj.tapTrack.latesttap||new Date().getTime();if((!ar&&!au&&at&&av.touch())||(ar&&!aq.parent("li.jDropdownOpen").length&&at&&av.touch())){O(aw.target).closest(".left-column li").addClass("active");O(".jDropdownOpen").removeClass("jDropdownOpen");O(aw.target).closest("li").addClass("jDropdownOpen");
if(!(O(aw.target).closest(al.$allMenu).length||O(aw.target).closest(al.$menuMore).length)){al.$allMenuContent.removeClass(ak.cssClasses.hover);al.$allMenu.removeClass(ak.cssClasses.hover)}aj.tapTrack.latesttap=new Date().getTime();return false}});al.$allMenu.on("click",function(){al.$allMenuContent.toggleClass(ak.cssClasses.hover);O("body").toggleClass("allmenu-active");if(al.$allMenuContent.hasClass(ak.cssClasses.hover)){al.$allMenu.addClass(ak.cssClasses.hover)}else{al.$allMenu.removeClass(ak.cssClasses.hover)
}if(!al.$allMenuContent.data("loaded")){al.$allMenuContent.addClass(ak.cssClasses.loader);O.ajax({url:"/allmenu.cms"}).then(function(aq){al.$allMenuContent.html(aq);al.$allMenuContent.removeClass(ak.cssClasses.loader);al.$allMenuContent.data("loaded",true)}).fail(function(){})}});if(!O("#pageType").val()||(O("#pageType").val()&&O("#pageType").val().indexOf("video")==-1)){O(".search-form .search-btn").click(function(){var ar=O(this).closest(".search-form"),aq=ar.hasClass("active"),at=ar.find("form input#query");
if(aq){ar.removeClass("active");at.blur()}else{ar.addClass("active");at.focus()}})}}function ab(){var az=O(this),aq=az.data("id"),ax=az.data("external"),av=az.data("param-lang"),au,ar=az.closest("."+ak.cssClasses.dropdown+"."+ak.cssClasses.twoColumn),ay=ar.find("."+ak.cssClasses.leftColumn),aA=ay.find("li[data-id]"),at=ar.find("."+ak.cssClasses.rightColumn),aw=O.templates("#top-stories-menu-tmpl");aA.removeClass(ak.cssClasses.hover);az.addClass(ak.cssClasses.hover);if(ax){if(e[aq]){at.html(e[aq]);
az.closest("."+ak.cssClasses.dropdown).find("."+ak.cssClasses.rightColumn).removeClass(ak.cssClasses.loader);require(["tiljs/plugin/lazy"],function(aB){aB.load()})}else{require(["tiljs/cookie"],function(aC){var aD=aC.get("geolocation"),aE=(window.getCityJSON&&getCityJSON[aD]&&getCityJSON[aD]["lang"])?getCityJSON[aD]["lang"]:"hindi",aB=ax;if(av){aB=aB+(aB.indexOf("?")>-1?"&":"?")+av+"="+aE}az.closest("."+ak.cssClasses.dropdown).find("."+ak.cssClasses.rightColumn).html("").addClass(ak.cssClasses.loader);
O.ajax({url:aB}).then(function(aF){e[aq]=aF;at.html(aF);az.closest("."+ak.cssClasses.dropdown).find("."+ak.cssClasses.rightColumn).removeClass(ak.cssClasses.loader);require(["tiljs/plugin/lazy"],function(aG){aG.load()})}).fail(function(){U(aq,ak.cssClasses.twoColumn)})})}}else{if(T[aq]&&T[aq].stories&&T[aq].stories.length){au=aw.render(T[aq]);at.html(au);az.closest("."+ak.cssClasses.dropdown).find("."+ak.cssClasses.rightColumn).removeClass(ak.cssClasses.loader);require(["tiljs/plugin/lazy"],function(aB){aB.load()
})}else{U(aq,ak.cssClasses.twoColumn)}}}function an(){$leftColumns=al.$navigation.find("."+ak.cssClasses.leftColumn);$leftColumns.each(function(){var aq=O(this);aq.on("mouseover",ae.domSelectors.leftColumnItem,function(ar){ar.stopPropagation();ab.call(this)})})}function K(aq){var at=aq.offset()?aq.offset().top:0,ar;ad.scroll(function(){ar=ad.scrollTop();if(ar>at){aq.addClass("sticky")}else{aq.removeClass("sticky")}})}function Q(){O("."+ak.cssClasses.leftColumn+" "+ae.domSelectors.leftColumnItem).each(function(){var aq=O(this),at=aq.data("id"),ar=(function(){try{return JSON.parse(localStorage.getItem(at))
}catch(au){return null}})();if(ar&&ar.items&&ar.items.length){ag(ar)}})}ac.NavigationManager={init:function(){P=ap();N();ai();Q();ah();V();an();K(al.$bottomArea);if(!O("#pageType").val()||(O("#pageType").val()&&O("#pageType").val().indexOf("video")==-1)){require(["navsearchbox"],function(aq){})}},updateNav:function(){var aq=O(ae.domSelectors.moreBtn).hasClass("hidenav")?O(ae.domSelectors.navigation).width():O(ae.domSelectors.navigation).width()-O(ae.domSelectors.moreBtn).width()-30;if(O(ae.domSelectors.visibleLinks).width()>aq-20){S.push(O(ae.domSelectors.visibleLinks).width());
O(ae.domSelectors.visibleLinks).children().not(ae.domSelectors.cyclicClass).not(".current").last().prependTo(O(ae.domSelectors.hiddenLinks));if(O(ae.domSelectors.moreBtn).hasClass("hidenav")){O(ae.domSelectors.moreBtn).removeClass("hidenav")}}else{if(aq>S[S.length-1]){O(ae.domSelectors.hiddenLinks).children().first().insertAfter(O(ae.domSelectors.visibleLinks).children().not(ae.domSelectors.cyclicClass).last());S.pop()}if(S.length<1){O(ae.domSelectors.moreBtn).addClass("hidenav");O(ae.domSelectors.hiddenLinks).addClass("hidenav")
}}O(ae.domSelectors.moreBtn).attr("count",S.length);O(ae.domSelectors.visibleLinks).addClass("show-extra");if(O(ae.domSelectors.visibleLinks).width()>aq){this.updateNav()}}}})(window.TimesApps,window,jQuery);j(window).load(function(){j("#main-nav").length&&window.TimesApps.NavigationManager.init();j("#main-nav").length&&window.TimesApps.NavigationManager.updateNav()});j(window).resize(function(){j("#main-nav").length&&window.TimesApps.NavigationManager.updateNav()});window.top.adsCallback=function(e){if(typeof e!="undefined"&&e=="gutter"){setTimeout(function(){window.TimesApps.NavigationManager.updateNav()
},1000)}}});require(["index"]);